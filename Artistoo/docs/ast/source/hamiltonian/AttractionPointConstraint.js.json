{"type":"File","start":0,"end":6055,"loc":{"start":{"line":1,"column":0},"end":{"line":151,"column":0}},"program":{"type":"Program","start":0,"end":6055,"loc":{"start":{"line":1,"column":0},"end":{"line":151,"column":0}},"sourceType":"module","body":[{"type":"ImportDeclaration","start":0,"end":48,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":48}},"specifiers":[{"type":"ImportDefaultSpecifier","start":7,"end":21,"loc":{"start":{"line":1,"column":7},"end":{"line":1,"column":21}},"local":{"type":"Identifier","start":7,"end":21,"loc":{"start":{"line":1,"column":7},"end":{"line":1,"column":21},"identifierName":"SoftConstraint"},"name":"SoftConstraint"}}],"source":{"type":"StringLiteral","start":27,"end":48,"loc":{"start":{"line":1,"column":27},"end":{"line":1,"column":48}},"extra":{"rawValue":"./SoftConstraint.js","raw":"\"./SoftConstraint.js\""},"value":"./SoftConstraint.js"}},{"type":"ImportDeclaration","start":49,"end":101,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":52}},"specifiers":[{"type":"ImportDefaultSpecifier","start":56,"end":72,"loc":{"start":{"line":2,"column":7},"end":{"line":2,"column":23}},"local":{"type":"Identifier","start":56,"end":72,"loc":{"start":{"line":2,"column":7},"end":{"line":2,"column":23},"identifierName":"ParameterChecker"},"name":"ParameterChecker"}}],"source":{"type":"StringLiteral","start":78,"end":101,"loc":{"start":{"line":2,"column":29},"end":{"line":2,"column":52}},"extra":{"rawValue":"./ParameterChecker.js","raw":"\"./ParameterChecker.js\""},"value":"./ParameterChecker.js","leadingComments":null,"trailingComments":null},"trailingComments":[{"type":"CommentBlock","value":"*Implements bias of motion in the direction of a supplied \"attraction point\".\n * This constraint computes the cosine of the angle alpha between the direction\n * of the copy attempt (from source to target pixel), and the direction from the\n * source to the attraction point. This cosine is 1 if these directions are\n * aligned, 0 if they are perpendicular, and 1 if they are opposite.\n * We take the negative (so that deltaH is negative for a copy attempt in the\n * right direction), and modify the strength of this bias using the lambda\n * parameter. The constraint only acts on copy attempts *from* the cell that\n * is responding to the field; it does not take into account the target pixel\n * (except for its location to determine the direction of the copy attempt).\n *\n * The current implementation works for torus grids as long as the grid size in\n * each dimension is larger than a few pixels.\n *\n * Automatic adding of this constraint via the conf object is currently not\n * supported, so you will have to add this constraint using the\n * {@link CPM#add} method.\n *\n * @example\n * // Build a CPM and add the constraint\n * let CPM = require( \"path/to/build\" )\n * let C = new CPM.CPM( [200,200], { T : 20 } )\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [[0,0],[100,100]],\n * } ) )\n *\n * // We can even add a second one at a different location\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [50,50],\n * } ) )\n ","start":104,"end":1642,"loc":{"start":{"line":5,"column":0},"end":{"line":37,"column":3}}}]},{"type":"Identifier","start":1643,"end":6012,"loc":{"start":{"line":38,"column":0},"end":{"line":148,"column":1}},"id":{"type":"Identifier","start":1649,"end":1674,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":31},"identifierName":"AttractionPointConstraint"},"name":"AttractionPointConstraint","leadingComments":null},"superClass":{"type":"Identifier","start":1683,"end":1697,"loc":{"start":{"line":38,"column":40},"end":{"line":38,"column":54},"identifierName":"SoftConstraint"},"name":"SoftConstraint"},"body":{"type":"ClassBody","start":1698,"end":6012,"loc":{"start":{"line":38,"column":55},"end":{"line":148,"column":1}},"body":[{"type":"ClassMethod","start":2068,"end":2109,"loc":{"start":{"line":48,"column":1},"end":{"line":50,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":2068,"end":2079,"loc":{"start":{"line":48,"column":1},"end":{"line":48,"column":12},"identifierName":"constructor"},"name":"constructor","leadingComments":null},"kind":"constructor","id":null,"generator":false,"expression":false,"async":false,"params":[{"type":"Identifier","start":2081,"end":2085,"loc":{"start":{"line":48,"column":14},"end":{"line":48,"column":18},"identifierName":"conf"},"name":"conf"}],"body":{"type":"BlockStatement","start":2087,"end":2109,"loc":{"start":{"line":48,"column":20},"end":{"line":50,"column":2}},"body":[{"type":"ExpressionStatement","start":2091,"end":2104,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":15}},"expression":{"type":"CallExpression","start":2091,"end":2104,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":15}},"callee":{"type":"Super","start":2091,"end":2096,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":7}}},"arguments":[{"type":"Identifier","start":2098,"end":2102,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":13},"identifierName":"conf"},"name":"conf"}]}}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentBlock","value":"* The constructor of an AttractionPointConstraint requires a conf object\n\t * with two parameters.\n\t * @param {object} conf - parameter object for this constraint\n\t * @param {PerKindNonNegative} conf.LAMBDA_ATTRACTIONPOINT - strength of\n\t * the constraint per cellkind.\n\t * @param {ArrayCoordinate} conf.ATTRACTIONPOINT coordinate of the\n\t * attraction point.\n\t","start":1702,"end":2066,"loc":{"start":{"line":40,"column":1},"end":{"line":47,"column":3}}}],"trailingComments":[{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}}]},{"type":"ClassMethod","start":2315,"end":2757,"loc":{"start":{"line":55,"column":1},"end":{"line":67,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":2315,"end":2326,"loc":{"start":{"line":55,"column":1},"end":{"line":55,"column":12},"identifierName":"confChecker"},"name":"confChecker","leadingComments":null},"kind":"method","id":null,"generator":false,"expression":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2328,"end":2757,"loc":{"start":{"line":55,"column":14},"end":{"line":67,"column":2}},"body":[{"type":"VariableDeclaration","start":2332,"end":2387,"loc":{"start":{"line":56,"column":2},"end":{"line":56,"column":57}},"declarations":[{"type":"VariableDeclarator","start":2336,"end":2387,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":57}},"id":{"type":"Identifier","start":2336,"end":2343,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":13},"identifierName":"checker"},"name":"checker"},"init":{"type":"NewExpression","start":2346,"end":2387,"loc":{"start":{"line":56,"column":16},"end":{"line":56,"column":57}},"callee":{"type":"Identifier","start":2350,"end":2366,"loc":{"start":{"line":56,"column":20},"end":{"line":56,"column":36},"identifierName":"ParameterChecker"},"name":"ParameterChecker"},"arguments":[{"type":"MemberExpression","start":2368,"end":2377,"loc":{"start":{"line":56,"column":38},"end":{"line":56,"column":47}},"object":{"type":"ThisExpression","start":2368,"end":2372,"loc":{"start":{"line":56,"column":38},"end":{"line":56,"column":42}}},"property":{"type":"Identifier","start":2373,"end":2377,"loc":{"start":{"line":56,"column":43},"end":{"line":56,"column":47},"identifierName":"conf"},"name":"conf"},"computed":false},{"type":"MemberExpression","start":2379,"end":2385,"loc":{"start":{"line":56,"column":49},"end":{"line":56,"column":55}},"object":{"type":"ThisExpression","start":2379,"end":2383,"loc":{"start":{"line":56,"column":49},"end":{"line":56,"column":53}}},"property":{"type":"Identifier","start":2384,"end":2385,"loc":{"start":{"line":56,"column":54},"end":{"line":56,"column":55},"identifierName":"C"},"name":"C"},"computed":false}]}}],"kind":"let"},{"type":"ExpressionStatement","start":2390,"end":2475,"loc":{"start":{"line":57,"column":2},"end":{"line":58,"column":31}},"expression":{"type":"CallExpression","start":2390,"end":2475,"loc":{"start":{"line":57,"column":2},"end":{"line":58,"column":31}},"callee":{"type":"MemberExpression","start":2390,"end":2416,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":28}},"object":{"type":"Identifier","start":2390,"end":2397,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":9},"identifierName":"checker"},"name":"checker"},"property":{"type":"Identifier","start":2398,"end":2416,"loc":{"start":{"line":57,"column":10},"end":{"line":57,"column":28},"identifierName":"confCheckParameter"},"name":"confCheckParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":2418,"end":2442,"loc":{"start":{"line":57,"column":30},"end":{"line":57,"column":54}},"extra":{"rawValue":"LAMBDA_ATTRACTIONPOINT","raw":"\"LAMBDA_ATTRACTIONPOINT\""},"value":"LAMBDA_ATTRACTIONPOINT"},{"type":"StringLiteral","start":2447,"end":2458,"loc":{"start":{"line":58,"column":3},"end":{"line":58,"column":14}},"extra":{"rawValue":"KindArray","raw":"\"KindArray\""},"value":"KindArray"},{"type":"StringLiteral","start":2460,"end":2473,"loc":{"start":{"line":58,"column":16},"end":{"line":58,"column":29}},"extra":{"rawValue":"NonNegative","raw":"\"NonNegative\""},"value":"NonNegative"}],"trailingComments":null},"trailingComments":[{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}}]},{"type":"ExpressionStatement","start":2523,"end":2571,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":50}},"expression":{"type":"CallExpression","start":2523,"end":2571,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":50}},"callee":{"type":"MemberExpression","start":2523,"end":2550,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":29}},"object":{"type":"Identifier","start":2523,"end":2530,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":9},"identifierName":"checker"},"name":"checker","leadingComments":null},"property":{"type":"Identifier","start":2531,"end":2550,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":29},"identifierName":"confCheckPresenceOf"},"name":"confCheckPresenceOf"},"computed":false,"leadingComments":null},"arguments":[{"type":"StringLiteral","start":2552,"end":2569,"loc":{"start":{"line":61,"column":31},"end":{"line":61,"column":48}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"}],"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}}]},{"type":"VariableDeclaration","start":2574,"end":2611,"loc":{"start":{"line":62,"column":2},"end":{"line":62,"column":39}},"declarations":[{"type":"VariableDeclarator","start":2578,"end":2611,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":39}},"id":{"type":"Identifier","start":2578,"end":2580,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":8},"identifierName":"pt"},"name":"pt"},"init":{"type":"MemberExpression","start":2583,"end":2611,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":39}},"object":{"type":"MemberExpression","start":2583,"end":2592,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":20}},"object":{"type":"ThisExpression","start":2583,"end":2587,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":15}}},"property":{"type":"Identifier","start":2588,"end":2592,"loc":{"start":{"line":62,"column":16},"end":{"line":62,"column":20},"identifierName":"conf"},"name":"conf"},"computed":false},"property":{"type":"StringLiteral","start":2593,"end":2610,"loc":{"start":{"line":62,"column":21},"end":{"line":62,"column":38}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"},"computed":true}}],"kind":"let"},{"type":"IfStatement","start":2614,"end":2754,"loc":{"start":{"line":63,"column":2},"end":{"line":66,"column":3}},"test":{"type":"UnaryExpression","start":2618,"end":2643,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":31}},"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":2619,"end":2643,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":31}},"callee":{"type":"MemberExpression","start":2619,"end":2639,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":27}},"object":{"type":"Identifier","start":2619,"end":2626,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":14},"identifierName":"checker"},"name":"checker"},"property":{"type":"Identifier","start":2627,"end":2639,"loc":{"start":{"line":63,"column":15},"end":{"line":63,"column":27},"identifierName":"isCoordinate"},"name":"isCoordinate"},"computed":false},"arguments":[{"type":"Identifier","start":2640,"end":2642,"loc":{"start":{"line":63,"column":28},"end":{"line":63,"column":30},"identifierName":"pt"},"name":"pt"}]},"extra":{"parenthesizedArgument":false}},"consequent":{"type":"BlockStatement","start":2645,"end":2754,"loc":{"start":{"line":63,"column":33},"end":{"line":66,"column":3}},"body":[{"type":"ThrowStatement","start":2650,"end":2750,"loc":{"start":{"line":64,"column":3},"end":{"line":65,"column":31}},"argument":{"type":"BinaryExpression","start":2657,"end":2748,"loc":{"start":{"line":64,"column":10},"end":{"line":65,"column":29}},"left":{"type":"StringLiteral","start":2657,"end":2716,"loc":{"start":{"line":64,"column":10},"end":{"line":64,"column":69}},"extra":{"rawValue":"ATTRACTIONPOINT must be a coordinate array with the same ","raw":"\"ATTRACTIONPOINT must be a coordinate array with the same \""},"value":"ATTRACTIONPOINT must be a coordinate array with the same "},"operator":"+","right":{"type":"StringLiteral","start":2723,"end":2748,"loc":{"start":{"line":65,"column":4},"end":{"line":65,"column":29}},"extra":{"rawValue":"dimensions as the grid!","raw":"\"dimensions as the grid!\""},"value":"dimensions as the grid!"},"extra":{"parenthesized":true,"parenStart":2655}}}],"directives":[]},"alternate":null}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}}],"trailingComments":[{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}}]},{"type":"ClassMethod","start":3425,"end":6010,"loc":{"start":{"line":81,"column":1},"end":{"line":147,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":3425,"end":3431,"loc":{"start":{"line":81,"column":1},"end":{"line":81,"column":7},"identifierName":"deltaH"},"name":"deltaH","leadingComments":null},"kind":"method","id":null,"generator":false,"expression":false,"async":false,"params":[{"type":"Identifier","start":3433,"end":3438,"loc":{"start":{"line":81,"column":9},"end":{"line":81,"column":14},"identifierName":"src_i"},"name":"src_i"},{"type":"Identifier","start":3440,"end":3445,"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":21},"identifierName":"tgt_i"},"name":"tgt_i"},{"type":"Identifier","start":3447,"end":3455,"loc":{"start":{"line":81,"column":23},"end":{"line":81,"column":31},"identifierName":"src_type"},"name":"src_type"},{"type":"Identifier","start":3457,"end":3465,"loc":{"start":{"line":81,"column":33},"end":{"line":81,"column":41},"identifierName":"tgt_type"},"name":"tgt_type"}],"body":{"type":"BlockStatement","start":3467,"end":6010,"loc":{"start":{"line":81,"column":43},"end":{"line":147,"column":2}},"body":[{"type":"VariableDeclaration","start":3657,"end":3720,"loc":{"start":{"line":86,"column":2},"end":{"line":86,"column":65}},"declarations":[{"type":"VariableDeclarator","start":3661,"end":3720,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":65}},"id":{"type":"Identifier","start":3661,"end":3662,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":7},"identifierName":"l"},"name":"l","leadingComments":null},"init":{"type":"CallExpression","start":3665,"end":3720,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":65}},"callee":{"type":"MemberExpression","start":3665,"end":3683,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":28}},"object":{"type":"ThisExpression","start":3665,"end":3669,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":14}}},"property":{"type":"Identifier","start":3670,"end":3683,"loc":{"start":{"line":86,"column":15},"end":{"line":86,"column":28},"identifierName":"cellParameter"},"name":"cellParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":3684,"end":3708,"loc":{"start":{"line":86,"column":29},"end":{"line":86,"column":53}},"extra":{"rawValue":"LAMBDA_ATTRACTIONPOINT","raw":"\"LAMBDA_ATTRACTIONPOINT\""},"value":"LAMBDA_ATTRACTIONPOINT"},{"type":"Identifier","start":3710,"end":3718,"loc":{"start":{"line":86,"column":55},"end":{"line":86,"column":63},"identifierName":"src_type"},"name":"src_type"}]},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" deltaH is only non-zero when the source pixel belongs to a cell with","start":3472,"end":3543,"loc":{"start":{"line":83,"column":2},"end":{"line":83,"column":73}}},{"type":"CommentLine","value":" an attraction point, so it does not act on copy attempts where the","start":3546,"end":3615,"loc":{"start":{"line":84,"column":2},"end":{"line":84,"column":71}}},{"type":"CommentLine","value":" background would invade the cell.","start":3618,"end":3654,"loc":{"start":{"line":85,"column":2},"end":{"line":85,"column":38}}}]},{"type":"IfStatement","start":3723,"end":3748,"loc":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"test":{"type":"UnaryExpression","start":3727,"end":3729,"loc":{"start":{"line":87,"column":6},"end":{"line":87,"column":8}},"operator":"!","prefix":true,"argument":{"type":"Identifier","start":3728,"end":3729,"loc":{"start":{"line":87,"column":7},"end":{"line":87,"column":8},"identifierName":"l"},"name":"l"},"extra":{"parenthesizedArgument":false}},"consequent":{"type":"BlockStatement","start":3731,"end":3748,"loc":{"start":{"line":87,"column":10},"end":{"line":89,"column":3}},"body":[{"type":"ReturnStatement","start":3736,"end":3744,"loc":{"start":{"line":88,"column":3},"end":{"line":88,"column":11}},"argument":{"type":"NumericLiteral","start":3743,"end":3744,"loc":{"start":{"line":88,"column":10},"end":{"line":88,"column":11}},"extra":{"rawValue":0,"raw":"0"},"value":0}}],"directives":[],"trailingComments":null},"alternate":null,"trailingComments":[{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}}]},{"type":"VariableDeclaration","start":3935,"end":3964,"loc":{"start":{"line":94,"column":2},"end":{"line":94,"column":31}},"declarations":[{"type":"VariableDeclarator","start":3939,"end":3964,"loc":{"start":{"line":94,"column":6},"end":{"line":94,"column":31}},"id":{"type":"Identifier","start":3939,"end":3944,"loc":{"start":{"line":94,"column":6},"end":{"line":94,"column":11},"identifierName":"torus"},"name":"torus","leadingComments":null},"init":{"type":"MemberExpression","start":3947,"end":3964,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":31}},"object":{"type":"MemberExpression","start":3947,"end":3958,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":25}},"object":{"type":"MemberExpression","start":3947,"end":3953,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":20}},"object":{"type":"ThisExpression","start":3947,"end":3951,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":18}}},"property":{"type":"Identifier","start":3952,"end":3953,"loc":{"start":{"line":94,"column":19},"end":{"line":94,"column":20},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":3954,"end":3958,"loc":{"start":{"line":94,"column":21},"end":{"line":94,"column":25},"identifierName":"conf"},"name":"conf"},"computed":false},"property":{"type":"Identifier","start":3959,"end":3964,"loc":{"start":{"line":94,"column":26},"end":{"line":94,"column":31},"identifierName":"torus"},"name":"torus","leadingComments":null,"trailingComments":null},"computed":false,"trailingComments":null},"leadingComments":null,"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}}],"trailingComments":[{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}}]},{"type":"VariableDeclaration","start":4077,"end":4135,"loc":{"start":{"line":98,"column":2},"end":{"line":98,"column":60}},"declarations":[{"type":"VariableDeclarator","start":4081,"end":4135,"loc":{"start":{"line":98,"column":6},"end":{"line":98,"column":60}},"id":{"type":"Identifier","start":4081,"end":4084,"loc":{"start":{"line":98,"column":6},"end":{"line":98,"column":9},"identifierName":"tgt"},"name":"tgt","leadingComments":null},"init":{"type":"CallExpression","start":4087,"end":4135,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":60}},"callee":{"type":"MemberExpression","start":4087,"end":4105,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":30}},"object":{"type":"ThisExpression","start":4087,"end":4091,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":16}}},"property":{"type":"Identifier","start":4092,"end":4105,"loc":{"start":{"line":98,"column":17},"end":{"line":98,"column":30},"identifierName":"cellParameter"},"name":"cellParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":4106,"end":4123,"loc":{"start":{"line":98,"column":31},"end":{"line":98,"column":48}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"},{"type":"Identifier","start":4125,"end":4133,"loc":{"start":{"line":98,"column":50},"end":{"line":98,"column":58},"identifierName":"src_type"},"name":"src_type"}]},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}}]},{"type":"VariableDeclaration","start":4138,"end":4202,"loc":{"start":{"line":99,"column":2},"end":{"line":99,"column":66}},"declarations":[{"type":"VariableDeclarator","start":4142,"end":4171,"loc":{"start":{"line":99,"column":6},"end":{"line":99,"column":35}},"id":{"type":"Identifier","start":4142,"end":4144,"loc":{"start":{"line":99,"column":6},"end":{"line":99,"column":8},"identifierName":"p1"},"name":"p1"},"init":{"type":"CallExpression","start":4147,"end":4171,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":35}},"callee":{"type":"MemberExpression","start":4147,"end":4162,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":26}},"object":{"type":"MemberExpression","start":4147,"end":4158,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":22}},"object":{"type":"MemberExpression","start":4147,"end":4153,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":17}},"object":{"type":"ThisExpression","start":4147,"end":4151,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":15}}},"property":{"type":"Identifier","start":4152,"end":4153,"loc":{"start":{"line":99,"column":16},"end":{"line":99,"column":17},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":4154,"end":4158,"loc":{"start":{"line":99,"column":18},"end":{"line":99,"column":22},"identifierName":"grid"},"name":"grid"},"computed":false},"property":{"type":"Identifier","start":4159,"end":4162,"loc":{"start":{"line":99,"column":23},"end":{"line":99,"column":26},"identifierName":"i2p"},"name":"i2p"},"computed":false},"arguments":[{"type":"Identifier","start":4164,"end":4169,"loc":{"start":{"line":99,"column":28},"end":{"line":99,"column":33},"identifierName":"src_i"},"name":"src_i"}]}},{"type":"VariableDeclarator","start":4173,"end":4202,"loc":{"start":{"line":99,"column":37},"end":{"line":99,"column":66}},"id":{"type":"Identifier","start":4173,"end":4175,"loc":{"start":{"line":99,"column":37},"end":{"line":99,"column":39},"identifierName":"p2"},"name":"p2"},"init":{"type":"CallExpression","start":4178,"end":4202,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":66}},"callee":{"type":"MemberExpression","start":4178,"end":4193,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":57}},"object":{"type":"MemberExpression","start":4178,"end":4189,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":53}},"object":{"type":"MemberExpression","start":4178,"end":4184,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":48}},"object":{"type":"ThisExpression","start":4178,"end":4182,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":46}}},"property":{"type":"Identifier","start":4183,"end":4184,"loc":{"start":{"line":99,"column":47},"end":{"line":99,"column":48},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":4185,"end":4189,"loc":{"start":{"line":99,"column":49},"end":{"line":99,"column":53},"identifierName":"grid"},"name":"grid"},"computed":false},"property":{"type":"Identifier","start":4190,"end":4193,"loc":{"start":{"line":99,"column":54},"end":{"line":99,"column":57},"identifierName":"i2p"},"name":"i2p"},"computed":false},"arguments":[{"type":"Identifier","start":4195,"end":4200,"loc":{"start":{"line":99,"column":59},"end":{"line":99,"column":64},"identifierName":"tgt_i"},"name":"tgt_i"}],"trailingComments":null},"trailingComments":null}],"kind":"let","trailingComments":[{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}}]},{"type":"VariableDeclaration","start":4608,"end":4629,"loc":{"start":{"line":107,"column":2},"end":{"line":107,"column":23}},"declarations":[{"type":"VariableDeclarator","start":4612,"end":4618,"loc":{"start":{"line":107,"column":6},"end":{"line":107,"column":12}},"id":{"type":"Identifier","start":4612,"end":4613,"loc":{"start":{"line":107,"column":6},"end":{"line":107,"column":7},"identifierName":"r"},"name":"r","leadingComments":null},"init":{"type":"NumericLiteral","start":4616,"end":4618,"loc":{"start":{"line":107,"column":10},"end":{"line":107,"column":12}},"extra":{"rawValue":0,"raw":"0."},"value":0},"leadingComments":null},{"type":"VariableDeclarator","start":4620,"end":4629,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":23}},"id":{"type":"Identifier","start":4620,"end":4624,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":18},"identifierName":"ldir"},"name":"ldir"},"init":{"type":"NumericLiteral","start":4627,"end":4629,"loc":{"start":{"line":107,"column":21},"end":{"line":107,"column":23}},"extra":{"rawValue":0,"raw":"0."},"value":0,"leadingComments":null,"trailingComments":null},"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}}],"trailingComments":[{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}}]},{"type":"ForStatement","start":4673,"end":5506,"loc":{"start":{"line":110,"column":2},"end":{"line":137,"column":3}},"init":{"type":"VariableDeclaration","start":4678,"end":4687,"loc":{"start":{"line":110,"column":7},"end":{"line":110,"column":16}},"declarations":[{"type":"VariableDeclarator","start":4682,"end":4687,"loc":{"start":{"line":110,"column":11},"end":{"line":110,"column":16}},"id":{"type":"Identifier","start":4682,"end":4683,"loc":{"start":{"line":110,"column":11},"end":{"line":110,"column":12},"identifierName":"i"},"name":"i","leadingComments":null},"init":{"type":"NumericLiteral","start":4686,"end":4687,"loc":{"start":{"line":110,"column":15},"end":{"line":110,"column":16}},"extra":{"rawValue":0,"raw":"0"},"value":0},"leadingComments":null}],"kind":"let","leadingComments":null},"test":{"type":"BinaryExpression","start":4689,"end":4702,"loc":{"start":{"line":110,"column":18},"end":{"line":110,"column":31}},"left":{"type":"Identifier","start":4689,"end":4690,"loc":{"start":{"line":110,"column":18},"end":{"line":110,"column":19},"identifierName":"i"},"name":"i"},"operator":"<","right":{"type":"MemberExpression","start":4693,"end":4702,"loc":{"start":{"line":110,"column":22},"end":{"line":110,"column":31}},"object":{"type":"Identifier","start":4693,"end":4695,"loc":{"start":{"line":110,"column":22},"end":{"line":110,"column":24},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":4696,"end":4702,"loc":{"start":{"line":110,"column":25},"end":{"line":110,"column":31},"identifierName":"length"},"name":"length"},"computed":false}},"update":{"type":"UpdateExpression","start":4705,"end":4708,"loc":{"start":{"line":110,"column":34},"end":{"line":110,"column":37}},"operator":"++","prefix":false,"argument":{"type":"Identifier","start":4705,"end":4706,"loc":{"start":{"line":110,"column":34},"end":{"line":110,"column":35},"identifierName":"i"},"name":"i"}},"body":{"type":"BlockStatement","start":4710,"end":5506,"loc":{"start":{"line":110,"column":39},"end":{"line":137,"column":3}},"body":[{"type":"VariableDeclaration","start":4853,"end":4879,"loc":{"start":{"line":114,"column":3},"end":{"line":114,"column":29}},"declarations":[{"type":"VariableDeclarator","start":4857,"end":4879,"loc":{"start":{"line":114,"column":7},"end":{"line":114,"column":29}},"id":{"type":"Identifier","start":4857,"end":4862,"loc":{"start":{"line":114,"column":7},"end":{"line":114,"column":12},"identifierName":"dir_i"},"name":"dir_i","leadingComments":null},"init":{"type":"BinaryExpression","start":4865,"end":4879,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":29}},"left":{"type":"MemberExpression","start":4865,"end":4871,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":21}},"object":{"type":"Identifier","start":4865,"end":4868,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":18},"identifierName":"tgt"},"name":"tgt"},"property":{"type":"Identifier","start":4869,"end":4870,"loc":{"start":{"line":114,"column":19},"end":{"line":114,"column":20},"identifierName":"i"},"name":"i"},"computed":true},"operator":"-","right":{"type":"MemberExpression","start":4874,"end":4879,"loc":{"start":{"line":114,"column":24},"end":{"line":114,"column":29}},"object":{"type":"Identifier","start":4874,"end":4876,"loc":{"start":{"line":114,"column":24},"end":{"line":114,"column":26},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":4877,"end":4878,"loc":{"start":{"line":114,"column":27},"end":{"line":114,"column":28},"identifierName":"i"},"name":"i"},"computed":true}},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" compute the distance between the target and the current position","start":4716,"end":4783,"loc":{"start":{"line":112,"column":3},"end":{"line":112,"column":70}}},{"type":"CommentLine","value":" in this dimension, and add it in squared form to the total.","start":4787,"end":4849,"loc":{"start":{"line":113,"column":3},"end":{"line":113,"column":65}}}]},{"type":"ExpressionStatement","start":4883,"end":4904,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":24}},"expression":{"type":"AssignmentExpression","start":4883,"end":4904,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":24}},"operator":"+=","left":{"type":"Identifier","start":4883,"end":4887,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":7},"identifierName":"ldir"},"name":"ldir"},"right":{"type":"BinaryExpression","start":4891,"end":4904,"loc":{"start":{"line":115,"column":11},"end":{"line":115,"column":24}},"left":{"type":"Identifier","start":4891,"end":4896,"loc":{"start":{"line":115,"column":11},"end":{"line":115,"column":16},"identifierName":"dir_i"},"name":"dir_i"},"operator":"*","right":{"type":"Identifier","start":4899,"end":4904,"loc":{"start":{"line":115,"column":19},"end":{"line":115,"column":24},"identifierName":"dir_i"},"name":"dir_i","leadingComments":null,"trailingComments":null},"trailingComments":null},"trailingComments":null},"trailingComments":[{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}}]},{"type":"VariableDeclaration","start":5048,"end":5070,"loc":{"start":{"line":119,"column":3},"end":{"line":119,"column":25}},"declarations":[{"type":"VariableDeclarator","start":5052,"end":5070,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":25}},"id":{"type":"Identifier","start":5052,"end":5054,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":9},"identifierName":"dx"},"name":"dx","leadingComments":null},"init":{"type":"BinaryExpression","start":5057,"end":5070,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":25}},"left":{"type":"MemberExpression","start":5057,"end":5062,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":17}},"object":{"type":"Identifier","start":5057,"end":5059,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":14},"identifierName":"p2"},"name":"p2"},"property":{"type":"Identifier","start":5060,"end":5061,"loc":{"start":{"line":119,"column":15},"end":{"line":119,"column":16},"identifierName":"i"},"name":"i"},"computed":true},"operator":"-","right":{"type":"MemberExpression","start":5065,"end":5070,"loc":{"start":{"line":119,"column":20},"end":{"line":119,"column":25}},"object":{"type":"Identifier","start":5065,"end":5067,"loc":{"start":{"line":119,"column":20},"end":{"line":119,"column":22},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":5068,"end":5069,"loc":{"start":{"line":119,"column":23},"end":{"line":119,"column":24},"identifierName":"i"},"name":"i"},"computed":true,"trailingComments":null},"trailingComments":null},"leadingComments":null,"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}}],"trailingComments":[{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}}]},{"type":"VariableDeclaration","start":5160,"end":5186,"loc":{"start":{"line":123,"column":3},"end":{"line":123,"column":29}},"declarations":[{"type":"VariableDeclarator","start":5164,"end":5186,"loc":{"start":{"line":123,"column":7},"end":{"line":123,"column":29}},"id":{"type":"Identifier","start":5164,"end":5166,"loc":{"start":{"line":123,"column":7},"end":{"line":123,"column":9},"identifierName":"si"},"name":"si","leadingComments":null},"init":{"type":"MemberExpression","start":5169,"end":5186,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":29}},"object":{"type":"MemberExpression","start":5169,"end":5183,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":26}},"object":{"type":"MemberExpression","start":5169,"end":5175,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":18}},"object":{"type":"ThisExpression","start":5169,"end":5173,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":16}}},"property":{"type":"Identifier","start":5174,"end":5175,"loc":{"start":{"line":123,"column":17},"end":{"line":123,"column":18},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":5176,"end":5183,"loc":{"start":{"line":123,"column":19},"end":{"line":123,"column":26},"identifierName":"extents"},"name":"extents"},"computed":false},"property":{"type":"Identifier","start":5184,"end":5185,"loc":{"start":{"line":123,"column":27},"end":{"line":123,"column":28},"identifierName":"i"},"name":"i"},"computed":true},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}}]},{"type":"IfStatement","start":5190,"end":5380,"loc":{"start":{"line":124,"column":3},"end":{"line":132,"column":4}},"test":{"type":"MemberExpression","start":5194,"end":5202,"loc":{"start":{"line":124,"column":7},"end":{"line":124,"column":15}},"object":{"type":"Identifier","start":5194,"end":5199,"loc":{"start":{"line":124,"column":7},"end":{"line":124,"column":12},"identifierName":"torus"},"name":"torus"},"property":{"type":"Identifier","start":5200,"end":5201,"loc":{"start":{"line":124,"column":13},"end":{"line":124,"column":14},"identifierName":"i"},"name":"i"},"computed":true},"consequent":{"type":"BlockStatement","start":5204,"end":5380,"loc":{"start":{"line":124,"column":17},"end":{"line":132,"column":4}},"body":[{"type":"IfStatement","start":5296,"end":5375,"loc":{"start":{"line":127,"column":4},"end":{"line":131,"column":5}},"test":{"type":"BinaryExpression","start":5300,"end":5309,"loc":{"start":{"line":127,"column":8},"end":{"line":127,"column":17}},"left":{"type":"Identifier","start":5300,"end":5302,"loc":{"start":{"line":127,"column":8},"end":{"line":127,"column":10},"identifierName":"dx"},"name":"dx","leadingComments":null},"operator":">","right":{"type":"BinaryExpression","start":5305,"end":5309,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":17}},"left":{"type":"Identifier","start":5305,"end":5307,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":15},"identifierName":"si"},"name":"si"},"operator":"/","right":{"type":"NumericLiteral","start":5308,"end":5309,"loc":{"start":{"line":127,"column":16},"end":{"line":127,"column":17}},"extra":{"rawValue":2,"raw":"2"},"value":2}},"leadingComments":null},"consequent":{"type":"BlockStatement","start":5311,"end":5332,"loc":{"start":{"line":127,"column":19},"end":{"line":129,"column":5}},"body":[{"type":"ExpressionStatement","start":5318,"end":5326,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":13}},"expression":{"type":"AssignmentExpression","start":5318,"end":5326,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":13}},"operator":"-=","left":{"type":"Identifier","start":5318,"end":5320,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":7},"identifierName":"dx"},"name":"dx"},"right":{"type":"Identifier","start":5324,"end":5326,"loc":{"start":{"line":128,"column":11},"end":{"line":128,"column":13},"identifierName":"si"},"name":"si"}}}],"directives":[]},"alternate":{"type":"IfStatement","start":5338,"end":5375,"loc":{"start":{"line":129,"column":11},"end":{"line":131,"column":5}},"test":{"type":"BinaryExpression","start":5342,"end":5352,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":25}},"left":{"type":"Identifier","start":5342,"end":5344,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":17},"identifierName":"dx"},"name":"dx"},"operator":"<","right":{"type":"BinaryExpression","start":5347,"end":5352,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":25}},"left":{"type":"UnaryExpression","start":5347,"end":5350,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":23}},"operator":"-","prefix":true,"argument":{"type":"Identifier","start":5348,"end":5350,"loc":{"start":{"line":129,"column":21},"end":{"line":129,"column":23},"identifierName":"si"},"name":"si"},"extra":{"parenthesizedArgument":false}},"operator":"/","right":{"type":"NumericLiteral","start":5351,"end":5352,"loc":{"start":{"line":129,"column":24},"end":{"line":129,"column":25}},"extra":{"rawValue":2,"raw":"2"},"value":2}}},"consequent":{"type":"BlockStatement","start":5354,"end":5375,"loc":{"start":{"line":129,"column":27},"end":{"line":131,"column":5}},"body":[{"type":"ExpressionStatement","start":5361,"end":5369,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":13}},"expression":{"type":"AssignmentExpression","start":5361,"end":5369,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":13}},"operator":"+=","left":{"type":"Identifier","start":5361,"end":5363,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":7},"identifierName":"dx"},"name":"dx"},"right":{"type":"Identifier","start":5367,"end":5369,"loc":{"start":{"line":130,"column":11},"end":{"line":130,"column":13},"identifierName":"si"},"name":"si"}}}],"directives":[]},"alternate":null},"leadingComments":[{"type":"CommentLine","value":" If distance is greater than half the grid size, correct the","start":5210,"end":5272,"loc":{"start":{"line":125,"column":4},"end":{"line":125,"column":66}}},{"type":"CommentLine","value":" coordinate.","start":5277,"end":5291,"loc":{"start":{"line":126,"column":4},"end":{"line":126,"column":18}}}]}],"directives":[],"trailingComments":null},"alternate":null,"trailingComments":[{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}}]},{"type":"ExpressionStatement","start":5486,"end":5501,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":18}},"expression":{"type":"AssignmentExpression","start":5486,"end":5501,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":18}},"operator":"+=","left":{"type":"Identifier","start":5486,"end":5487,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":4},"identifierName":"r"},"name":"r","leadingComments":null},"right":{"type":"BinaryExpression","start":5491,"end":5501,"loc":{"start":{"line":136,"column":8},"end":{"line":136,"column":18}},"left":{"type":"Identifier","start":5491,"end":5493,"loc":{"start":{"line":136,"column":8},"end":{"line":136,"column":10},"identifierName":"dx"},"name":"dx"},"operator":"*","right":{"type":"Identifier","start":5496,"end":5501,"loc":{"start":{"line":136,"column":13},"end":{"line":136,"column":18},"identifierName":"dir_i"},"name":"dir_i"}},"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}}]}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}}],"trailingComments":[{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}}]},{"type":"ReturnStatement","start":5973,"end":6007,"loc":{"start":{"line":146,"column":2},"end":{"line":146,"column":36}},"argument":{"type":"BinaryExpression","start":5980,"end":6007,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":36}},"left":{"type":"BinaryExpression","start":5980,"end":5987,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":16}},"left":{"type":"UnaryExpression","start":5980,"end":5983,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":12}},"operator":"-","prefix":true,"argument":{"type":"Identifier","start":5982,"end":5983,"loc":{"start":{"line":146,"column":11},"end":{"line":146,"column":12},"identifierName":"r"},"name":"r","leadingComments":null},"extra":{"parenthesizedArgument":false},"leadingComments":null},"operator":"*","right":{"type":"Identifier","start":5986,"end":5987,"loc":{"start":{"line":146,"column":15},"end":{"line":146,"column":16},"identifierName":"l"},"name":"l"},"leadingComments":null},"operator":"/","right":{"type":"CallExpression","start":5990,"end":6007,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":36}},"callee":{"type":"MemberExpression","start":5990,"end":5999,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":28}},"object":{"type":"Identifier","start":5990,"end":5994,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":23},"identifierName":"Math"},"name":"Math"},"property":{"type":"Identifier","start":5995,"end":5999,"loc":{"start":{"line":146,"column":24},"end":{"line":146,"column":28},"identifierName":"sqrt"},"name":"sqrt"},"computed":false},"arguments":[{"type":"Identifier","start":6001,"end":6005,"loc":{"start":{"line":146,"column":30},"end":{"line":146,"column":34},"identifierName":"ldir"},"name":"ldir"}]},"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}}]}],"directives":[]},"leadingComments":[{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}}]}]},"leadingComments":[],"name":"_","trailingComments":[]},{"type":"Identifier","start":6014,"end":6054,"loc":{"start":{"line":150,"column":0},"end":{"line":150,"column":40}},"declaration":{"type":"Identifier","start":6029,"end":6054,"loc":{"start":{"line":150,"column":15},"end":{"line":150,"column":40},"identifierName":"AttractionPointConstraint"},"name":"AttractionPointConstraint"},"name":"_","leadingComments":[],"trailingComments":[]},{"type":"ExportDefaultDeclaration","start":6014,"end":6054,"loc":{"start":{"line":150,"column":0},"end":{"line":150,"column":40}},"declaration":{"type":"ClassDeclaration","start":1643,"end":6012,"loc":{"start":{"line":38,"column":0},"end":{"line":148,"column":1}},"id":{"type":"Identifier","start":1649,"end":1674,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":31},"identifierName":"AttractionPointConstraint"},"name":"AttractionPointConstraint","leadingComments":null},"superClass":{"type":"Identifier","start":1683,"end":1697,"loc":{"start":{"line":38,"column":40},"end":{"line":38,"column":54},"identifierName":"SoftConstraint"},"name":"SoftConstraint"},"body":{"type":"ClassBody","start":1698,"end":6012,"loc":{"start":{"line":38,"column":55},"end":{"line":148,"column":1}},"body":[{"type":"ClassMethod","start":2068,"end":2109,"loc":{"start":{"line":48,"column":1},"end":{"line":50,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":2068,"end":2079,"loc":{"start":{"line":48,"column":1},"end":{"line":48,"column":12},"identifierName":"constructor"},"name":"constructor","leadingComments":null},"kind":"constructor","id":null,"generator":false,"expression":false,"async":false,"params":[{"type":"Identifier","start":2081,"end":2085,"loc":{"start":{"line":48,"column":14},"end":{"line":48,"column":18},"identifierName":"conf"},"name":"conf"}],"body":{"type":"BlockStatement","start":2087,"end":2109,"loc":{"start":{"line":48,"column":20},"end":{"line":50,"column":2}},"body":[{"type":"ExpressionStatement","start":2091,"end":2104,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":15}},"expression":{"type":"CallExpression","start":2091,"end":2104,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":15}},"callee":{"type":"Super","start":2091,"end":2096,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":7}}},"arguments":[{"type":"Identifier","start":2098,"end":2102,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":13},"identifierName":"conf"},"name":"conf"}]}}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentBlock","value":"* The constructor of an AttractionPointConstraint requires a conf object\n\t * with two parameters.\n\t * @param {object} conf - parameter object for this constraint\n\t * @param {PerKindNonNegative} conf.LAMBDA_ATTRACTIONPOINT - strength of\n\t * the constraint per cellkind.\n\t * @param {ArrayCoordinate} conf.ATTRACTIONPOINT coordinate of the\n\t * attraction point.\n\t","start":1702,"end":2066,"loc":{"start":{"line":40,"column":1},"end":{"line":47,"column":3}}}],"trailingComments":[{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}}]},{"type":"ClassMethod","start":2315,"end":2757,"loc":{"start":{"line":55,"column":1},"end":{"line":67,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":2315,"end":2326,"loc":{"start":{"line":55,"column":1},"end":{"line":55,"column":12},"identifierName":"confChecker"},"name":"confChecker","leadingComments":null},"kind":"method","id":null,"generator":false,"expression":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2328,"end":2757,"loc":{"start":{"line":55,"column":14},"end":{"line":67,"column":2}},"body":[{"type":"VariableDeclaration","start":2332,"end":2387,"loc":{"start":{"line":56,"column":2},"end":{"line":56,"column":57}},"declarations":[{"type":"VariableDeclarator","start":2336,"end":2387,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":57}},"id":{"type":"Identifier","start":2336,"end":2343,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":13},"identifierName":"checker"},"name":"checker"},"init":{"type":"NewExpression","start":2346,"end":2387,"loc":{"start":{"line":56,"column":16},"end":{"line":56,"column":57}},"callee":{"type":"Identifier","start":2350,"end":2366,"loc":{"start":{"line":56,"column":20},"end":{"line":56,"column":36},"identifierName":"ParameterChecker"},"name":"ParameterChecker"},"arguments":[{"type":"MemberExpression","start":2368,"end":2377,"loc":{"start":{"line":56,"column":38},"end":{"line":56,"column":47}},"object":{"type":"ThisExpression","start":2368,"end":2372,"loc":{"start":{"line":56,"column":38},"end":{"line":56,"column":42}}},"property":{"type":"Identifier","start":2373,"end":2377,"loc":{"start":{"line":56,"column":43},"end":{"line":56,"column":47},"identifierName":"conf"},"name":"conf"},"computed":false},{"type":"MemberExpression","start":2379,"end":2385,"loc":{"start":{"line":56,"column":49},"end":{"line":56,"column":55}},"object":{"type":"ThisExpression","start":2379,"end":2383,"loc":{"start":{"line":56,"column":49},"end":{"line":56,"column":53}}},"property":{"type":"Identifier","start":2384,"end":2385,"loc":{"start":{"line":56,"column":54},"end":{"line":56,"column":55},"identifierName":"C"},"name":"C"},"computed":false}]}}],"kind":"let"},{"type":"ExpressionStatement","start":2390,"end":2475,"loc":{"start":{"line":57,"column":2},"end":{"line":58,"column":31}},"expression":{"type":"CallExpression","start":2390,"end":2475,"loc":{"start":{"line":57,"column":2},"end":{"line":58,"column":31}},"callee":{"type":"MemberExpression","start":2390,"end":2416,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":28}},"object":{"type":"Identifier","start":2390,"end":2397,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":9},"identifierName":"checker"},"name":"checker"},"property":{"type":"Identifier","start":2398,"end":2416,"loc":{"start":{"line":57,"column":10},"end":{"line":57,"column":28},"identifierName":"confCheckParameter"},"name":"confCheckParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":2418,"end":2442,"loc":{"start":{"line":57,"column":30},"end":{"line":57,"column":54}},"extra":{"rawValue":"LAMBDA_ATTRACTIONPOINT","raw":"\"LAMBDA_ATTRACTIONPOINT\""},"value":"LAMBDA_ATTRACTIONPOINT"},{"type":"StringLiteral","start":2447,"end":2458,"loc":{"start":{"line":58,"column":3},"end":{"line":58,"column":14}},"extra":{"rawValue":"KindArray","raw":"\"KindArray\""},"value":"KindArray"},{"type":"StringLiteral","start":2460,"end":2473,"loc":{"start":{"line":58,"column":16},"end":{"line":58,"column":29}},"extra":{"rawValue":"NonNegative","raw":"\"NonNegative\""},"value":"NonNegative"}],"trailingComments":null},"trailingComments":[{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}}]},{"type":"ExpressionStatement","start":2523,"end":2571,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":50}},"expression":{"type":"CallExpression","start":2523,"end":2571,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":50}},"callee":{"type":"MemberExpression","start":2523,"end":2550,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":29}},"object":{"type":"Identifier","start":2523,"end":2530,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":9},"identifierName":"checker"},"name":"checker","leadingComments":null},"property":{"type":"Identifier","start":2531,"end":2550,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":29},"identifierName":"confCheckPresenceOf"},"name":"confCheckPresenceOf"},"computed":false,"leadingComments":null},"arguments":[{"type":"StringLiteral","start":2552,"end":2569,"loc":{"start":{"line":61,"column":31},"end":{"line":61,"column":48}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"}],"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}}]},{"type":"VariableDeclaration","start":2574,"end":2611,"loc":{"start":{"line":62,"column":2},"end":{"line":62,"column":39}},"declarations":[{"type":"VariableDeclarator","start":2578,"end":2611,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":39}},"id":{"type":"Identifier","start":2578,"end":2580,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":8},"identifierName":"pt"},"name":"pt"},"init":{"type":"MemberExpression","start":2583,"end":2611,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":39}},"object":{"type":"MemberExpression","start":2583,"end":2592,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":20}},"object":{"type":"ThisExpression","start":2583,"end":2587,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":15}}},"property":{"type":"Identifier","start":2588,"end":2592,"loc":{"start":{"line":62,"column":16},"end":{"line":62,"column":20},"identifierName":"conf"},"name":"conf"},"computed":false},"property":{"type":"StringLiteral","start":2593,"end":2610,"loc":{"start":{"line":62,"column":21},"end":{"line":62,"column":38}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"},"computed":true}}],"kind":"let"},{"type":"IfStatement","start":2614,"end":2754,"loc":{"start":{"line":63,"column":2},"end":{"line":66,"column":3}},"test":{"type":"UnaryExpression","start":2618,"end":2643,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":31}},"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":2619,"end":2643,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":31}},"callee":{"type":"MemberExpression","start":2619,"end":2639,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":27}},"object":{"type":"Identifier","start":2619,"end":2626,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":14},"identifierName":"checker"},"name":"checker"},"property":{"type":"Identifier","start":2627,"end":2639,"loc":{"start":{"line":63,"column":15},"end":{"line":63,"column":27},"identifierName":"isCoordinate"},"name":"isCoordinate"},"computed":false},"arguments":[{"type":"Identifier","start":2640,"end":2642,"loc":{"start":{"line":63,"column":28},"end":{"line":63,"column":30},"identifierName":"pt"},"name":"pt"}]},"extra":{"parenthesizedArgument":false}},"consequent":{"type":"BlockStatement","start":2645,"end":2754,"loc":{"start":{"line":63,"column":33},"end":{"line":66,"column":3}},"body":[{"type":"ThrowStatement","start":2650,"end":2750,"loc":{"start":{"line":64,"column":3},"end":{"line":65,"column":31}},"argument":{"type":"BinaryExpression","start":2657,"end":2748,"loc":{"start":{"line":64,"column":10},"end":{"line":65,"column":29}},"left":{"type":"StringLiteral","start":2657,"end":2716,"loc":{"start":{"line":64,"column":10},"end":{"line":64,"column":69}},"extra":{"rawValue":"ATTRACTIONPOINT must be a coordinate array with the same ","raw":"\"ATTRACTIONPOINT must be a coordinate array with the same \""},"value":"ATTRACTIONPOINT must be a coordinate array with the same "},"operator":"+","right":{"type":"StringLiteral","start":2723,"end":2748,"loc":{"start":{"line":65,"column":4},"end":{"line":65,"column":29}},"extra":{"rawValue":"dimensions as the grid!","raw":"\"dimensions as the grid!\""},"value":"dimensions as the grid!"},"extra":{"parenthesized":true,"parenStart":2655}}}],"directives":[]},"alternate":null}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}}],"trailingComments":[{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}}]},{"type":"ClassMethod","start":3425,"end":6010,"loc":{"start":{"line":81,"column":1},"end":{"line":147,"column":2}},"static":false,"computed":false,"key":{"type":"Identifier","start":3425,"end":3431,"loc":{"start":{"line":81,"column":1},"end":{"line":81,"column":7},"identifierName":"deltaH"},"name":"deltaH","leadingComments":null},"kind":"method","id":null,"generator":false,"expression":false,"async":false,"params":[{"type":"Identifier","start":3433,"end":3438,"loc":{"start":{"line":81,"column":9},"end":{"line":81,"column":14},"identifierName":"src_i"},"name":"src_i"},{"type":"Identifier","start":3440,"end":3445,"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":21},"identifierName":"tgt_i"},"name":"tgt_i"},{"type":"Identifier","start":3447,"end":3455,"loc":{"start":{"line":81,"column":23},"end":{"line":81,"column":31},"identifierName":"src_type"},"name":"src_type"},{"type":"Identifier","start":3457,"end":3465,"loc":{"start":{"line":81,"column":33},"end":{"line":81,"column":41},"identifierName":"tgt_type"},"name":"tgt_type"}],"body":{"type":"BlockStatement","start":3467,"end":6010,"loc":{"start":{"line":81,"column":43},"end":{"line":147,"column":2}},"body":[{"type":"VariableDeclaration","start":3657,"end":3720,"loc":{"start":{"line":86,"column":2},"end":{"line":86,"column":65}},"declarations":[{"type":"VariableDeclarator","start":3661,"end":3720,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":65}},"id":{"type":"Identifier","start":3661,"end":3662,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":7},"identifierName":"l"},"name":"l","leadingComments":null},"init":{"type":"CallExpression","start":3665,"end":3720,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":65}},"callee":{"type":"MemberExpression","start":3665,"end":3683,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":28}},"object":{"type":"ThisExpression","start":3665,"end":3669,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":14}}},"property":{"type":"Identifier","start":3670,"end":3683,"loc":{"start":{"line":86,"column":15},"end":{"line":86,"column":28},"identifierName":"cellParameter"},"name":"cellParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":3684,"end":3708,"loc":{"start":{"line":86,"column":29},"end":{"line":86,"column":53}},"extra":{"rawValue":"LAMBDA_ATTRACTIONPOINT","raw":"\"LAMBDA_ATTRACTIONPOINT\""},"value":"LAMBDA_ATTRACTIONPOINT"},{"type":"Identifier","start":3710,"end":3718,"loc":{"start":{"line":86,"column":55},"end":{"line":86,"column":63},"identifierName":"src_type"},"name":"src_type"}]},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" deltaH is only non-zero when the source pixel belongs to a cell with","start":3472,"end":3543,"loc":{"start":{"line":83,"column":2},"end":{"line":83,"column":73}}},{"type":"CommentLine","value":" an attraction point, so it does not act on copy attempts where the","start":3546,"end":3615,"loc":{"start":{"line":84,"column":2},"end":{"line":84,"column":71}}},{"type":"CommentLine","value":" background would invade the cell.","start":3618,"end":3654,"loc":{"start":{"line":85,"column":2},"end":{"line":85,"column":38}}}]},{"type":"IfStatement","start":3723,"end":3748,"loc":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"test":{"type":"UnaryExpression","start":3727,"end":3729,"loc":{"start":{"line":87,"column":6},"end":{"line":87,"column":8}},"operator":"!","prefix":true,"argument":{"type":"Identifier","start":3728,"end":3729,"loc":{"start":{"line":87,"column":7},"end":{"line":87,"column":8},"identifierName":"l"},"name":"l"},"extra":{"parenthesizedArgument":false}},"consequent":{"type":"BlockStatement","start":3731,"end":3748,"loc":{"start":{"line":87,"column":10},"end":{"line":89,"column":3}},"body":[{"type":"ReturnStatement","start":3736,"end":3744,"loc":{"start":{"line":88,"column":3},"end":{"line":88,"column":11}},"argument":{"type":"NumericLiteral","start":3743,"end":3744,"loc":{"start":{"line":88,"column":10},"end":{"line":88,"column":11}},"extra":{"rawValue":0,"raw":"0"},"value":0}}],"directives":[],"trailingComments":null},"alternate":null,"trailingComments":[{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}}]},{"type":"VariableDeclaration","start":3935,"end":3964,"loc":{"start":{"line":94,"column":2},"end":{"line":94,"column":31}},"declarations":[{"type":"VariableDeclarator","start":3939,"end":3964,"loc":{"start":{"line":94,"column":6},"end":{"line":94,"column":31}},"id":{"type":"Identifier","start":3939,"end":3944,"loc":{"start":{"line":94,"column":6},"end":{"line":94,"column":11},"identifierName":"torus"},"name":"torus","leadingComments":null},"init":{"type":"MemberExpression","start":3947,"end":3964,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":31}},"object":{"type":"MemberExpression","start":3947,"end":3958,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":25}},"object":{"type":"MemberExpression","start":3947,"end":3953,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":20}},"object":{"type":"ThisExpression","start":3947,"end":3951,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":18}}},"property":{"type":"Identifier","start":3952,"end":3953,"loc":{"start":{"line":94,"column":19},"end":{"line":94,"column":20},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":3954,"end":3958,"loc":{"start":{"line":94,"column":21},"end":{"line":94,"column":25},"identifierName":"conf"},"name":"conf"},"computed":false},"property":{"type":"Identifier","start":3959,"end":3964,"loc":{"start":{"line":94,"column":26},"end":{"line":94,"column":31},"identifierName":"torus"},"name":"torus","leadingComments":null,"trailingComments":null},"computed":false,"trailingComments":null},"leadingComments":null,"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}}],"trailingComments":[{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}}]},{"type":"VariableDeclaration","start":4077,"end":4135,"loc":{"start":{"line":98,"column":2},"end":{"line":98,"column":60}},"declarations":[{"type":"VariableDeclarator","start":4081,"end":4135,"loc":{"start":{"line":98,"column":6},"end":{"line":98,"column":60}},"id":{"type":"Identifier","start":4081,"end":4084,"loc":{"start":{"line":98,"column":6},"end":{"line":98,"column":9},"identifierName":"tgt"},"name":"tgt","leadingComments":null},"init":{"type":"CallExpression","start":4087,"end":4135,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":60}},"callee":{"type":"MemberExpression","start":4087,"end":4105,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":30}},"object":{"type":"ThisExpression","start":4087,"end":4091,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":16}}},"property":{"type":"Identifier","start":4092,"end":4105,"loc":{"start":{"line":98,"column":17},"end":{"line":98,"column":30},"identifierName":"cellParameter"},"name":"cellParameter"},"computed":false},"arguments":[{"type":"StringLiteral","start":4106,"end":4123,"loc":{"start":{"line":98,"column":31},"end":{"line":98,"column":48}},"extra":{"rawValue":"ATTRACTIONPOINT","raw":"\"ATTRACTIONPOINT\""},"value":"ATTRACTIONPOINT"},{"type":"Identifier","start":4125,"end":4133,"loc":{"start":{"line":98,"column":50},"end":{"line":98,"column":58},"identifierName":"src_type"},"name":"src_type"}]},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}}]},{"type":"VariableDeclaration","start":4138,"end":4202,"loc":{"start":{"line":99,"column":2},"end":{"line":99,"column":66}},"declarations":[{"type":"VariableDeclarator","start":4142,"end":4171,"loc":{"start":{"line":99,"column":6},"end":{"line":99,"column":35}},"id":{"type":"Identifier","start":4142,"end":4144,"loc":{"start":{"line":99,"column":6},"end":{"line":99,"column":8},"identifierName":"p1"},"name":"p1"},"init":{"type":"CallExpression","start":4147,"end":4171,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":35}},"callee":{"type":"MemberExpression","start":4147,"end":4162,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":26}},"object":{"type":"MemberExpression","start":4147,"end":4158,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":22}},"object":{"type":"MemberExpression","start":4147,"end":4153,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":17}},"object":{"type":"ThisExpression","start":4147,"end":4151,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":15}}},"property":{"type":"Identifier","start":4152,"end":4153,"loc":{"start":{"line":99,"column":16},"end":{"line":99,"column":17},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":4154,"end":4158,"loc":{"start":{"line":99,"column":18},"end":{"line":99,"column":22},"identifierName":"grid"},"name":"grid"},"computed":false},"property":{"type":"Identifier","start":4159,"end":4162,"loc":{"start":{"line":99,"column":23},"end":{"line":99,"column":26},"identifierName":"i2p"},"name":"i2p"},"computed":false},"arguments":[{"type":"Identifier","start":4164,"end":4169,"loc":{"start":{"line":99,"column":28},"end":{"line":99,"column":33},"identifierName":"src_i"},"name":"src_i"}]}},{"type":"VariableDeclarator","start":4173,"end":4202,"loc":{"start":{"line":99,"column":37},"end":{"line":99,"column":66}},"id":{"type":"Identifier","start":4173,"end":4175,"loc":{"start":{"line":99,"column":37},"end":{"line":99,"column":39},"identifierName":"p2"},"name":"p2"},"init":{"type":"CallExpression","start":4178,"end":4202,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":66}},"callee":{"type":"MemberExpression","start":4178,"end":4193,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":57}},"object":{"type":"MemberExpression","start":4178,"end":4189,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":53}},"object":{"type":"MemberExpression","start":4178,"end":4184,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":48}},"object":{"type":"ThisExpression","start":4178,"end":4182,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":46}}},"property":{"type":"Identifier","start":4183,"end":4184,"loc":{"start":{"line":99,"column":47},"end":{"line":99,"column":48},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":4185,"end":4189,"loc":{"start":{"line":99,"column":49},"end":{"line":99,"column":53},"identifierName":"grid"},"name":"grid"},"computed":false},"property":{"type":"Identifier","start":4190,"end":4193,"loc":{"start":{"line":99,"column":54},"end":{"line":99,"column":57},"identifierName":"i2p"},"name":"i2p"},"computed":false},"arguments":[{"type":"Identifier","start":4195,"end":4200,"loc":{"start":{"line":99,"column":59},"end":{"line":99,"column":64},"identifierName":"tgt_i"},"name":"tgt_i"}],"trailingComments":null},"trailingComments":null}],"kind":"let","trailingComments":[{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}}]},{"type":"VariableDeclaration","start":4608,"end":4629,"loc":{"start":{"line":107,"column":2},"end":{"line":107,"column":23}},"declarations":[{"type":"VariableDeclarator","start":4612,"end":4618,"loc":{"start":{"line":107,"column":6},"end":{"line":107,"column":12}},"id":{"type":"Identifier","start":4612,"end":4613,"loc":{"start":{"line":107,"column":6},"end":{"line":107,"column":7},"identifierName":"r"},"name":"r","leadingComments":null},"init":{"type":"NumericLiteral","start":4616,"end":4618,"loc":{"start":{"line":107,"column":10},"end":{"line":107,"column":12}},"extra":{"rawValue":0,"raw":"0."},"value":0},"leadingComments":null},{"type":"VariableDeclarator","start":4620,"end":4629,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":23}},"id":{"type":"Identifier","start":4620,"end":4624,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":18},"identifierName":"ldir"},"name":"ldir"},"init":{"type":"NumericLiteral","start":4627,"end":4629,"loc":{"start":{"line":107,"column":21},"end":{"line":107,"column":23}},"extra":{"rawValue":0,"raw":"0."},"value":0,"leadingComments":null,"trailingComments":null},"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}}],"trailingComments":[{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}}]},{"type":"ForStatement","start":4673,"end":5506,"loc":{"start":{"line":110,"column":2},"end":{"line":137,"column":3}},"init":{"type":"VariableDeclaration","start":4678,"end":4687,"loc":{"start":{"line":110,"column":7},"end":{"line":110,"column":16}},"declarations":[{"type":"VariableDeclarator","start":4682,"end":4687,"loc":{"start":{"line":110,"column":11},"end":{"line":110,"column":16}},"id":{"type":"Identifier","start":4682,"end":4683,"loc":{"start":{"line":110,"column":11},"end":{"line":110,"column":12},"identifierName":"i"},"name":"i","leadingComments":null},"init":{"type":"NumericLiteral","start":4686,"end":4687,"loc":{"start":{"line":110,"column":15},"end":{"line":110,"column":16}},"extra":{"rawValue":0,"raw":"0"},"value":0},"leadingComments":null}],"kind":"let","leadingComments":null},"test":{"type":"BinaryExpression","start":4689,"end":4702,"loc":{"start":{"line":110,"column":18},"end":{"line":110,"column":31}},"left":{"type":"Identifier","start":4689,"end":4690,"loc":{"start":{"line":110,"column":18},"end":{"line":110,"column":19},"identifierName":"i"},"name":"i"},"operator":"<","right":{"type":"MemberExpression","start":4693,"end":4702,"loc":{"start":{"line":110,"column":22},"end":{"line":110,"column":31}},"object":{"type":"Identifier","start":4693,"end":4695,"loc":{"start":{"line":110,"column":22},"end":{"line":110,"column":24},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":4696,"end":4702,"loc":{"start":{"line":110,"column":25},"end":{"line":110,"column":31},"identifierName":"length"},"name":"length"},"computed":false}},"update":{"type":"UpdateExpression","start":4705,"end":4708,"loc":{"start":{"line":110,"column":34},"end":{"line":110,"column":37}},"operator":"++","prefix":false,"argument":{"type":"Identifier","start":4705,"end":4706,"loc":{"start":{"line":110,"column":34},"end":{"line":110,"column":35},"identifierName":"i"},"name":"i"}},"body":{"type":"BlockStatement","start":4710,"end":5506,"loc":{"start":{"line":110,"column":39},"end":{"line":137,"column":3}},"body":[{"type":"VariableDeclaration","start":4853,"end":4879,"loc":{"start":{"line":114,"column":3},"end":{"line":114,"column":29}},"declarations":[{"type":"VariableDeclarator","start":4857,"end":4879,"loc":{"start":{"line":114,"column":7},"end":{"line":114,"column":29}},"id":{"type":"Identifier","start":4857,"end":4862,"loc":{"start":{"line":114,"column":7},"end":{"line":114,"column":12},"identifierName":"dir_i"},"name":"dir_i","leadingComments":null},"init":{"type":"BinaryExpression","start":4865,"end":4879,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":29}},"left":{"type":"MemberExpression","start":4865,"end":4871,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":21}},"object":{"type":"Identifier","start":4865,"end":4868,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":18},"identifierName":"tgt"},"name":"tgt"},"property":{"type":"Identifier","start":4869,"end":4870,"loc":{"start":{"line":114,"column":19},"end":{"line":114,"column":20},"identifierName":"i"},"name":"i"},"computed":true},"operator":"-","right":{"type":"MemberExpression","start":4874,"end":4879,"loc":{"start":{"line":114,"column":24},"end":{"line":114,"column":29}},"object":{"type":"Identifier","start":4874,"end":4876,"loc":{"start":{"line":114,"column":24},"end":{"line":114,"column":26},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":4877,"end":4878,"loc":{"start":{"line":114,"column":27},"end":{"line":114,"column":28},"identifierName":"i"},"name":"i"},"computed":true}},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" compute the distance between the target and the current position","start":4716,"end":4783,"loc":{"start":{"line":112,"column":3},"end":{"line":112,"column":70}}},{"type":"CommentLine","value":" in this dimension, and add it in squared form to the total.","start":4787,"end":4849,"loc":{"start":{"line":113,"column":3},"end":{"line":113,"column":65}}}]},{"type":"ExpressionStatement","start":4883,"end":4904,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":24}},"expression":{"type":"AssignmentExpression","start":4883,"end":4904,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":24}},"operator":"+=","left":{"type":"Identifier","start":4883,"end":4887,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":7},"identifierName":"ldir"},"name":"ldir"},"right":{"type":"BinaryExpression","start":4891,"end":4904,"loc":{"start":{"line":115,"column":11},"end":{"line":115,"column":24}},"left":{"type":"Identifier","start":4891,"end":4896,"loc":{"start":{"line":115,"column":11},"end":{"line":115,"column":16},"identifierName":"dir_i"},"name":"dir_i"},"operator":"*","right":{"type":"Identifier","start":4899,"end":4904,"loc":{"start":{"line":115,"column":19},"end":{"line":115,"column":24},"identifierName":"dir_i"},"name":"dir_i","leadingComments":null,"trailingComments":null},"trailingComments":null},"trailingComments":null},"trailingComments":[{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}}]},{"type":"VariableDeclaration","start":5048,"end":5070,"loc":{"start":{"line":119,"column":3},"end":{"line":119,"column":25}},"declarations":[{"type":"VariableDeclarator","start":5052,"end":5070,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":25}},"id":{"type":"Identifier","start":5052,"end":5054,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":9},"identifierName":"dx"},"name":"dx","leadingComments":null},"init":{"type":"BinaryExpression","start":5057,"end":5070,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":25}},"left":{"type":"MemberExpression","start":5057,"end":5062,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":17}},"object":{"type":"Identifier","start":5057,"end":5059,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":14},"identifierName":"p2"},"name":"p2"},"property":{"type":"Identifier","start":5060,"end":5061,"loc":{"start":{"line":119,"column":15},"end":{"line":119,"column":16},"identifierName":"i"},"name":"i"},"computed":true},"operator":"-","right":{"type":"MemberExpression","start":5065,"end":5070,"loc":{"start":{"line":119,"column":20},"end":{"line":119,"column":25}},"object":{"type":"Identifier","start":5065,"end":5067,"loc":{"start":{"line":119,"column":20},"end":{"line":119,"column":22},"identifierName":"p1"},"name":"p1"},"property":{"type":"Identifier","start":5068,"end":5069,"loc":{"start":{"line":119,"column":23},"end":{"line":119,"column":24},"identifierName":"i"},"name":"i"},"computed":true,"trailingComments":null},"trailingComments":null},"leadingComments":null,"trailingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}}],"trailingComments":[{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}}]},{"type":"VariableDeclaration","start":5160,"end":5186,"loc":{"start":{"line":123,"column":3},"end":{"line":123,"column":29}},"declarations":[{"type":"VariableDeclarator","start":5164,"end":5186,"loc":{"start":{"line":123,"column":7},"end":{"line":123,"column":29}},"id":{"type":"Identifier","start":5164,"end":5166,"loc":{"start":{"line":123,"column":7},"end":{"line":123,"column":9},"identifierName":"si"},"name":"si","leadingComments":null},"init":{"type":"MemberExpression","start":5169,"end":5186,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":29}},"object":{"type":"MemberExpression","start":5169,"end":5183,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":26}},"object":{"type":"MemberExpression","start":5169,"end":5175,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":18}},"object":{"type":"ThisExpression","start":5169,"end":5173,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":16}}},"property":{"type":"Identifier","start":5174,"end":5175,"loc":{"start":{"line":123,"column":17},"end":{"line":123,"column":18},"identifierName":"C"},"name":"C"},"computed":false},"property":{"type":"Identifier","start":5176,"end":5183,"loc":{"start":{"line":123,"column":19},"end":{"line":123,"column":26},"identifierName":"extents"},"name":"extents"},"computed":false},"property":{"type":"Identifier","start":5184,"end":5185,"loc":{"start":{"line":123,"column":27},"end":{"line":123,"column":28},"identifierName":"i"},"name":"i"},"computed":true},"leadingComments":null}],"kind":"let","leadingComments":[{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}}]},{"type":"IfStatement","start":5190,"end":5380,"loc":{"start":{"line":124,"column":3},"end":{"line":132,"column":4}},"test":{"type":"MemberExpression","start":5194,"end":5202,"loc":{"start":{"line":124,"column":7},"end":{"line":124,"column":15}},"object":{"type":"Identifier","start":5194,"end":5199,"loc":{"start":{"line":124,"column":7},"end":{"line":124,"column":12},"identifierName":"torus"},"name":"torus"},"property":{"type":"Identifier","start":5200,"end":5201,"loc":{"start":{"line":124,"column":13},"end":{"line":124,"column":14},"identifierName":"i"},"name":"i"},"computed":true},"consequent":{"type":"BlockStatement","start":5204,"end":5380,"loc":{"start":{"line":124,"column":17},"end":{"line":132,"column":4}},"body":[{"type":"IfStatement","start":5296,"end":5375,"loc":{"start":{"line":127,"column":4},"end":{"line":131,"column":5}},"test":{"type":"BinaryExpression","start":5300,"end":5309,"loc":{"start":{"line":127,"column":8},"end":{"line":127,"column":17}},"left":{"type":"Identifier","start":5300,"end":5302,"loc":{"start":{"line":127,"column":8},"end":{"line":127,"column":10},"identifierName":"dx"},"name":"dx","leadingComments":null},"operator":">","right":{"type":"BinaryExpression","start":5305,"end":5309,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":17}},"left":{"type":"Identifier","start":5305,"end":5307,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":15},"identifierName":"si"},"name":"si"},"operator":"/","right":{"type":"NumericLiteral","start":5308,"end":5309,"loc":{"start":{"line":127,"column":16},"end":{"line":127,"column":17}},"extra":{"rawValue":2,"raw":"2"},"value":2}},"leadingComments":null},"consequent":{"type":"BlockStatement","start":5311,"end":5332,"loc":{"start":{"line":127,"column":19},"end":{"line":129,"column":5}},"body":[{"type":"ExpressionStatement","start":5318,"end":5326,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":13}},"expression":{"type":"AssignmentExpression","start":5318,"end":5326,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":13}},"operator":"-=","left":{"type":"Identifier","start":5318,"end":5320,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":7},"identifierName":"dx"},"name":"dx"},"right":{"type":"Identifier","start":5324,"end":5326,"loc":{"start":{"line":128,"column":11},"end":{"line":128,"column":13},"identifierName":"si"},"name":"si"}}}],"directives":[]},"alternate":{"type":"IfStatement","start":5338,"end":5375,"loc":{"start":{"line":129,"column":11},"end":{"line":131,"column":5}},"test":{"type":"BinaryExpression","start":5342,"end":5352,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":25}},"left":{"type":"Identifier","start":5342,"end":5344,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":17},"identifierName":"dx"},"name":"dx"},"operator":"<","right":{"type":"BinaryExpression","start":5347,"end":5352,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":25}},"left":{"type":"UnaryExpression","start":5347,"end":5350,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":23}},"operator":"-","prefix":true,"argument":{"type":"Identifier","start":5348,"end":5350,"loc":{"start":{"line":129,"column":21},"end":{"line":129,"column":23},"identifierName":"si"},"name":"si"},"extra":{"parenthesizedArgument":false}},"operator":"/","right":{"type":"NumericLiteral","start":5351,"end":5352,"loc":{"start":{"line":129,"column":24},"end":{"line":129,"column":25}},"extra":{"rawValue":2,"raw":"2"},"value":2}}},"consequent":{"type":"BlockStatement","start":5354,"end":5375,"loc":{"start":{"line":129,"column":27},"end":{"line":131,"column":5}},"body":[{"type":"ExpressionStatement","start":5361,"end":5369,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":13}},"expression":{"type":"AssignmentExpression","start":5361,"end":5369,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":13}},"operator":"+=","left":{"type":"Identifier","start":5361,"end":5363,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":7},"identifierName":"dx"},"name":"dx"},"right":{"type":"Identifier","start":5367,"end":5369,"loc":{"start":{"line":130,"column":11},"end":{"line":130,"column":13},"identifierName":"si"},"name":"si"}}}],"directives":[]},"alternate":null},"leadingComments":[{"type":"CommentLine","value":" If distance is greater than half the grid size, correct the","start":5210,"end":5272,"loc":{"start":{"line":125,"column":4},"end":{"line":125,"column":66}}},{"type":"CommentLine","value":" coordinate.","start":5277,"end":5291,"loc":{"start":{"line":126,"column":4},"end":{"line":126,"column":18}}}]}],"directives":[],"trailingComments":null},"alternate":null,"trailingComments":[{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}}]},{"type":"ExpressionStatement","start":5486,"end":5501,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":18}},"expression":{"type":"AssignmentExpression","start":5486,"end":5501,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":18}},"operator":"+=","left":{"type":"Identifier","start":5486,"end":5487,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":4},"identifierName":"r"},"name":"r","leadingComments":null},"right":{"type":"BinaryExpression","start":5491,"end":5501,"loc":{"start":{"line":136,"column":8},"end":{"line":136,"column":18}},"left":{"type":"Identifier","start":5491,"end":5493,"loc":{"start":{"line":136,"column":8},"end":{"line":136,"column":10},"identifierName":"dx"},"name":"dx"},"operator":"*","right":{"type":"Identifier","start":5496,"end":5501,"loc":{"start":{"line":136,"column":13},"end":{"line":136,"column":18},"identifierName":"dir_i"},"name":"dir_i"}},"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}}]}],"directives":[],"trailingComments":null},"leadingComments":[{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}}],"trailingComments":[{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}}]},{"type":"ReturnStatement","start":5973,"end":6007,"loc":{"start":{"line":146,"column":2},"end":{"line":146,"column":36}},"argument":{"type":"BinaryExpression","start":5980,"end":6007,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":36}},"left":{"type":"BinaryExpression","start":5980,"end":5987,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":16}},"left":{"type":"UnaryExpression","start":5980,"end":5983,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":12}},"operator":"-","prefix":true,"argument":{"type":"Identifier","start":5982,"end":5983,"loc":{"start":{"line":146,"column":11},"end":{"line":146,"column":12},"identifierName":"r"},"name":"r","leadingComments":null},"extra":{"parenthesizedArgument":false},"leadingComments":null},"operator":"*","right":{"type":"Identifier","start":5986,"end":5987,"loc":{"start":{"line":146,"column":15},"end":{"line":146,"column":16},"identifierName":"l"},"name":"l"},"leadingComments":null},"operator":"/","right":{"type":"CallExpression","start":5990,"end":6007,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":36}},"callee":{"type":"MemberExpression","start":5990,"end":5999,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":28}},"object":{"type":"Identifier","start":5990,"end":5994,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":23},"identifierName":"Math"},"name":"Math"},"property":{"type":"Identifier","start":5995,"end":5999,"loc":{"start":{"line":146,"column":24},"end":{"line":146,"column":28},"identifierName":"sqrt"},"name":"sqrt"},"computed":false},"arguments":[{"type":"Identifier","start":6001,"end":6005,"loc":{"start":{"line":146,"column":30},"end":{"line":146,"column":34},"identifierName":"ldir"},"name":"ldir"}]},"leadingComments":null},"leadingComments":[{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}}]}],"directives":[]},"leadingComments":[{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}}]}]},"leadingComments":[{"type":"CommentBlock","value":"*Implements bias of motion in the direction of a supplied \"attraction point\".\n * This constraint computes the cosine of the angle alpha between the direction\n * of the copy attempt (from source to target pixel), and the direction from the\n * source to the attraction point. This cosine is 1 if these directions are\n * aligned, 0 if they are perpendicular, and 1 if they are opposite.\n * We take the negative (so that deltaH is negative for a copy attempt in the\n * right direction), and modify the strength of this bias using the lambda\n * parameter. The constraint only acts on copy attempts *from* the cell that\n * is responding to the field; it does not take into account the target pixel\n * (except for its location to determine the direction of the copy attempt).\n *\n * The current implementation works for torus grids as long as the grid size in\n * each dimension is larger than a few pixels.\n *\n * Automatic adding of this constraint via the conf object is currently not\n * supported, so you will have to add this constraint using the\n * {@link CPM#add} method.\n *\n * @example\n * // Build a CPM and add the constraint\n * let CPM = require( \"path/to/build\" )\n * let C = new CPM.CPM( [200,200], { T : 20 } )\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [[0,0],[100,100]],\n * } ) )\n *\n * // We can even add a second one at a different location\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [50,50],\n * } ) )\n ","start":104,"end":1642,"loc":{"start":{"line":5,"column":0},"end":{"line":37,"column":3}}}],"__PseudoExport__":false,"trailingComments":[]},"leadingComments":null}],"directives":[]},"comments":[{"type":"CommentBlock","value":"*Implements bias of motion in the direction of a supplied \"attraction point\".\n * This constraint computes the cosine of the angle alpha between the direction\n * of the copy attempt (from source to target pixel), and the direction from the\n * source to the attraction point. This cosine is 1 if these directions are\n * aligned, 0 if they are perpendicular, and 1 if they are opposite.\n * We take the negative (so that deltaH is negative for a copy attempt in the\n * right direction), and modify the strength of this bias using the lambda\n * parameter. The constraint only acts on copy attempts *from* the cell that\n * is responding to the field; it does not take into account the target pixel\n * (except for its location to determine the direction of the copy attempt).\n *\n * The current implementation works for torus grids as long as the grid size in\n * each dimension is larger than a few pixels.\n *\n * Automatic adding of this constraint via the conf object is currently not\n * supported, so you will have to add this constraint using the\n * {@link CPM#add} method.\n *\n * @example\n * // Build a CPM and add the constraint\n * let CPM = require( \"path/to/build\" )\n * let C = new CPM.CPM( [200,200], { T : 20 } )\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [[0,0],[100,100]],\n * } ) )\n *\n * // We can even add a second one at a different location\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [50,50],\n * } ) )\n ","start":104,"end":1642,"loc":{"start":{"line":5,"column":0},"end":{"line":37,"column":3}}},{"type":"CommentBlock","value":"* The constructor of an AttractionPointConstraint requires a conf object\n\t * with two parameters.\n\t * @param {object} conf - parameter object for this constraint\n\t * @param {PerKindNonNegative} conf.LAMBDA_ATTRACTIONPOINT - strength of\n\t * the constraint per cellkind.\n\t * @param {ArrayCoordinate} conf.ATTRACTIONPOINT coordinate of the\n\t * attraction point.\n\t","start":1702,"end":2066,"loc":{"start":{"line":40,"column":1},"end":{"line":47,"column":3}}},{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}},{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}},{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}},{"type":"CommentLine","value":" deltaH is only non-zero when the source pixel belongs to a cell with","start":3472,"end":3543,"loc":{"start":{"line":83,"column":2},"end":{"line":83,"column":73}}},{"type":"CommentLine","value":" an attraction point, so it does not act on copy attempts where the","start":3546,"end":3615,"loc":{"start":{"line":84,"column":2},"end":{"line":84,"column":71}}},{"type":"CommentLine","value":" background would invade the cell.","start":3618,"end":3654,"loc":{"start":{"line":85,"column":2},"end":{"line":85,"column":38}}},{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}},{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}},{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}},{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}},{"type":"CommentLine","value":" compute the distance between the target and the current position","start":4716,"end":4783,"loc":{"start":{"line":112,"column":3},"end":{"line":112,"column":70}}},{"type":"CommentLine","value":" in this dimension, and add it in squared form to the total.","start":4787,"end":4849,"loc":{"start":{"line":113,"column":3},"end":{"line":113,"column":65}}},{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}},{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}},{"type":"CommentLine","value":" If distance is greater than half the grid size, correct the","start":5210,"end":5272,"loc":{"start":{"line":125,"column":4},"end":{"line":125,"column":66}}},{"type":"CommentLine","value":" coordinate.","start":5277,"end":5291,"loc":{"start":{"line":126,"column":4},"end":{"line":126,"column":18}}},{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}},{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}}],"tokens":[{"type":{"label":"import","keyword":"import","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"import","start":0,"end":6,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"SoftConstraint","start":7,"end":21,"loc":{"start":{"line":1,"column":7},"end":{"line":1,"column":21}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"from","start":22,"end":26,"loc":{"start":{"line":1,"column":22},"end":{"line":1,"column":26}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"./SoftConstraint.js","start":27,"end":48,"loc":{"start":{"line":1,"column":27},"end":{"line":1,"column":48}}},{"type":{"label":"import","keyword":"import","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"import","start":49,"end":55,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"ParameterChecker","start":56,"end":72,"loc":{"start":{"line":2,"column":7},"end":{"line":2,"column":23}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"from","start":73,"end":77,"loc":{"start":{"line":2,"column":24},"end":{"line":2,"column":28}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"./ParameterChecker.js","start":78,"end":101,"loc":{"start":{"line":2,"column":29},"end":{"line":2,"column":52}}},{"type":"CommentBlock","value":"*Implements bias of motion in the direction of a supplied \"attraction point\".\n * This constraint computes the cosine of the angle alpha between the direction\n * of the copy attempt (from source to target pixel), and the direction from the\n * source to the attraction point. This cosine is 1 if these directions are\n * aligned, 0 if they are perpendicular, and 1 if they are opposite.\n * We take the negative (so that deltaH is negative for a copy attempt in the\n * right direction), and modify the strength of this bias using the lambda\n * parameter. The constraint only acts on copy attempts *from* the cell that\n * is responding to the field; it does not take into account the target pixel\n * (except for its location to determine the direction of the copy attempt).\n *\n * The current implementation works for torus grids as long as the grid size in\n * each dimension is larger than a few pixels.\n *\n * Automatic adding of this constraint via the conf object is currently not\n * supported, so you will have to add this constraint using the\n * {@link CPM#add} method.\n *\n * @example\n * // Build a CPM and add the constraint\n * let CPM = require( \"path/to/build\" )\n * let C = new CPM.CPM( [200,200], { T : 20 } )\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [[0,0],[100,100]],\n * } ) )\n *\n * // We can even add a second one at a different location\n * C.add( new CPM.AttractionPointConstraint( {\n * \tLAMBDA_ATTRACTIONPOINT : [0,100],\n * \tATTRACTIONPOINT: [50,50],\n * } ) )\n ","start":104,"end":1642,"loc":{"start":{"line":5,"column":0},"end":{"line":37,"column":3}}},{"type":{"label":"class","keyword":"class","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"class","start":1643,"end":1648,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"AttractionPointConstraint","start":1649,"end":1674,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":31}}},{"type":{"label":"extends","keyword":"extends","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"extends","start":1675,"end":1682,"loc":{"start":{"line":38,"column":32},"end":{"line":38,"column":39}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"SoftConstraint","start":1683,"end":1697,"loc":{"start":{"line":38,"column":40},"end":{"line":38,"column":54}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":1698,"end":1699,"loc":{"start":{"line":38,"column":55},"end":{"line":38,"column":56}}},{"type":"CommentBlock","value":"* The constructor of an AttractionPointConstraint requires a conf object\n\t * with two parameters.\n\t * @param {object} conf - parameter object for this constraint\n\t * @param {PerKindNonNegative} conf.LAMBDA_ATTRACTIONPOINT - strength of\n\t * the constraint per cellkind.\n\t * @param {ArrayCoordinate} conf.ATTRACTIONPOINT coordinate of the\n\t * attraction point.\n\t","start":1702,"end":2066,"loc":{"start":{"line":40,"column":1},"end":{"line":47,"column":3}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"constructor","start":2068,"end":2079,"loc":{"start":{"line":48,"column":1},"end":{"line":48,"column":12}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2079,"end":2080,"loc":{"start":{"line":48,"column":12},"end":{"line":48,"column":13}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"conf","start":2081,"end":2085,"loc":{"start":{"line":48,"column":14},"end":{"line":48,"column":18}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2086,"end":2087,"loc":{"start":{"line":48,"column":19},"end":{"line":48,"column":20}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2087,"end":2088,"loc":{"start":{"line":48,"column":20},"end":{"line":48,"column":21}}},{"type":{"label":"super","keyword":"super","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"super","start":2091,"end":2096,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":7}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2096,"end":2097,"loc":{"start":{"line":49,"column":7},"end":{"line":49,"column":8}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"conf","start":2098,"end":2102,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":13}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2103,"end":2104,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":15}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2108,"end":2109,"loc":{"start":{"line":50,"column":1},"end":{"line":50,"column":2}}},{"type":"CommentBlock","value":"* This method checks that all required parameters are present in the\n\t * bject supplied to the constructor, and that they are of the right format.\n\t * It throws an error when this is not the case.","start":2113,"end":2313,"loc":{"start":{"line":52,"column":1},"end":{"line":54,"column":51}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"confChecker","start":2315,"end":2326,"loc":{"start":{"line":55,"column":1},"end":{"line":55,"column":12}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2326,"end":2327,"loc":{"start":{"line":55,"column":12},"end":{"line":55,"column":13}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2327,"end":2328,"loc":{"start":{"line":55,"column":13},"end":{"line":55,"column":14}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2328,"end":2329,"loc":{"start":{"line":55,"column":14},"end":{"line":55,"column":15}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":2332,"end":2335,"loc":{"start":{"line":56,"column":2},"end":{"line":56,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"checker","start":2336,"end":2343,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":13}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":2344,"end":2345,"loc":{"start":{"line":56,"column":14},"end":{"line":56,"column":15}}},{"type":{"label":"new","keyword":"new","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"new","start":2346,"end":2349,"loc":{"start":{"line":56,"column":16},"end":{"line":56,"column":19}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"ParameterChecker","start":2350,"end":2366,"loc":{"start":{"line":56,"column":20},"end":{"line":56,"column":36}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2366,"end":2367,"loc":{"start":{"line":56,"column":36},"end":{"line":56,"column":37}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":2368,"end":2372,"loc":{"start":{"line":56,"column":38},"end":{"line":56,"column":42}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2372,"end":2373,"loc":{"start":{"line":56,"column":42},"end":{"line":56,"column":43}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"conf","start":2373,"end":2377,"loc":{"start":{"line":56,"column":43},"end":{"line":56,"column":47}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2377,"end":2378,"loc":{"start":{"line":56,"column":47},"end":{"line":56,"column":48}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":2379,"end":2383,"loc":{"start":{"line":56,"column":49},"end":{"line":56,"column":53}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2383,"end":2384,"loc":{"start":{"line":56,"column":53},"end":{"line":56,"column":54}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"C","start":2384,"end":2385,"loc":{"start":{"line":56,"column":54},"end":{"line":56,"column":55}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2386,"end":2387,"loc":{"start":{"line":56,"column":56},"end":{"line":56,"column":57}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"checker","start":2390,"end":2397,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":9}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2397,"end":2398,"loc":{"start":{"line":57,"column":9},"end":{"line":57,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"confCheckParameter","start":2398,"end":2416,"loc":{"start":{"line":57,"column":10},"end":{"line":57,"column":28}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2416,"end":2417,"loc":{"start":{"line":57,"column":28},"end":{"line":57,"column":29}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"LAMBDA_ATTRACTIONPOINT","start":2418,"end":2442,"loc":{"start":{"line":57,"column":30},"end":{"line":57,"column":54}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2442,"end":2443,"loc":{"start":{"line":57,"column":54},"end":{"line":57,"column":55}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"KindArray","start":2447,"end":2458,"loc":{"start":{"line":58,"column":3},"end":{"line":58,"column":14}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2458,"end":2459,"loc":{"start":{"line":58,"column":14},"end":{"line":58,"column":15}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"NonNegative","start":2460,"end":2473,"loc":{"start":{"line":58,"column":16},"end":{"line":58,"column":29}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2474,"end":2475,"loc":{"start":{"line":58,"column":30},"end":{"line":58,"column":31}}},{"type":"CommentLine","value":" Custom check for the attractionpoint","start":2481,"end":2520,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":41}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"checker","start":2523,"end":2530,"loc":{"start":{"line":61,"column":2},"end":{"line":61,"column":9}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2530,"end":2531,"loc":{"start":{"line":61,"column":9},"end":{"line":61,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"confCheckPresenceOf","start":2531,"end":2550,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":29}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2550,"end":2551,"loc":{"start":{"line":61,"column":29},"end":{"line":61,"column":30}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"ATTRACTIONPOINT","start":2552,"end":2569,"loc":{"start":{"line":61,"column":31},"end":{"line":61,"column":48}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2570,"end":2571,"loc":{"start":{"line":61,"column":49},"end":{"line":61,"column":50}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":2574,"end":2577,"loc":{"start":{"line":62,"column":2},"end":{"line":62,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"pt","start":2578,"end":2580,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":8}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":2581,"end":2582,"loc":{"start":{"line":62,"column":9},"end":{"line":62,"column":10}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":2583,"end":2587,"loc":{"start":{"line":62,"column":11},"end":{"line":62,"column":15}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2587,"end":2588,"loc":{"start":{"line":62,"column":15},"end":{"line":62,"column":16}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"conf","start":2588,"end":2592,"loc":{"start":{"line":62,"column":16},"end":{"line":62,"column":20}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2592,"end":2593,"loc":{"start":{"line":62,"column":20},"end":{"line":62,"column":21}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"ATTRACTIONPOINT","start":2593,"end":2610,"loc":{"start":{"line":62,"column":21},"end":{"line":62,"column":38}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2610,"end":2611,"loc":{"start":{"line":62,"column":38},"end":{"line":62,"column":39}}},{"type":{"label":"if","keyword":"if","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"if","start":2614,"end":2616,"loc":{"start":{"line":63,"column":2},"end":{"line":63,"column":4}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2616,"end":2617,"loc":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}}},{"type":{"label":"prefix","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":null,"updateContext":null},"value":"!","start":2618,"end":2619,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":7}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"checker","start":2619,"end":2626,"loc":{"start":{"line":63,"column":7},"end":{"line":63,"column":14}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":2626,"end":2627,"loc":{"start":{"line":63,"column":14},"end":{"line":63,"column":15}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"isCoordinate","start":2627,"end":2639,"loc":{"start":{"line":63,"column":15},"end":{"line":63,"column":27}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2639,"end":2640,"loc":{"start":{"line":63,"column":27},"end":{"line":63,"column":28}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"pt","start":2640,"end":2642,"loc":{"start":{"line":63,"column":28},"end":{"line":63,"column":30}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2642,"end":2643,"loc":{"start":{"line":63,"column":30},"end":{"line":63,"column":31}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2644,"end":2645,"loc":{"start":{"line":63,"column":32},"end":{"line":63,"column":33}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2645,"end":2646,"loc":{"start":{"line":63,"column":33},"end":{"line":63,"column":34}}},{"type":{"label":"throw","keyword":"throw","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"throw","start":2650,"end":2655,"loc":{"start":{"line":64,"column":3},"end":{"line":64,"column":8}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2655,"end":2656,"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":9}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"ATTRACTIONPOINT must be a coordinate array with the same ","start":2657,"end":2716,"loc":{"start":{"line":64,"column":10},"end":{"line":64,"column":69}}},{"type":{"label":"+/-","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":9,"updateContext":null},"value":"+","start":2717,"end":2718,"loc":{"start":{"line":64,"column":70},"end":{"line":64,"column":71}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"dimensions as the grid!","start":2723,"end":2748,"loc":{"start":{"line":65,"column":4},"end":{"line":65,"column":29}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2749,"end":2750,"loc":{"start":{"line":65,"column":30},"end":{"line":65,"column":31}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2753,"end":2754,"loc":{"start":{"line":66,"column":2},"end":{"line":66,"column":3}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":2756,"end":2757,"loc":{"start":{"line":67,"column":1},"end":{"line":67,"column":2}}},{"type":"CommentBlock","value":"* Method to compute the Hamiltonian for this constraint.\n\t * @param {IndexCoordinate} src_i - coordinate of the source pixel that\n\t * tries to copy.\n\t * @param {IndexCoordinate} tgt_i - coordinate of the target pixel the\n\t * source is trying to copy into.\n\t * @param {CellId} src_type - cellid of the source pixel.\n\t * @param {CellId} tgt_type - cellid of the target pixel. This argument is\n\t * not actually used but is given for consistency with other soft\n\t * constraints; the CPM always calls this method with four arguments.\n\t * @return {number} the change in Hamiltonian for this copy attempt and\n\t * this constraint. ","start":2760,"end":3387,"loc":{"start":{"line":69,"column":1},"end":{"line":79,"column":23}}},{"type":"CommentBlock","value":" eslint-disable no-unused-vars","start":3389,"end":3423,"loc":{"start":{"line":80,"column":1},"end":{"line":80,"column":35}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"deltaH","start":3425,"end":3431,"loc":{"start":{"line":81,"column":1},"end":{"line":81,"column":7}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3431,"end":3432,"loc":{"start":{"line":81,"column":7},"end":{"line":81,"column":8}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"src_i","start":3433,"end":3438,"loc":{"start":{"line":81,"column":9},"end":{"line":81,"column":14}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3438,"end":3439,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":15}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"tgt_i","start":3440,"end":3445,"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":21}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3445,"end":3446,"loc":{"start":{"line":81,"column":21},"end":{"line":81,"column":22}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"src_type","start":3447,"end":3455,"loc":{"start":{"line":81,"column":23},"end":{"line":81,"column":31}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3455,"end":3456,"loc":{"start":{"line":81,"column":31},"end":{"line":81,"column":32}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"tgt_type","start":3457,"end":3465,"loc":{"start":{"line":81,"column":33},"end":{"line":81,"column":41}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3466,"end":3467,"loc":{"start":{"line":81,"column":42},"end":{"line":81,"column":43}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3467,"end":3468,"loc":{"start":{"line":81,"column":43},"end":{"line":81,"column":44}}},{"type":"CommentLine","value":" deltaH is only non-zero when the source pixel belongs to a cell with","start":3472,"end":3543,"loc":{"start":{"line":83,"column":2},"end":{"line":83,"column":73}}},{"type":"CommentLine","value":" an attraction point, so it does not act on copy attempts where the","start":3546,"end":3615,"loc":{"start":{"line":84,"column":2},"end":{"line":84,"column":71}}},{"type":"CommentLine","value":" background would invade the cell.","start":3618,"end":3654,"loc":{"start":{"line":85,"column":2},"end":{"line":85,"column":38}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":3657,"end":3660,"loc":{"start":{"line":86,"column":2},"end":{"line":86,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"l","start":3661,"end":3662,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":7}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":3663,"end":3664,"loc":{"start":{"line":86,"column":8},"end":{"line":86,"column":9}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":3665,"end":3669,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":14}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3669,"end":3670,"loc":{"start":{"line":86,"column":14},"end":{"line":86,"column":15}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"cellParameter","start":3670,"end":3683,"loc":{"start":{"line":86,"column":15},"end":{"line":86,"column":28}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3683,"end":3684,"loc":{"start":{"line":86,"column":28},"end":{"line":86,"column":29}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"LAMBDA_ATTRACTIONPOINT","start":3684,"end":3708,"loc":{"start":{"line":86,"column":29},"end":{"line":86,"column":53}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3708,"end":3709,"loc":{"start":{"line":86,"column":53},"end":{"line":86,"column":54}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"src_type","start":3710,"end":3718,"loc":{"start":{"line":86,"column":55},"end":{"line":86,"column":63}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3719,"end":3720,"loc":{"start":{"line":86,"column":64},"end":{"line":86,"column":65}}},{"type":{"label":"if","keyword":"if","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"if","start":3723,"end":3725,"loc":{"start":{"line":87,"column":2},"end":{"line":87,"column":4}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3725,"end":3726,"loc":{"start":{"line":87,"column":4},"end":{"line":87,"column":5}}},{"type":{"label":"prefix","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":null,"updateContext":null},"value":"!","start":3727,"end":3728,"loc":{"start":{"line":87,"column":6},"end":{"line":87,"column":7}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"l","start":3728,"end":3729,"loc":{"start":{"line":87,"column":7},"end":{"line":87,"column":8}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3730,"end":3731,"loc":{"start":{"line":87,"column":9},"end":{"line":87,"column":10}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3731,"end":3732,"loc":{"start":{"line":87,"column":10},"end":{"line":87,"column":11}}},{"type":{"label":"return","keyword":"return","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"return","start":3736,"end":3742,"loc":{"start":{"line":88,"column":3},"end":{"line":88,"column":9}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":0,"start":3743,"end":3744,"loc":{"start":{"line":88,"column":10},"end":{"line":88,"column":11}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":3747,"end":3748,"loc":{"start":{"line":89,"column":2},"end":{"line":89,"column":3}}},{"type":"CommentLine","value":" To assess whether the copy attempt lies in the direction of the","start":3752,"end":3818,"loc":{"start":{"line":91,"column":2},"end":{"line":91,"column":68}}},{"type":"CommentLine","value":" attraction point, we must take into account whether the grid has","start":3821,"end":3888,"loc":{"start":{"line":92,"column":2},"end":{"line":92,"column":69}}},{"type":"CommentLine","value":" wrapped boundaries (torus; see below).","start":3891,"end":3932,"loc":{"start":{"line":93,"column":2},"end":{"line":93,"column":43}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":3935,"end":3938,"loc":{"start":{"line":94,"column":2},"end":{"line":94,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"torus","start":3939,"end":3944,"loc":{"start":{"line":94,"column":6},"end":{"line":94,"column":11}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":3945,"end":3946,"loc":{"start":{"line":94,"column":12},"end":{"line":94,"column":13}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":3947,"end":3951,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":18}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3951,"end":3952,"loc":{"start":{"line":94,"column":18},"end":{"line":94,"column":19}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"C","start":3952,"end":3953,"loc":{"start":{"line":94,"column":19},"end":{"line":94,"column":20}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3953,"end":3954,"loc":{"start":{"line":94,"column":20},"end":{"line":94,"column":21}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"conf","start":3954,"end":3958,"loc":{"start":{"line":94,"column":21},"end":{"line":94,"column":25}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":3958,"end":3959,"loc":{"start":{"line":94,"column":25},"end":{"line":94,"column":26}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"torus","start":3959,"end":3964,"loc":{"start":{"line":94,"column":26},"end":{"line":94,"column":31}}},{"type":"CommentLine","value":" tgt is the attraction point; p1 is the source location and p2 is","start":3968,"end":4035,"loc":{"start":{"line":96,"column":2},"end":{"line":96,"column":69}}},{"type":"CommentLine","value":" the location of the target pixel.","start":4038,"end":4074,"loc":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":4077,"end":4080,"loc":{"start":{"line":98,"column":2},"end":{"line":98,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"tgt","start":4081,"end":4084,"loc":{"start":{"line":98,"column":6},"end":{"line":98,"column":9}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4085,"end":4086,"loc":{"start":{"line":98,"column":10},"end":{"line":98,"column":11}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":4087,"end":4091,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":16}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4091,"end":4092,"loc":{"start":{"line":98,"column":16},"end":{"line":98,"column":17}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"cellParameter","start":4092,"end":4105,"loc":{"start":{"line":98,"column":17},"end":{"line":98,"column":30}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4105,"end":4106,"loc":{"start":{"line":98,"column":30},"end":{"line":98,"column":31}}},{"type":{"label":"string","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"ATTRACTIONPOINT","start":4106,"end":4123,"loc":{"start":{"line":98,"column":31},"end":{"line":98,"column":48}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4123,"end":4124,"loc":{"start":{"line":98,"column":48},"end":{"line":98,"column":49}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"src_type","start":4125,"end":4133,"loc":{"start":{"line":98,"column":50},"end":{"line":98,"column":58}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4134,"end":4135,"loc":{"start":{"line":98,"column":59},"end":{"line":98,"column":60}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":4138,"end":4141,"loc":{"start":{"line":99,"column":2},"end":{"line":99,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p1","start":4142,"end":4144,"loc":{"start":{"line":99,"column":6},"end":{"line":99,"column":8}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4145,"end":4146,"loc":{"start":{"line":99,"column":9},"end":{"line":99,"column":10}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":4147,"end":4151,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":15}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4151,"end":4152,"loc":{"start":{"line":99,"column":15},"end":{"line":99,"column":16}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"C","start":4152,"end":4153,"loc":{"start":{"line":99,"column":16},"end":{"line":99,"column":17}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4153,"end":4154,"loc":{"start":{"line":99,"column":17},"end":{"line":99,"column":18}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"grid","start":4154,"end":4158,"loc":{"start":{"line":99,"column":18},"end":{"line":99,"column":22}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4158,"end":4159,"loc":{"start":{"line":99,"column":22},"end":{"line":99,"column":23}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i2p","start":4159,"end":4162,"loc":{"start":{"line":99,"column":23},"end":{"line":99,"column":26}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4162,"end":4163,"loc":{"start":{"line":99,"column":26},"end":{"line":99,"column":27}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"src_i","start":4164,"end":4169,"loc":{"start":{"line":99,"column":28},"end":{"line":99,"column":33}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4170,"end":4171,"loc":{"start":{"line":99,"column":34},"end":{"line":99,"column":35}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4171,"end":4172,"loc":{"start":{"line":99,"column":35},"end":{"line":99,"column":36}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p2","start":4173,"end":4175,"loc":{"start":{"line":99,"column":37},"end":{"line":99,"column":39}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4176,"end":4177,"loc":{"start":{"line":99,"column":40},"end":{"line":99,"column":41}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":4178,"end":4182,"loc":{"start":{"line":99,"column":42},"end":{"line":99,"column":46}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4182,"end":4183,"loc":{"start":{"line":99,"column":46},"end":{"line":99,"column":47}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"C","start":4183,"end":4184,"loc":{"start":{"line":99,"column":47},"end":{"line":99,"column":48}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4184,"end":4185,"loc":{"start":{"line":99,"column":48},"end":{"line":99,"column":49}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"grid","start":4185,"end":4189,"loc":{"start":{"line":99,"column":49},"end":{"line":99,"column":53}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4189,"end":4190,"loc":{"start":{"line":99,"column":53},"end":{"line":99,"column":54}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i2p","start":4190,"end":4193,"loc":{"start":{"line":99,"column":54},"end":{"line":99,"column":57}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4193,"end":4194,"loc":{"start":{"line":99,"column":57},"end":{"line":99,"column":58}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"tgt_i","start":4195,"end":4200,"loc":{"start":{"line":99,"column":59},"end":{"line":99,"column":64}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4201,"end":4202,"loc":{"start":{"line":99,"column":65},"end":{"line":99,"column":66}}},{"type":"CommentLine","value":" To bias a copy attempt p1 -> p2 in the direction of vector 'dir'.","start":4206,"end":4274,"loc":{"start":{"line":101,"column":2},"end":{"line":101,"column":70}}},{"type":"CommentLine","value":" r will contain the dot product of the copy attempt vector and the","start":4277,"end":4345,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":70}}},{"type":"CommentLine","value":" vector pointing from the source pixel to the attraction point.","start":4348,"end":4413,"loc":{"start":{"line":103,"column":2},"end":{"line":103,"column":67}}},{"type":"CommentLine","value":" The copy attempt vector always has length one, but the vector to the","start":4416,"end":4487,"loc":{"start":{"line":104,"column":2},"end":{"line":104,"column":73}}},{"type":"CommentLine","value":" attraction point has a variable length that will be stored in ldir","start":4490,"end":4559,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":71}}},{"type":"CommentLine","value":" (actually, we store the squared length).","start":4562,"end":4605,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":4608,"end":4611,"loc":{"start":{"line":107,"column":2},"end":{"line":107,"column":5}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"r","start":4612,"end":4613,"loc":{"start":{"line":107,"column":6},"end":{"line":107,"column":7}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4614,"end":4615,"loc":{"start":{"line":107,"column":8},"end":{"line":107,"column":9}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":0,"start":4616,"end":4618,"loc":{"start":{"line":107,"column":10},"end":{"line":107,"column":12}}},{"type":{"label":",","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4618,"end":4619,"loc":{"start":{"line":107,"column":12},"end":{"line":107,"column":13}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"ldir","start":4620,"end":4624,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":18}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4625,"end":4626,"loc":{"start":{"line":107,"column":19},"end":{"line":107,"column":20}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":0,"start":4627,"end":4629,"loc":{"start":{"line":107,"column":21},"end":{"line":107,"column":23}}},{"type":"CommentLine","value":" loops over the coordinates x,y,(z)","start":4633,"end":4670,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}},{"type":{"label":"for","keyword":"for","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":true,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"for","start":4673,"end":4676,"loc":{"start":{"line":110,"column":2},"end":{"line":110,"column":5}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4676,"end":4677,"loc":{"start":{"line":110,"column":5},"end":{"line":110,"column":6}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":4678,"end":4681,"loc":{"start":{"line":110,"column":7},"end":{"line":110,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":4682,"end":4683,"loc":{"start":{"line":110,"column":11},"end":{"line":110,"column":12}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4684,"end":4685,"loc":{"start":{"line":110,"column":13},"end":{"line":110,"column":14}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":0,"start":4686,"end":4687,"loc":{"start":{"line":110,"column":15},"end":{"line":110,"column":16}}},{"type":{"label":";","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4687,"end":4688,"loc":{"start":{"line":110,"column":16},"end":{"line":110,"column":17}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":4689,"end":4690,"loc":{"start":{"line":110,"column":18},"end":{"line":110,"column":19}}},{"type":{"label":"</>","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":7,"updateContext":null},"value":"<","start":4691,"end":4692,"loc":{"start":{"line":110,"column":20},"end":{"line":110,"column":21}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p1","start":4693,"end":4695,"loc":{"start":{"line":110,"column":22},"end":{"line":110,"column":24}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4695,"end":4696,"loc":{"start":{"line":110,"column":24},"end":{"line":110,"column":25}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"length","start":4696,"end":4702,"loc":{"start":{"line":110,"column":25},"end":{"line":110,"column":31}}},{"type":{"label":";","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4703,"end":4704,"loc":{"start":{"line":110,"column":32},"end":{"line":110,"column":33}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":4705,"end":4706,"loc":{"start":{"line":110,"column":34},"end":{"line":110,"column":35}}},{"type":{"label":"++/--","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":true,"binop":null},"value":"++","start":4706,"end":4708,"loc":{"start":{"line":110,"column":35},"end":{"line":110,"column":37}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4709,"end":4710,"loc":{"start":{"line":110,"column":38},"end":{"line":110,"column":39}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":4710,"end":4711,"loc":{"start":{"line":110,"column":39},"end":{"line":110,"column":40}}},{"type":"CommentLine","value":" compute the distance between the target and the current position","start":4716,"end":4783,"loc":{"start":{"line":112,"column":3},"end":{"line":112,"column":70}}},{"type":"CommentLine","value":" in this dimension, and add it in squared form to the total.","start":4787,"end":4849,"loc":{"start":{"line":113,"column":3},"end":{"line":113,"column":65}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":4853,"end":4856,"loc":{"start":{"line":114,"column":3},"end":{"line":114,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dir_i","start":4857,"end":4862,"loc":{"start":{"line":114,"column":7},"end":{"line":114,"column":12}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":4863,"end":4864,"loc":{"start":{"line":114,"column":13},"end":{"line":114,"column":14}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"tgt","start":4865,"end":4868,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":18}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4868,"end":4869,"loc":{"start":{"line":114,"column":18},"end":{"line":114,"column":19}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":4869,"end":4870,"loc":{"start":{"line":114,"column":19},"end":{"line":114,"column":20}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4870,"end":4871,"loc":{"start":{"line":114,"column":20},"end":{"line":114,"column":21}}},{"type":{"label":"+/-","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":9,"updateContext":null},"value":"-","start":4872,"end":4873,"loc":{"start":{"line":114,"column":22},"end":{"line":114,"column":23}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p1","start":4874,"end":4876,"loc":{"start":{"line":114,"column":24},"end":{"line":114,"column":26}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4876,"end":4877,"loc":{"start":{"line":114,"column":26},"end":{"line":114,"column":27}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":4877,"end":4878,"loc":{"start":{"line":114,"column":27},"end":{"line":114,"column":28}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":4878,"end":4879,"loc":{"start":{"line":114,"column":28},"end":{"line":114,"column":29}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"ldir","start":4883,"end":4887,"loc":{"start":{"line":115,"column":3},"end":{"line":115,"column":7}}},{"type":{"label":"_=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"+=","start":4888,"end":4890,"loc":{"start":{"line":115,"column":8},"end":{"line":115,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dir_i","start":4891,"end":4896,"loc":{"start":{"line":115,"column":11},"end":{"line":115,"column":16}}},{"type":{"label":"*","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"*","start":4897,"end":4898,"loc":{"start":{"line":115,"column":17},"end":{"line":115,"column":18}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dir_i","start":4899,"end":4904,"loc":{"start":{"line":115,"column":19},"end":{"line":115,"column":24}}},{"type":"CommentLine","value":" similarly, the distance between the source and target pixel in this","start":4909,"end":4979,"loc":{"start":{"line":117,"column":3},"end":{"line":117,"column":73}}},{"type":"CommentLine","value":" dimension (direction of the copy attempt is from p1 to p2)","start":4983,"end":5044,"loc":{"start":{"line":118,"column":3},"end":{"line":118,"column":64}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":5048,"end":5051,"loc":{"start":{"line":119,"column":3},"end":{"line":119,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5052,"end":5054,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":9}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":5055,"end":5056,"loc":{"start":{"line":119,"column":10},"end":{"line":119,"column":11}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p2","start":5057,"end":5059,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":14}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5059,"end":5060,"loc":{"start":{"line":119,"column":14},"end":{"line":119,"column":15}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":5060,"end":5061,"loc":{"start":{"line":119,"column":15},"end":{"line":119,"column":16}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5061,"end":5062,"loc":{"start":{"line":119,"column":16},"end":{"line":119,"column":17}}},{"type":{"label":"+/-","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":9,"updateContext":null},"value":"-","start":5063,"end":5064,"loc":{"start":{"line":119,"column":18},"end":{"line":119,"column":19}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"p1","start":5065,"end":5067,"loc":{"start":{"line":119,"column":20},"end":{"line":119,"column":22}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5067,"end":5068,"loc":{"start":{"line":119,"column":22},"end":{"line":119,"column":23}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":5068,"end":5069,"loc":{"start":{"line":119,"column":23},"end":{"line":119,"column":24}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5069,"end":5070,"loc":{"start":{"line":119,"column":24},"end":{"line":119,"column":25}}},{"type":"CommentLine","value":" we may have to correct for torus if a copy attempt crosses the","start":5075,"end":5140,"loc":{"start":{"line":121,"column":3},"end":{"line":121,"column":68}}},{"type":"CommentLine","value":" boundary.","start":5144,"end":5156,"loc":{"start":{"line":122,"column":3},"end":{"line":122,"column":15}}},{"type":{"label":"let","keyword":"let","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"let","start":5160,"end":5163,"loc":{"start":{"line":123,"column":3},"end":{"line":123,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"si","start":5164,"end":5166,"loc":{"start":{"line":123,"column":7},"end":{"line":123,"column":9}}},{"type":{"label":"=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"=","start":5167,"end":5168,"loc":{"start":{"line":123,"column":10},"end":{"line":123,"column":11}}},{"type":{"label":"this","keyword":"this","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"this","start":5169,"end":5173,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":16}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5173,"end":5174,"loc":{"start":{"line":123,"column":16},"end":{"line":123,"column":17}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"C","start":5174,"end":5175,"loc":{"start":{"line":123,"column":17},"end":{"line":123,"column":18}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5175,"end":5176,"loc":{"start":{"line":123,"column":18},"end":{"line":123,"column":19}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"extents","start":5176,"end":5183,"loc":{"start":{"line":123,"column":19},"end":{"line":123,"column":26}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5183,"end":5184,"loc":{"start":{"line":123,"column":26},"end":{"line":123,"column":27}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":5184,"end":5185,"loc":{"start":{"line":123,"column":27},"end":{"line":123,"column":28}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5185,"end":5186,"loc":{"start":{"line":123,"column":28},"end":{"line":123,"column":29}}},{"type":{"label":"if","keyword":"if","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"if","start":5190,"end":5192,"loc":{"start":{"line":124,"column":3},"end":{"line":124,"column":5}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5192,"end":5193,"loc":{"start":{"line":124,"column":5},"end":{"line":124,"column":6}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"torus","start":5194,"end":5199,"loc":{"start":{"line":124,"column":7},"end":{"line":124,"column":12}}},{"type":{"label":"[","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5199,"end":5200,"loc":{"start":{"line":124,"column":12},"end":{"line":124,"column":13}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"i","start":5200,"end":5201,"loc":{"start":{"line":124,"column":13},"end":{"line":124,"column":14}}},{"type":{"label":"]","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5201,"end":5202,"loc":{"start":{"line":124,"column":14},"end":{"line":124,"column":15}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5203,"end":5204,"loc":{"start":{"line":124,"column":16},"end":{"line":124,"column":17}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5204,"end":5205,"loc":{"start":{"line":124,"column":17},"end":{"line":124,"column":18}}},{"type":"CommentLine","value":" If distance is greater than half the grid size, correct the","start":5210,"end":5272,"loc":{"start":{"line":125,"column":4},"end":{"line":125,"column":66}}},{"type":"CommentLine","value":" coordinate.","start":5277,"end":5291,"loc":{"start":{"line":126,"column":4},"end":{"line":126,"column":18}}},{"type":{"label":"if","keyword":"if","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"if","start":5296,"end":5298,"loc":{"start":{"line":127,"column":4},"end":{"line":127,"column":6}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5298,"end":5299,"loc":{"start":{"line":127,"column":6},"end":{"line":127,"column":7}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5300,"end":5302,"loc":{"start":{"line":127,"column":8},"end":{"line":127,"column":10}}},{"type":{"label":"</>","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":7,"updateContext":null},"value":">","start":5303,"end":5304,"loc":{"start":{"line":127,"column":11},"end":{"line":127,"column":12}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"si","start":5305,"end":5307,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":15}}},{"type":{"label":"/","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"/","start":5307,"end":5308,"loc":{"start":{"line":127,"column":15},"end":{"line":127,"column":16}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":2,"start":5308,"end":5309,"loc":{"start":{"line":127,"column":16},"end":{"line":127,"column":17}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5310,"end":5311,"loc":{"start":{"line":127,"column":18},"end":{"line":127,"column":19}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5311,"end":5312,"loc":{"start":{"line":127,"column":19},"end":{"line":127,"column":20}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5318,"end":5320,"loc":{"start":{"line":128,"column":5},"end":{"line":128,"column":7}}},{"type":{"label":"_=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"-=","start":5321,"end":5323,"loc":{"start":{"line":128,"column":8},"end":{"line":128,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"si","start":5324,"end":5326,"loc":{"start":{"line":128,"column":11},"end":{"line":128,"column":13}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5331,"end":5332,"loc":{"start":{"line":129,"column":4},"end":{"line":129,"column":5}}},{"type":{"label":"else","keyword":"else","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"else","start":5333,"end":5337,"loc":{"start":{"line":129,"column":6},"end":{"line":129,"column":10}}},{"type":{"label":"if","keyword":"if","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"if","start":5338,"end":5340,"loc":{"start":{"line":129,"column":11},"end":{"line":129,"column":13}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5340,"end":5341,"loc":{"start":{"line":129,"column":13},"end":{"line":129,"column":14}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5342,"end":5344,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":17}}},{"type":{"label":"</>","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":7,"updateContext":null},"value":"<","start":5345,"end":5346,"loc":{"start":{"line":129,"column":18},"end":{"line":129,"column":19}}},{"type":{"label":"+/-","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":9,"updateContext":null},"value":"-","start":5347,"end":5348,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":21}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"si","start":5348,"end":5350,"loc":{"start":{"line":129,"column":21},"end":{"line":129,"column":23}}},{"type":{"label":"/","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"/","start":5350,"end":5351,"loc":{"start":{"line":129,"column":23},"end":{"line":129,"column":24}}},{"type":{"label":"num","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":2,"start":5351,"end":5352,"loc":{"start":{"line":129,"column":24},"end":{"line":129,"column":25}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5353,"end":5354,"loc":{"start":{"line":129,"column":26},"end":{"line":129,"column":27}}},{"type":{"label":"{","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5354,"end":5355,"loc":{"start":{"line":129,"column":27},"end":{"line":129,"column":28}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5361,"end":5363,"loc":{"start":{"line":130,"column":5},"end":{"line":130,"column":7}}},{"type":{"label":"_=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"+=","start":5364,"end":5366,"loc":{"start":{"line":130,"column":8},"end":{"line":130,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"si","start":5367,"end":5369,"loc":{"start":{"line":130,"column":11},"end":{"line":130,"column":13}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5374,"end":5375,"loc":{"start":{"line":131,"column":4},"end":{"line":131,"column":5}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5379,"end":5380,"loc":{"start":{"line":132,"column":3},"end":{"line":132,"column":4}}},{"type":"CommentLine","value":" direction of the gradient; add contribution of the current","start":5385,"end":5446,"loc":{"start":{"line":134,"column":3},"end":{"line":134,"column":64}}},{"type":"CommentLine","value":" dimension to the dot product.","start":5450,"end":5482,"loc":{"start":{"line":135,"column":3},"end":{"line":135,"column":35}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"r","start":5486,"end":5487,"loc":{"start":{"line":136,"column":3},"end":{"line":136,"column":4}}},{"type":{"label":"_=","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":true,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"+=","start":5488,"end":5490,"loc":{"start":{"line":136,"column":5},"end":{"line":136,"column":7}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dx","start":5491,"end":5493,"loc":{"start":{"line":136,"column":8},"end":{"line":136,"column":10}}},{"type":{"label":"*","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"*","start":5494,"end":5495,"loc":{"start":{"line":136,"column":11},"end":{"line":136,"column":12}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"dir_i","start":5496,"end":5501,"loc":{"start":{"line":136,"column":13},"end":{"line":136,"column":18}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5505,"end":5506,"loc":{"start":{"line":137,"column":2},"end":{"line":137,"column":3}}},{"type":"CommentLine","value":" divide dot product by squared length of directional vector to obtain","start":5510,"end":5581,"loc":{"start":{"line":139,"column":2},"end":{"line":139,"column":73}}},{"type":"CommentLine","value":" cosine of the angle between the copy attempt direction and the","start":5584,"end":5649,"loc":{"start":{"line":140,"column":2},"end":{"line":140,"column":67}}},{"type":"CommentLine","value":" direction to the attraction point. This cosine is 1 if they are","start":5652,"end":5718,"loc":{"start":{"line":141,"column":2},"end":{"line":141,"column":68}}},{"type":"CommentLine","value":" perfectly aligned, 0 if they are perpendicular, and negative","start":5721,"end":5784,"loc":{"start":{"line":142,"column":2},"end":{"line":142,"column":65}}},{"type":"CommentLine","value":" if the directions are opposite. Since we want to reward copy attempts","start":5787,"end":5859,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":74}}},{"type":"CommentLine","value":" in the right direction, deltaH is the negative of this (and","start":5862,"end":5924,"loc":{"start":{"line":144,"column":2},"end":{"line":144,"column":64}}},{"type":"CommentLine","value":" multiplied by the lambda weight factor).","start":5927,"end":5970,"loc":{"start":{"line":145,"column":2},"end":{"line":145,"column":45}}},{"type":{"label":"return","keyword":"return","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"return","start":5973,"end":5979,"loc":{"start":{"line":146,"column":2},"end":{"line":146,"column":8}}},{"type":{"label":"+/-","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":true,"postfix":false,"binop":9,"updateContext":null},"value":"-","start":5980,"end":5981,"loc":{"start":{"line":146,"column":9},"end":{"line":146,"column":10}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"r","start":5982,"end":5983,"loc":{"start":{"line":146,"column":11},"end":{"line":146,"column":12}}},{"type":{"label":"*","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"*","start":5984,"end":5985,"loc":{"start":{"line":146,"column":13},"end":{"line":146,"column":14}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"l","start":5986,"end":5987,"loc":{"start":{"line":146,"column":15},"end":{"line":146,"column":16}}},{"type":{"label":"/","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":10,"updateContext":null},"value":"/","start":5988,"end":5989,"loc":{"start":{"line":146,"column":17},"end":{"line":146,"column":18}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"Math","start":5990,"end":5994,"loc":{"start":{"line":146,"column":19},"end":{"line":146,"column":23}}},{"type":{"label":".","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":5994,"end":5995,"loc":{"start":{"line":146,"column":23},"end":{"line":146,"column":24}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"sqrt","start":5995,"end":5999,"loc":{"start":{"line":146,"column":24},"end":{"line":146,"column":28}}},{"type":{"label":"(","beforeExpr":true,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":5999,"end":6000,"loc":{"start":{"line":146,"column":28},"end":{"line":146,"column":29}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"ldir","start":6001,"end":6005,"loc":{"start":{"line":146,"column":30},"end":{"line":146,"column":34}}},{"type":{"label":")","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":6006,"end":6007,"loc":{"start":{"line":146,"column":35},"end":{"line":146,"column":36}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":6009,"end":6010,"loc":{"start":{"line":147,"column":1},"end":{"line":147,"column":2}}},{"type":{"label":"}","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"start":6011,"end":6012,"loc":{"start":{"line":148,"column":0},"end":{"line":148,"column":1}}},{"type":{"label":"export","keyword":"export","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"export","start":6014,"end":6020,"loc":{"start":{"line":150,"column":0},"end":{"line":150,"column":6}}},{"type":{"label":"default","keyword":"default","beforeExpr":true,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"value":"default","start":6021,"end":6028,"loc":{"start":{"line":150,"column":7},"end":{"line":150,"column":14}}},{"type":{"label":"name","beforeExpr":false,"startsExpr":true,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null},"value":"AttractionPointConstraint","start":6029,"end":6054,"loc":{"start":{"line":150,"column":15},"end":{"line":150,"column":40}}},{"type":{"label":"eof","beforeExpr":false,"startsExpr":false,"rightAssociative":false,"isLoop":false,"isAssign":false,"prefix":false,"postfix":false,"binop":null,"updateContext":null},"start":6055,"end":6055,"loc":{"start":{"line":151,"column":0},"end":{"line":151,"column":0}}}]}