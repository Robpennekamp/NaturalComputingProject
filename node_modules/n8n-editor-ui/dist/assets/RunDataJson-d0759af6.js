import{bp as m,T as g,o as d,p as l,cD as y,cz as c,ea as i,Y as _,c3 as P,e9 as f,cX as v,cF as j}from"./ParameterInputList-a8424193.js";import{m as h}from"./vue-typed-mixins-a25478b2.js";import{V as b}from"./vue-json-pretty-49f1c0cb.js";import{p as D,c as J,D as S}from"./index-3ee35394.js";import"./axios-f993d27a.js";import{y as $}from"./n8n-8025af5e.js";import{m as u}from"./pinia-ba86f1d8.js";import{M as x}from"./MappingPill-ddae2198.js";import{j as T}from"./jsonpath-da3897e0.js";const r="_!^&*",X=h(m,g,D,J).extend({name:"run-data-json-actions",props:{node:{type:Object},paneType:{type:String},sessionId:{type:String},currentOutputIndex:{type:Number},runIndex:{type:Number},displayMode:{type:String},distanceFromActive:{type:Number},selectedJsonPath:{type:String,default:r},jsonData:{type:Array,required:!0}},computed:{...u(l,d),activeNode(){return this.ndvStore.activeNode},noSelection(){return this.selectedJsonPath===r},normalisedJsonPath(){return this.noSelection?'[""]':this.selectedJsonPath}},methods:{getJsonValue(){let e=T.query(this.jsonData,`$${this.normalisedJsonPath}`)[0];this.noSelection&&(this.hasPinData?e=y(this.pinData):e=c(this.getNodeInputData(this.node,this.runIndex,this.currentOutputIndex)));let t="";return typeof e=="object"?t=JSON.stringify(e,null,2):t=e.toString(),t},getJsonItemPath(){const e=i(this.normalisedJsonPath);let t="",s="";const a=e.split("]"),n=a[0].slice(1);return s=a.slice(1).join("]"),t=`$item(${n}).$node["${this.node.name}"].json`,{path:s,startPath:t}},getJsonParameterPath(){const t=i(this.normalisedJsonPath).split("]").slice(1).join("]");let s=`$node["${this.node.name}"].json`;return this.distanceFromActive===1&&(s="$json"),{path:t,startPath:s}},handleCopyClick(e){let t;if(e.command==="value")t=this.getJsonValue(),this.$showToast({title:this.$locale.baseText("runData.copyValue.toast"),message:"",type:"success",duration:2e3});else{let a="",n="";if(e.command==="itemPath"){const o=this.getJsonItemPath();a=o.startPath,n=o.path,this.$showToast({title:this.$locale.baseText("runData.copyItemPath.toast"),message:"",type:"success",duration:2e3})}else if(e.command==="parameterPath"){const o=this.getJsonParameterPath();a=o.startPath,n=o.path,this.$showToast({title:this.$locale.baseText("runData.copyParameterPath.toast"),message:"",type:"success",duration:2e3})}!n.startsWith("[")&&!n.startsWith(".")&&n&&(n+="."),t=`{{ ${a+n} }}`}const s={value:"selection",itemPath:"item_path",parameterPath:"parameter_path"}[e.command];this.$telemetry.track("User copied ndv data",{node_type:this.activeNode.type,session_id:this.sessionId,run_index:this.runIndex,view:"json",copy_type:s,workflow_id:this.workflowsStore.workflowId,pane:this.paneType,in_execution_log:this.isReadOnly}),this.copyToClipboard(t)}}}),I="_actionsGroup_wlnwy_1",Y={actionsGroup:I},w=async()=>j(()=>import("./RunDataJsonActions-459e8b9c.js"),["assets/RunDataJsonActions-459e8b9c.js","assets/n8n-8025af5e.js","assets/vendor-df0f493f.js","assets/@fortawesome/fontawesome-svg-core-a6b9645d.js","assets/luxon-3d1ae2f1.js","assets/esprima-next-d1b163ef.js","assets/n8n-0d5db0d6.css","assets/ParameterInputList-a8424193.js","assets/pinia-ba86f1d8.js","assets/axios-f993d27a.js","assets/flatted-8b14da7d.js","assets/vue-i18n-b439dfd7.js","assets/en-bbe6b9d4.js","assets/dateformat-ef117725.js","assets/lodash-es-e1022157.js","assets/vue-typed-mixins-a25478b2.js","assets/codemirror-lang-html-n8n-728c3977.js","assets/@jsplumb/browser-ui-ddea9532.js","assets/@jsplumb/core-75ba1e73.js","assets/@jsplumb/util-79bcf4d9.js","assets/@jsplumb/common-fe415eb9.js","assets/@jsplumb/connector-bezier-c9c16c6b.js","assets/uuid-cf522c50.js","assets/codemirror-lang-n8n-expression-0036beb8.js","assets/fast-json-stable-stringify-0e965c3b.js","assets/prettier-50ab9e24.js","assets/ParameterInputList-516be1d9.css","assets/vue-json-pretty-49f1c0cb.js","assets/index-3ee35394.js","assets/@fortawesome/free-solid-svg-icons-a2911fb5.js","assets/@fortawesome/free-regular-svg-icons-74cb85f8.js","assets/@fortawesome/vue-fontawesome-1701eda0.js","assets/vue2-touch-events-2bad05e9.js","assets/v-click-outside-01179a04.js","assets/vue-fragment-f3d0cc79.js","assets/vue-agile-00cde7d9.js","assets/vue-agile-d964f598.css","assets/timeago.js-a9e71aec.js","assets/canvas-confetti-60b90aac.js","assets/file-saver-d988540e.js","assets/vue2-teleport-53e66c3b.js","assets/humanize-duration-3471cd08.js","assets/vue-infinite-loading-8e5543e4.js","assets/copy-to-clipboard-fcf36459.js","assets/index-503f7655.css","assets/MappingPill-ddae2198.js","assets/MappingPill-35c1996e.css","assets/jsonpath-da3897e0.js"]),N=h(_).extend({name:"run-data-json",components:{VueJsonPretty:b,Draggable:S,runDataJsonActions:w,MappingPill:x},props:{editMode:{type:Object},sessionId:{type:String},paneType:{type:String},node:{type:Object},inputData:{type:Array},mappingEnabled:{type:Boolean},distanceFromActive:{type:Number},runIndex:{type:Number},totalRuns:{type:Number}},data(){return{selectedJsonPath:r,draggingPath:null,displayMode:"json"}},computed:{...u(l,d),jsonData(){return c(this.inputData)}},methods:{getShortKey(e){return e?P(e.dataset.name||"",16,2):""},getJsonParameterPath(e){const t=e.replace(/^(\["?\d"?])/,"");return f({nodeName:this.node.name,distanceFromActive:this.distanceFromActive,path:t})},onDragStart(e){e&&e.dataset.path&&(this.draggingPath=e.dataset.path),this.ndvStore.resetMappingTelemetry()},onDragEnd(e){this.draggingPath=null,setTimeout(()=>{const t=this.ndvStore.mappingTelemetry,s={src_node_type:this.node.type,src_field_name:e.dataset.name||"",src_nodes_back:this.distanceFromActive,src_run_index:this.runIndex,src_runs_total:this.totalRuns,src_field_nest_level:e.dataset.depth||0,src_view:"json",src_element:e,success:!1,...t};this.$externalHooks().run("runDataJson.onDragEnd",s),this.$telemetry.track("User dragged data for mapping",s)},1e3)},getContent(e){return v(e)?`"${e}"`:JSON.stringify(e)},getListItemName(e){return e.replace(/^(\["?\d"?]\.?)/g,"")}}}),k="_jsonDisplay_1js5j_1",M="_mappable_1js5j_21",A="_dragged_1js5j_28",E={jsonDisplay:k,mappable:M,dragged:A};var O=function(){var t=this,s=t._self._c;return t._self._setupProxy,s("div",{class:t.$style.jsonDisplay},[t.editMode.enabled?t._e():s("run-data-json-actions",{attrs:{node:t.node,sessioId:t.sessionId,displayMode:t.displayMode,distanceFromActive:t.distanceFromActive,selectedJsonPath:t.selectedJsonPath,jsonData:t.jsonData,paneType:t.paneType}}),s("draggable",{attrs:{type:"mapping",targetDataKey:"mappable",disabled:!t.mappingEnabled},on:{dragstart:t.onDragStart,dragend:t.onDragEnd},scopedSlots:t._u([{key:"preview",fn:function({canDrop:a,el:n}){return[n?s("MappingPill",{attrs:{html:t.getShortKey(n),"can-drop":a}}):t._e()]}}])},[[s("vue-json-pretty",{staticClass:"json-data",attrs:{data:t.jsonData,deep:10,showLength:!0,"selected-value":t.selectedJsonPath,rootPath:"",selectableType:"single"},on:{"update:selectedValue":function(a){t.selectedJsonPath=a},"update:selected-value":function(a){t.selectedJsonPath=a}},scopedSlots:t._u([{key:"nodeKey",fn:function({node:a}){return[s("span",{class:{[t.$style.mappable]:t.mappingEnabled,[t.$style.dragged]:t.draggingPath===a.path},attrs:{"data-target":"mappable","data-value":t.getJsonParameterPath(a.path),"data-name":a.key,"data-path":a.path,"data-depth":a.level}},[t._v('"'+t._s(a.key)+'"')])]}},{key:"nodeValue",fn:function({node:a}){return[isNaN(a.index)?s("span",{staticClass:"ph-no-capture"},[t._v(t._s(t.getContent(a.content)))]):s("span",{staticClass:"ph-no-capture",class:{[t.$style.mappable]:t.mappingEnabled,[t.$style.dragged]:t.draggingPath===a.path},attrs:{"data-target":"mappable","data-value":t.getJsonParameterPath(a.path),"data-name":t.getListItemName(a.path),"data-path":a.path,"data-depth":a.level}},[t._v(t._s(t.getContent(a.content)))])]}}])})]],2)],1)},C=[];const p={$style:E};function F(e){for(var t in p)this[t]=p[t]}var V=$(N,O,C,!1,F,null,null,null);const R=V.exports,Q=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{Q as R,X as _,r as n,Y as s};
//# sourceMappingURL=RunDataJson-d0759af6.js.map
