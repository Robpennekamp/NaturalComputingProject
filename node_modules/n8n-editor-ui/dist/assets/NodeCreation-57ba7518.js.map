{"version":3,"file":"NodeCreation-57ba7518.js","sources":["../../src/components/Node/NodeCreation.vue"],"sourcesContent":["<template>\n\t<div>\n\t\t<div\n\t\t\tv-if=\"!createNodeActive\"\n\t\t\t:class=\"[$style.nodeButtonsWrapper, showStickyButton ? $style.noEvents : '']\"\n\t\t\t@mouseenter=\"onCreateMenuHoverIn\"\n\t\t>\n\t\t\t<div :class=\"$style.nodeCreatorButton\" data-test-id=\"node-creator-plus-button\">\n\t\t\t\t<n8n-icon-button\n\t\t\t\t\tsize=\"xlarge\"\n\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t:class=\"$style.nodeCreatorPlus\"\n\t\t\t\t\t@click=\"openNodeCreator\"\n\t\t\t\t\t:title=\"$locale.baseText('nodeView.addNode')\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\t:class=\"[$style.addStickyButton, showStickyButton ? $style.visibleButton : '']\"\n\t\t\t\t\t@click=\"addStickyNote\"\n\t\t\t\t\tdata-test-id=\"add-sticky-button\"\n\t\t\t\t>\n\t\t\t\t\t<n8n-icon-button\n\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t:icon=\"['far', 'note-sticky']\"\n\t\t\t\t\t\t:title=\"$locale.baseText('nodeView.addSticky')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<node-creator\n\t\t\t:active=\"createNodeActive\"\n\t\t\t@nodeTypeSelected=\"nodeTypeSelected\"\n\t\t\t@closeNodeCreator=\"closeNodeCreator\"\n\t\t/>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { getMidCanvasPosition } from '@/utils/nodeViewUtils';\nimport {\n\tDEFAULT_STICKY_HEIGHT,\n\tDEFAULT_STICKY_WIDTH,\n\tNODE_CREATOR_OPEN_SOURCES,\n\tSTICKY_NODE_TYPE,\n} from '@/constants';\nimport { mapStores } from 'pinia';\nimport { useUIStore } from '@/stores/ui.store';\n\nexport default defineComponent({\n\tname: 'node-creation',\n\tcomponents: {\n\t\tNodeCreator: async () => import('@/components/Node/NodeCreator/NodeCreator.vue'),\n\t},\n\tprops: {\n\t\tnodeViewScale: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcreateNodeActive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowStickyButton: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useUIStore),\n\t},\n\tmethods: {\n\t\tonCreateMenuHoverIn(mouseinEvent: MouseEvent) {\n\t\t\tconst buttonsWrapper = mouseinEvent.target as Element;\n\n\t\t\t// Once the popup menu is hovered, it's pointer events are disabled so it's not interfering with element underneath it.\n\t\t\tthis.showStickyButton = true;\n\t\t\tconst moveCallback = (mousemoveEvent: MouseEvent) => {\n\t\t\t\tif (buttonsWrapper) {\n\t\t\t\t\tconst wrapperBounds = buttonsWrapper.getBoundingClientRect();\n\t\t\t\t\tconst wrapperH = wrapperBounds.height;\n\t\t\t\t\tconst wrapperW = wrapperBounds.width;\n\t\t\t\t\tconst wrapperLeftNear = wrapperBounds.left;\n\t\t\t\t\tconst wrapperLeftFar = wrapperLeftNear + wrapperW;\n\t\t\t\t\tconst wrapperTopNear = wrapperBounds.top;\n\t\t\t\t\tconst wrapperTopFar = wrapperTopNear + wrapperH;\n\t\t\t\t\tconst inside =\n\t\t\t\t\t\tmousemoveEvent.pageX > wrapperLeftNear &&\n\t\t\t\t\t\tmousemoveEvent.pageX < wrapperLeftFar &&\n\t\t\t\t\t\tmousemoveEvent.pageY > wrapperTopNear &&\n\t\t\t\t\t\tmousemoveEvent.pageY < wrapperTopFar;\n\t\t\t\t\tif (!inside) {\n\t\t\t\t\t\tthis.showStickyButton = false;\n\t\t\t\t\t\tdocument.removeEventListener('mousemove', moveCallback, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tdocument.addEventListener('mousemove', moveCallback, false);\n\t\t},\n\t\topenNodeCreator() {\n\t\t\tthis.$emit('toggleNodeCreator', {\n\t\t\t\tsource: NODE_CREATOR_OPEN_SOURCES.ADD_NODE_BUTTON,\n\t\t\t\tcreateNodeActive: true,\n\t\t\t});\n\t\t},\n\t\taddStickyNote() {\n\t\t\tif (document.activeElement) {\n\t\t\t\t(document.activeElement as HTMLElement).blur();\n\t\t\t}\n\n\t\t\tconst offset: [number, number] = [...this.uiStore.nodeViewOffsetPosition];\n\n\t\t\tconst position = getMidCanvasPosition(this.nodeViewScale, offset);\n\t\t\tposition[0] -= DEFAULT_STICKY_WIDTH / 2;\n\t\t\tposition[1] -= DEFAULT_STICKY_HEIGHT / 2;\n\n\t\t\tthis.$emit('addNode', [\n\t\t\t\t{\n\t\t\t\t\tnodeTypeName: STICKY_NODE_TYPE,\n\t\t\t\t\tposition,\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tcloseNodeCreator() {\n\t\t\tthis.$emit('toggleNodeCreator', { createNodeActive: false });\n\t\t},\n\t\tnodeTypeSelected(nodeTypeNames: string[]) {\n\t\t\tthis.$emit(\n\t\t\t\t'addNode',\n\t\t\t\tnodeTypeNames.map((nodeTypeName) => ({ nodeTypeName })),\n\t\t\t);\n\t\t\tthis.closeNodeCreator();\n\t\t},\n\t},\n});\n</script>\n\n<style lang=\"scss\" module>\n.nodeButtonsWrapper {\n\tposition: fixed;\n\twidth: 150px;\n\theight: 200px;\n\ttop: 0;\n\tright: 0;\n\tdisplay: flex;\n}\n\n.addStickyButton {\n\tmargin-top: var(--spacing-2xs);\n\topacity: 0;\n\ttransition: 0.1s;\n\ttransition-timing-function: linear;\n}\n\n.visibleButton {\n\topacity: 1;\n\tpointer-events: all;\n}\n\n.noEvents {\n\tpointer-events: none;\n}\n\n.nodeCreatorButton {\n\tposition: fixed;\n\ttext-align: center;\n\ttop: calc(#{$header-height} + var(--spacing-s));\n\tright: var(--spacing-s);\n\tpointer-events: all !important;\n\n\tbutton {\n\t\tborder-color: var(--color-foreground-xdark);\n\t\tcolor: var(--color-foreground-xdark);\n\n\t\t&:hover {\n\t\t\tborder-color: var(--color-primary);\n\t\t\tcolor: var(--color-primary);\n\t\t\tbackground: var(--color-background-xlight);\n\t\t}\n\t}\n}\n.nodeCreatorPlus {\n\tborder-width: 2px;\n\tborder-radius: var(--border-radius-base);\n\twidth: 36px;\n\theight: 36px;\n}\n</style>\n"],"names":["_sfc_main","defineComponent","mapStores","useUIStore","mouseinEvent","buttonsWrapper","moveCallback","mousemoveEvent","wrapperBounds","wrapperH","wrapperW","wrapperLeftNear","wrapperLeftFar","wrapperTopNear","wrapperTopFar","NODE_CREATOR_OPEN_SOURCES","offset","position","getMidCanvasPosition","DEFAULT_STICKY_WIDTH","DEFAULT_STICKY_HEIGHT","STICKY_NODE_TYPE","nodeTypeNames","nodeTypeName"],"mappings":"o8BAkDA,MAAAA,EAAAC,EAAA,CACA,KAAA,gBACA,WAAA,CACA,YAAA,eAAA,OAAA,2BAAA,EAAA,kBAAA,CACA,EACA,MAAA,CACA,cAAA,CACA,KAAA,OACA,SAAA,EACA,EACA,iBAAA,CACA,KAAA,QACA,QAAA,EACA,CACA,EACA,MAAA,CACA,MAAA,CACA,iBAAA,EAAA,CAEA,EACA,SAAA,CACA,GAAAC,EAAAC,CAAA,CACA,EACA,QAAA,CACA,oBAAAC,EAAA,CACA,MAAAC,EAAAD,EAAA,OAGA,KAAA,iBAAA,GACA,MAAAE,EAAAC,GAAA,CACA,GAAAF,EAAA,CACA,MAAAG,EAAAH,EAAA,wBACAI,EAAAD,EAAA,OACAE,EAAAF,EAAA,MACAG,EAAAH,EAAA,KACAI,EAAAD,EAAAD,EACAG,EAAAL,EAAA,IACAM,EAAAD,EAAAJ,EAEAF,EAAA,MAAAI,GACAJ,EAAA,MAAAK,GACAL,EAAA,MAAAM,GACAN,EAAA,MAAAO,IAEA,KAAA,iBAAA,GACA,SAAA,oBAAA,YAAAR,EAAA,EAAA,EAEA,CAAA,EAEA,SAAA,iBAAA,YAAAA,EAAA,EAAA,CACA,EACA,iBAAA,CACA,KAAA,MAAA,oBAAA,CACA,OAAAS,EAAA,gBACA,iBAAA,EAAA,CACA,CACA,EACA,eAAA,CACA,SAAA,eACA,SAAA,cAAA,OAGA,MAAAC,EAAA,CAAA,GAAA,KAAA,QAAA,sBAAA,EAEAC,EAAAC,EAAA,KAAA,cAAAF,CAAA,EACAC,EAAA,CAAA,GAAAE,EAAA,EACAF,EAAA,CAAA,GAAAG,EAAA,EAEA,KAAA,MAAA,UAAA,CACA,CACA,aAAAC,EACA,SAAAJ,CACA,CAAA,CACA,CACA,EACA,kBAAA,CACA,KAAA,MAAA,oBAAA,CAAA,iBAAA,EAAA,CAAA,CACA,EACA,iBAAAK,EAAA,CACA,KAAA,MACA,UACAA,EAAA,IAAAC,IAAA,CAAA,aAAAA,CAAA,EAAA,CAAA,EAEA,KAAA,iBAAA,CACA,CACA,CACA,CAAA"}