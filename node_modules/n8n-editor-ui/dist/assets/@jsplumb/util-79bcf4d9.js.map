{"version":3,"file":"util-79bcf4d9.js","sources":["../../../../../node_modules/.pnpm/@jsplumb+util@5.13.2/node_modules/@jsplumb/util/js/jsplumb.util.es.js"],"sourcesContent":["function filterList(list, value, missingIsFalse) {\n  if (list === \"*\") {\n    return true;\n  }\n  return list.length > 0 ? list.indexOf(value) !== -1 : !missingIsFalse;\n}\nfunction extend(o1, o2, keys) {\n  var i;\n  o1 = o1 || {};\n  o2 = o2 || {};\n  var _o1 = o1,\n      _o2 = o2;\n  if (keys) {\n    for (i = 0; i < keys.length; i++) {\n      _o1[keys[i]] = _o2[keys[i]];\n    }\n  } else {\n    for (i in _o2) {\n      _o1[i] = _o2[i];\n    }\n  }\n  return o1;\n}\nfunction isNumber(n) {\n  return Object.prototype.toString.call(n) === \"[object Number]\";\n}\nfunction isString(s) {\n  return typeof s === \"string\";\n}\nfunction isBoolean(s) {\n  return typeof s === \"boolean\";\n}\nfunction isObject(o) {\n  return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\n}\nfunction isDate(o) {\n  return Object.prototype.toString.call(o) === \"[object Date]\";\n}\nfunction isFunction(o) {\n  return Object.prototype.toString.call(o) === \"[object Function]\";\n}\nfunction isNamedFunction(o) {\n  return isFunction(o) && o.name != null && o.name.length > 0;\n}\nfunction isEmpty(o) {\n  for (var i in o) {\n    if (o.hasOwnProperty(i)) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction clone(a) {\n  if (isString(a)) {\n    return \"\" + a;\n  } else if (isBoolean(a)) {\n    return !!a;\n  } else if (isDate(a)) {\n    return new Date(a.getTime());\n  } else if (isFunction(a)) {\n    return a;\n  } else if (Array.isArray(a)) {\n    var _b = [];\n    for (var i = 0; i < a.length; i++) {\n      _b.push(clone(a[i]));\n    }\n    return _b;\n  } else if (isObject(a)) {\n    var c = {};\n    for (var j in a) {\n      c[j] = clone(a[j]);\n    }\n    return c;\n  } else {\n    return a;\n  }\n}\nfunction filterNull(obj) {\n  var o = {};\n  for (var k in obj) {\n    if (obj[k] != null) {\n      o[k] = obj[k];\n    }\n  }\n  return o;\n}\nfunction merge(a, b, collations, overwrites) {\n  var cMap = {},\n      ar,\n      i,\n      oMap = {};\n  collations = collations || [];\n  overwrites = overwrites || [];\n  for (i = 0; i < collations.length; i++) {\n    cMap[collations[i]] = true;\n  }\n  for (i = 0; i < overwrites.length; i++) {\n    oMap[overwrites[i]] = true;\n  }\n  var c = clone(a);\n  for (i in b) {\n    if (c[i] == null || oMap[i]) {\n      c[i] = b[i];\n    } else if (cMap[i]) {\n      ar = [];\n      ar.push.apply(ar, Array.isArray(c[i]) ? c[i] : [c[i]]);\n      ar.push(b[i]);\n      c[i] = ar;\n    } else if (isString(b[i]) || isBoolean(b[i]) || isFunction(b[i]) || isNumber(b[i])) {\n      c[i] = b[i];\n    } else {\n      if (Array.isArray(b[i])) {\n        ar = [];\n        if (Array.isArray(c[i])) {\n          ar.push.apply(ar, c[i]);\n        }\n        ar.push.apply(ar, b[i]);\n        c[i] = ar;\n      } else if (isObject(b[i])) {\n        if (!isObject(c[i])) {\n          c[i] = {};\n        }\n        for (var j in b[i]) {\n          c[i][j] = b[i][j];\n        }\n      }\n    }\n  }\n  return c;\n}\nfunction _areEqual(a, b) {\n  if (a != null && b == null) {\n    return false;\n  } else {\n    if ((a == null || isString(a) || isBoolean(a) || isNumber(a)) && a !== b) {\n      return false;\n    } else {\n      if (Array.isArray(a)) {\n        if (!Array.isArray(b)) {\n          return false;\n        } else {\n          if (!arraysEqual(a, b)) {\n            return false;\n          }\n        }\n      } else if (isObject(a)) {\n        if (!isObject(a)) {\n          return false;\n        } else {\n          if (!objectsEqual(a, b)) {\n            return false;\n          }\n        }\n      }\n    }\n  }\n  return true;\n}\nfunction arraysEqual(a, b) {\n  if (a == null && b == null) {\n    return true;\n  } else if (a == null && b != null) {\n    return false;\n  } else if (a != null && b == null) {\n    return false;\n  }\n  if (a.length !== b.length) {\n    return false;\n  } else {\n    for (var i = 0; i < a.length; i++) {\n      if (!_areEqual(a[i], b[i])) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\nfunction objectsEqual(a, b) {\n  if (a == null && b == null) {\n    return true;\n  } else if (a == null && b != null) {\n    return false;\n  } else if (a != null && b == null) {\n    return false;\n  }\n  for (var key in a) {\n    var va = a[key],\n        vb = b[key];\n    if (!_areEqual(va, vb)) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction replace(inObj, path, value) {\n  if (inObj == null) {\n    return;\n  }\n  var q = inObj,\n      t = q;\n  path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\n    var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/),\n        last = pos + term.length >= str.length,\n        _getArray = function _getArray() {\n      return t[array[1]] || function () {\n        t[array[1]] = [];\n        return t[array[1]];\n      }();\n    };\n    if (last) {\n      if (array) {\n        _getArray()[array[3]] = value;\n      } else {\n        t[term] = value;\n      }\n    } else {\n      if (array) {\n        var _a2 = _getArray();\n        t = _a2[array[3]] || function () {\n          _a2[array[3]] = {};\n          return _a2[array[3]];\n        }();\n      } else {\n        t = t[term] || function () {\n          t[term] = {};\n          return t[term];\n        }();\n      }\n    }\n    return \"\";\n  });\n  return inObj;\n}\nfunction functionChain(successValue, failValue, fns) {\n  for (var i = 0; i < fns.length; i++) {\n    var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\n    if (o === failValue) {\n      return o;\n    }\n  }\n  return successValue;\n}\nfunction populate(model, values, functionPrefix, doNotExpandFunctions) {\n  var getValue = function getValue(fromString) {\n    var matches = fromString.match(/(\\${.*?})/g);\n    if (matches != null) {\n      for (var i = 0; i < matches.length; i++) {\n        var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\n        if (val != null) {\n          fromString = fromString.replace(matches[i], val);\n        }\n      }\n    }\n    matches = fromString.match(/({{.*?}})/g);\n    if (matches != null) {\n      for (var _i = 0; _i < matches.length; _i++) {\n        var _val = values[matches[_i].substring(2, matches[_i].length - 2)] || \"\";\n        if (_val != null) {\n          fromString = fromString.replace(matches[_i], _val);\n        }\n      }\n    }\n    return fromString;\n  };\n  var _one = function _one(d) {\n    if (d != null) {\n      if (isString(d)) {\n        return getValue(d);\n      } else if (isFunction(d) && !doNotExpandFunctions && (functionPrefix == null || (d.name || \"\").indexOf(functionPrefix) === 0)) {\n        return d(values);\n      } else if (Array.isArray(d)) {\n        var r = [];\n        for (var i = 0; i < d.length; i++) {\n          r.push(_one(d[i]));\n        }\n        return r;\n      } else if (isObject(d)) {\n        var s = {};\n        for (var j in d) {\n          s[j] = _one(d[j]);\n        }\n        return s;\n      } else {\n        return d;\n      }\n    }\n  };\n  return _one(model);\n}\nfunction forEach(a, f) {\n  if (a) {\n    for (var i = 0; i < a.length; i++) {\n      f(a[i]);\n    }\n  } else {\n    return null;\n  }\n}\nfunction findWithFunction(a, f) {\n  if (a) {\n    for (var i = 0; i < a.length; i++) {\n      if (f(a[i])) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\nfunction findAllWithFunction(a, predicate) {\n  var o = [];\n  if (a) {\n    for (var i = 0; i < a.length; i++) {\n      if (predicate(a[i])) {\n        o.push(i);\n      }\n    }\n  }\n  return o;\n}\nfunction getWithFunction(a, f) {\n  var idx = findWithFunction(a, f);\n  return idx === -1 ? null : a[idx];\n}\nfunction getAllWithFunction(a, f) {\n  var indexes = findAllWithFunction(a, f);\n  return indexes.map(function (i) {\n    return a[i];\n  });\n}\nfunction getFromSetWithFunction(s, f) {\n  var out = null;\n  s.forEach(function (t) {\n    if (f(t)) {\n      out = t;\n    }\n  });\n  return out;\n}\nfunction setToArray(s) {\n  var a = [];\n  s.forEach(function (t) {\n    a.push(t);\n  });\n  return a;\n}\nfunction removeWithFunction(a, f) {\n  var idx = findWithFunction(a, f);\n  if (idx > -1) {\n    a.splice(idx, 1);\n  }\n  return idx !== -1;\n}\nfunction fromArray(a) {\n  if (Array.fromArray != null) {\n    return Array.from(a);\n  } else {\n    var arr = [];\n    Array.prototype.push.apply(arr, a);\n    return arr;\n  }\n}\nfunction remove(l, v) {\n  var idx = l.indexOf(v);\n  if (idx > -1) {\n    l.splice(idx, 1);\n  }\n  return idx !== -1;\n}\nfunction addWithFunction(list, item, hashFunction) {\n  if (findWithFunction(list, hashFunction) === -1) {\n    list.push(item);\n  }\n}\nfunction addToDictionary(map, key, value, insertAtStart) {\n  var l = map[key];\n  if (l == null) {\n    l = [];\n    map[key] = l;\n  }\n  l[insertAtStart ? \"unshift\" : \"push\"](value);\n  return l;\n}\nfunction addToList(map, key, value, insertAtStart) {\n  var l = map.get(key);\n  if (l == null) {\n    l = [];\n    map.set(key, l);\n  }\n  l[insertAtStart ? \"unshift\" : \"push\"](value);\n  return l;\n}\nfunction suggest(list, item, insertAtHead) {\n  if (list.indexOf(item) === -1) {\n    if (insertAtHead) {\n      list.unshift(item);\n    } else {\n      list.push(item);\n    }\n    return true;\n  }\n  return false;\n}\nvar lut = [];\nfor (var i = 0; i < 256; i++) {\n  lut[i] = (i < 16 ? '0' : '') + i.toString(16);\n}\nfunction uuid() {\n  var d0 = Math.random() * 0xffffffff | 0;\n  var d1 = Math.random() * 0xffffffff | 0;\n  var d2 = Math.random() * 0xffffffff | 0;\n  var d3 = Math.random() * 0xffffffff | 0;\n  return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] + lut[d0 >> 24 & 0xff] + '-' + lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' + lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' + lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] + lut[d2 >> 24 & 0xff] + lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] + lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];\n}\nfunction rotatePoint(point, center, rotation) {\n  var radial = {\n    x: point.x - center.x,\n    y: point.y - center.y\n  },\n      cr = Math.cos(rotation / 360 * Math.PI * 2),\n      sr = Math.sin(rotation / 360 * Math.PI * 2);\n  return {\n    x: radial.x * cr - radial.y * sr + center.x,\n    y: radial.y * cr + radial.x * sr + center.y,\n    cr: cr,\n    sr: sr\n  };\n}\nfunction rotateAnchorOrientation(orientation, rotation) {\n  var r = rotatePoint({\n    x: orientation[0],\n    y: orientation[1]\n  }, {\n    x: 0,\n    y: 0\n  }, rotation);\n  return [Math.round(r.x), Math.round(r.y)];\n}\nfunction fastTrim(s) {\n  if (s == null) {\n    return null;\n  }\n  var str = s.replace(/^\\s\\s*/, ''),\n      ws = /\\s/,\n      i = str.length;\n  while (ws.test(str.charAt(--i))) {}\n  return str.slice(0, i + 1);\n}\nfunction each(obj, fn) {\n  obj = obj.length == null || typeof obj === \"string\" ? [obj] : obj;\n  for (var _i2 = 0; _i2 < obj.length; _i2++) {\n    fn(obj[_i2]);\n  }\n}\nfunction map(obj, fn) {\n  var o = [];\n  for (var _i3 = 0; _i3 < obj.length; _i3++) {\n    o.push(fn(obj[_i3]));\n  }\n  return o;\n}\nvar logEnabled = true;\nfunction log() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  if (typeof console !== \"undefined\") {\n    try {\n      var msg = arguments[arguments.length - 1];\n      console.log(msg);\n    } catch (e) {}\n  }\n}\nfunction sgn(x) {\n  return x < 0 ? -1 : x > 0 ? 1 : 0;\n}\nfunction wrap(wrappedFunction, newFunction, returnOnThisValue) {\n  return function () {\n    var r = null;\n    try {\n      if (newFunction != null) {\n        r = newFunction.apply(this, arguments);\n      }\n    } catch (e) {\n      log(\"jsPlumb function failed : \" + e);\n    }\n    if (wrappedFunction != null && (returnOnThisValue == null || r !== returnOnThisValue)) {\n      try {\n        r = wrappedFunction.apply(this, arguments);\n      } catch (e) {\n        log(\"wrapped function failed : \" + e);\n      }\n    }\n    return r;\n  };\n}\nfunction getsert(map, key, valueGenerator) {\n  if (!map.has(key)) {\n    map.set(key, valueGenerator());\n  }\n  return map.get(key);\n}\nfunction isAssignableFrom(object, cls) {\n  var proto = object.__proto__;\n  while (proto != null) {\n    if (proto instanceof cls) {\n      return true;\n    } else {\n      proto = proto.__proto__;\n    }\n  }\n  return false;\n}\nfunction insertSorted(value, array, comparator, sortDescending) {\n  if (array.length === 0) {\n    array.push(value);\n  } else {\n    var flip = sortDescending ? -1 : 1;\n    var min = 0;\n    var max = array.length;\n    var index = Math.floor((min + max) / 2);\n    while (max > min) {\n      var c = comparator(value, array[index]) * flip;\n      if (c < 0) {\n        max = index;\n      } else {\n        min = index + 1;\n      }\n      index = Math.floor((min + max) / 2);\n    }\n    array.splice(index, 0, value);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nvar EventGenerator = function () {\n  function EventGenerator() {\n    _classCallCheck(this, EventGenerator);\n    _defineProperty(this, \"_listeners\", {});\n    _defineProperty(this, \"eventsSuspended\", false);\n    _defineProperty(this, \"tick\", false);\n    _defineProperty(this, \"eventsToDieOn\", {\n      \"ready\": true\n    });\n    _defineProperty(this, \"queue\", []);\n  }\n  _createClass(EventGenerator, [{\n    key: \"fire\",\n    value: function fire(event, value, originalEvent) {\n      var ret = null;\n      if (!this.tick) {\n        this.tick = true;\n        if (!this.eventsSuspended && this._listeners[event]) {\n          var l = this._listeners[event].length,\n              i = 0,\n              _gone = false;\n          if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\n            while (!_gone && i < l && ret !== false) {\n              if (this.eventsToDieOn[event]) {\n                this._listeners[event][i](value, originalEvent);\n              } else {\n                try {\n                  ret = this._listeners[event][i](value, originalEvent);\n                } catch (e) {\n                  log(\"jsPlumb: fire failed for event \" + event + \" : \" + (e.message || e));\n                }\n              }\n              i++;\n              if (this._listeners == null || this._listeners[event] == null) {\n                _gone = true;\n              }\n            }\n          }\n        }\n        this.tick = false;\n        this._drain();\n      } else {\n        this.queue.unshift(arguments);\n      }\n      return ret;\n    }\n  }, {\n    key: \"_drain\",\n    value: function _drain() {\n      var n = this.queue.pop();\n      if (n) {\n        this.fire.apply(this, n);\n      }\n    }\n  }, {\n    key: \"unbind\",\n    value: function unbind(eventOrListener, listener) {\n      if (arguments.length === 0) {\n        this._listeners = {};\n      } else if (arguments.length === 1) {\n        if (typeof eventOrListener === \"string\") {\n          delete this._listeners[eventOrListener];\n        } else if (eventOrListener.__jsPlumb) {\n          var evt;\n          for (var i in eventOrListener.__jsPlumb) {\n            evt = eventOrListener.__jsPlumb[i];\n            remove(this._listeners[evt] || [], eventOrListener);\n          }\n        }\n      } else if (arguments.length === 2) {\n        remove(this._listeners[eventOrListener] || [], listener);\n      }\n      return this;\n    }\n  }, {\n    key: \"getListener\",\n    value: function getListener(forEvent) {\n      return this._listeners[forEvent] || [];\n    }\n  }, {\n    key: \"isSuspendEvents\",\n    value: function isSuspendEvents() {\n      return this.eventsSuspended;\n    }\n  }, {\n    key: \"setSuspendEvents\",\n    value: function setSuspendEvents(val) {\n      this.eventsSuspended = val;\n    }\n  }, {\n    key: \"bind\",\n    value: function bind(event, listener, insertAtStart) {\n      var _this = this;\n      var _one = function _one(evt) {\n        addToDictionary(_this._listeners, evt, listener, insertAtStart);\n        listener.__jsPlumb = listener.__jsPlumb || {};\n        listener.__jsPlumb[uuid()] = evt;\n      };\n      if (typeof event === \"string\") {\n        _one(event);\n      } else if (event.length != null) {\n        for (var i = 0; i < event.length; i++) {\n          _one(event[i]);\n        }\n      }\n      return this;\n    }\n  }, {\n    key: \"silently\",\n    value: function silently(fn) {\n      this.setSuspendEvents(true);\n      try {\n        fn();\n      } catch (e) {\n        log(\"Cannot execute silent function \" + e);\n      }\n      this.setSuspendEvents(false);\n    }\n  }]);\n  return EventGenerator;\n}();\nvar OptimisticEventGenerator = function (_EventGenerator) {\n  _inherits(OptimisticEventGenerator, _EventGenerator);\n  var _super = _createSuper(OptimisticEventGenerator);\n  function OptimisticEventGenerator() {\n    _classCallCheck(this, OptimisticEventGenerator);\n    return _super.apply(this, arguments);\n  }\n  _createClass(OptimisticEventGenerator, [{\n    key: \"shouldFireEvent\",\n    value: function shouldFireEvent(event, value, originalEvent) {\n      return true;\n    }\n  }]);\n  return OptimisticEventGenerator;\n}(EventGenerator);\n\nvar segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1]];\nvar inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1]];\nvar TWO_PI = 2 * Math.PI;\nfunction add(p1, p2) {\n  return {\n    x: p1.x + p2.x,\n    y: p1.y + p2.y\n  };\n}\nfunction subtract(p1, p2) {\n  return {\n    x: p1.x - p2.x,\n    y: p1.y - p2.y\n  };\n}\nfunction gradient(p1, p2) {\n  if (p2.x === p1.x) return p2.y > p1.y ? Infinity : -Infinity;else if (p2.y === p1.y) return p2.x > p1.x ? 0 : -0;else return (p2.y - p1.y) / (p2.x - p1.x);\n}\nfunction normal(p1, p2) {\n  return -1 / gradient(p1, p2);\n}\nfunction lineLength(p1, p2) {\n  return Math.sqrt(Math.pow(p2.y - p1.y, 2) + Math.pow(p2.x - p1.x, 2));\n}\nfunction quadrant(p1, p2) {\n  if (p2.x > p1.x) {\n    return p2.y > p1.y ? 2 : 1;\n  } else if (p2.x == p1.x) {\n    return p2.y > p1.y ? 2 : 1;\n  } else {\n    return p2.y > p1.y ? 3 : 4;\n  }\n}\nfunction theta(p1, p2) {\n  var m = gradient(p1, p2),\n      t = Math.atan(m),\n      s = quadrant(p1, p2);\n  if (s == 4 || s == 3) t += Math.PI;\n  if (t < 0) t += 2 * Math.PI;\n  return t;\n}\nfunction intersects(r1, r2) {\n  var x1 = r1.x,\n      x2 = r1.x + r1.w,\n      y1 = r1.y,\n      y2 = r1.y + r1.h,\n      a1 = r2.x,\n      a2 = r2.x + r2.w,\n      b1 = r2.y,\n      b2 = r2.y + r2.h;\n  return x1 <= a1 && a1 <= x2 && y1 <= b1 && b1 <= y2 || x1 <= a2 && a2 <= x2 && y1 <= b1 && b1 <= y2 || x1 <= a1 && a1 <= x2 && y1 <= b2 && b2 <= y2 || x1 <= a2 && a1 <= x2 && y1 <= b2 && b2 <= y2 || a1 <= x1 && x1 <= a2 && b1 <= y1 && y1 <= b2 || a1 <= x2 && x2 <= a2 && b1 <= y1 && y1 <= b2 || a1 <= x1 && x1 <= a2 && b1 <= y2 && y2 <= b2 || a1 <= x2 && x1 <= a2 && b1 <= y2 && y2 <= b2;\n}\nfunction toABC(line) {\n  var A = line[1].y - line[0].y;\n  var B = line[0].x - line[1].x;\n  return {\n    A: A,\n    B: B,\n    C: fixPrecision(A * line[0].x + B * line[0].y)\n  };\n}\nfunction fixPrecision(n, digits) {\n  digits = digits == null ? 3 : digits;\n  return Math.floor(n * Math.pow(10, digits)) / Math.pow(10, digits);\n}\nfunction lineIntersection(l1, l2) {\n  var abc1 = toABC(l1),\n      abc2 = toABC(l2),\n      det = abc1.A * abc2.B - abc2.A * abc1.B;\n  if (det == 0) {\n    return null;\n  } else {\n    var candidate = {\n      x: Math.round((abc2.B * abc1.C - abc1.B * abc2.C) / det),\n      y: Math.round((abc1.A * abc2.C - abc2.A * abc1.C) / det)\n    },\n        l1xmin = Math.floor(Math.min(l1[0].x, l1[1].x)),\n        l1xmax = Math.round(Math.max(l1[0].x, l1[1].x)),\n        l1ymin = Math.floor(Math.min(l1[0].y, l1[1].y)),\n        l1ymax = Math.round(Math.max(l1[0].y, l1[1].y)),\n        l2xmin = Math.floor(Math.min(l2[0].x, l2[1].x)),\n        l2xmax = Math.round(Math.max(l2[0].x, l2[1].x)),\n        l2ymin = Math.floor(Math.min(l2[0].y, l2[1].y)),\n        l2ymax = Math.round(Math.max(l2[0].y, l2[1].y));\n    if (candidate.x >= l1xmin && candidate.x <= l1xmax && candidate.y >= l1ymin && candidate.y <= l1ymax && candidate.x >= l2xmin && candidate.x <= l2xmax && candidate.y >= l2ymin && candidate.y <= l2ymax) {\n      return candidate;\n    } else {\n      return null;\n    }\n  }\n}\nfunction lineRectangleIntersection(line, r) {\n  var out = [],\n      rectangleLines = [[{\n    x: r.x,\n    y: r.y\n  }, {\n    x: r.x + r.w,\n    y: r.y\n  }], [{\n    x: r.x + r.w,\n    y: r.y\n  }, {\n    x: r.x + r.w,\n    y: r.y + r.h\n  }], [{\n    x: r.x,\n    y: r.y\n  }, {\n    x: r.x,\n    y: r.y + r.h\n  }], [{\n    x: r.x,\n    y: r.y + r.h\n  }, {\n    x: r.x + r.w,\n    y: r.y + r.h\n  }]];\n  forEach(rectangleLines, function (rLine) {\n    var intersection = lineIntersection(line, rLine);\n    if (intersection != null) {\n      out.push(intersection);\n    }\n  });\n  return out;\n}\nfunction encloses(r1, r2, allowSharedEdges) {\n  var x1 = r1.x,\n      x2 = r1.x + r1.w,\n      y1 = r1.y,\n      y2 = r1.y + r1.h,\n      a1 = r2.x,\n      a2 = r2.x + r2.w,\n      b1 = r2.y,\n      b2 = r2.y + r2.h,\n      c = function c(v1, v2, v3, v4) {\n    return allowSharedEdges ? v1 <= v2 && v3 >= v4 : v1 < v2 && v3 > v4;\n  };\n  return c(x1, a1, x2, a2) && c(y1, b1, y2, b2);\n}\nfunction pointOnLine(fromPoint, toPoint, distance) {\n  var m = gradient(fromPoint, toPoint),\n      s = quadrant(fromPoint, toPoint),\n      segmentMultiplier = distance > 0 ? segmentMultipliers[s] : inverseSegmentMultipliers[s],\n      theta = Math.atan(m),\n      y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\n      x = Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\n  return {\n    x: fromPoint.x + x,\n    y: fromPoint.y + y\n  };\n}\nfunction perpendicularLineTo(fromPoint, toPoint, length) {\n  var m = gradient(fromPoint, toPoint),\n      theta2 = Math.atan(-1 / m),\n      y = length / 2 * Math.sin(theta2),\n      x = length / 2 * Math.cos(theta2);\n  return [{\n    x: toPoint.x + x,\n    y: toPoint.y + y\n  }, {\n    x: toPoint.x - x,\n    y: toPoint.y - y\n  }];\n}\nfunction snapToGrid(pos, grid, thresholdX, thresholdY) {\n  thresholdX = thresholdX == null ? grid.thresholdX == null ? grid.w / 2 : grid.thresholdX : thresholdX;\n  thresholdY = thresholdY == null ? grid.thresholdY == null ? grid.h / 2 : grid.thresholdY : thresholdY;\n  var _dx = Math.floor(pos.x / grid.w),\n      _dxl = grid.w * _dx,\n      _dxt = _dxl + grid.w,\n      x = Math.abs(pos.x - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos.x) <= thresholdX ? _dxt : pos.x;\n  var _dy = Math.floor(pos.y / grid.h),\n      _dyl = grid.h * _dy,\n      _dyt = _dyl + grid.h,\n      y = Math.abs(pos.y - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos.y) <= thresholdY ? _dyt : pos.y;\n  return {\n    x: x,\n    y: y\n  };\n}\n\nexport { EventGenerator, OptimisticEventGenerator, TWO_PI, add, addToDictionary, addToList, addWithFunction, arraysEqual, clone, each, encloses, extend, fastTrim, filterList, filterNull, findAllWithFunction, findWithFunction, fixPrecision, forEach, fromArray, functionChain, getAllWithFunction, getFromSetWithFunction, getWithFunction, getsert, gradient, insertSorted, intersects, isAssignableFrom, isBoolean, isDate, isEmpty, isFunction, isNamedFunction, isNumber, isObject, isString, lineIntersection, lineLength, lineRectangleIntersection, log, logEnabled, map, merge, normal, objectsEqual, perpendicularLineTo, pointOnLine, populate, quadrant, remove, removeWithFunction, replace, rotateAnchorOrientation, rotatePoint, setToArray, sgn, snapToGrid, subtract, suggest, theta, uuid, wrap };\n"],"names":["filterList","list","value","missingIsFalse","extend","o1","o2","keys","i","_o1","_o2","isNumber","n","isString","s","isBoolean","isObject","o","isDate","isFunction","clone","a","_b","c","j","merge","b","collations","overwrites","cMap","ar","oMap","functionChain","successValue","failValue","fns","populate","model","values","functionPrefix","doNotExpandFunctions","getValue","fromString","matches","val","_i","_val","_one","d","r","forEach","f","findWithFunction","findAllWithFunction","predicate","getWithFunction","idx","getAllWithFunction","indexes","getFromSetWithFunction","out","t","setToArray","removeWithFunction","fromArray","arr","remove","l","v","addToDictionary","map","key","insertAtStart","suggest","item","insertAtHead","lut","uuid","d0","d1","d2","d3","rotatePoint","point","center","rotation","radial","cr","sr","fastTrim","str","ws","each","obj","fn","_i2","_i3","log","_len","args","_key","msg","e","sgn","x","wrap","wrappedFunction","newFunction","returnOnThisValue","getsert","valueGenerator","isAssignableFrom","object","cls","proto","insertSorted","array","comparator","sortDescending","flip","min","max","index","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_defineProperty","_inherits","subClass","superClass","_setPrototypeOf","_getPrototypeOf","p","_isNativeReflectConstruct","_assertThisInitialized","self","_possibleConstructorReturn","call","_createSuper","Derived","hasNativeReflectConstruct","Super","result","NewTarget","EventGenerator","event","originalEvent","ret","_gone","eventOrListener","listener","evt","forEvent","_this","_EventGenerator","OptimisticEventGenerator","_super","segmentMultipliers","inverseSegmentMultipliers","TWO_PI","gradient","p1","p2","normal","lineLength","quadrant","theta","m","intersects","r1","r2","x1","x2","y1","y2","a1","a2","b1","b2","pointOnLine","fromPoint","toPoint","distance","segmentMultiplier","y","perpendicularLineTo","length","theta2","snapToGrid","pos","grid","thresholdX","thresholdY","_dx","_dxl","_dxt","_dy","_dyl","_dyt"],"mappings":"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"}