{"version":3,"file":"browser-ui-ddea9532.js","sources":["../../../../../node_modules/.pnpm/@jsplumb+browser-ui@5.13.2/node_modules/@jsplumb/browser-ui/js/jsplumb.browser-ui.es.js"],"sourcesContent":["import { NONE, cls, CLASS_CONNECTOR, CLASS_ENDPOINT, att, ATTRIBUTE_GROUP, CLASS_OVERLAY, ATTRIBUTE_TABINDEX, EVENT_ZOOM, SELECTOR_MANAGED_ELEMENT, ATTRIBUTE_NOT_DRAGGABLE, SOURCE, TARGET, INTERCEPT_BEFORE_DRAG, INTERCEPT_BEFORE_START_DETACH, ATTRIBUTE_SCOPE_PREFIX, CLASS_ENDPOINT_FLOATING, REDROP_POLICY_ANY, REDROP_POLICY_STRICT, REDROP_POLICY_ANY_SOURCE, REDROP_POLICY_ANY_TARGET, REDROP_POLICY_ANY_SOURCE_OR_TARGET, CHECK_DROP_ALLOWED, classList, EVENT_MAX_CONNECTIONS, IS_DETACH_ALLOWED, CHECK_CONDITION, INTERCEPT_BEFORE_DETACH, createFloatingAnchor, EndpointRepresentation, ABSOLUTE, Overlay, Connection, Endpoint, BLOCK, ATTRIBUTE_MANAGED, STATIC, FIXED, isLabelOverlay, isArrowOverlay, isDiamondOverlay, isPlainArrowOverlay, isCustomOverlay, JsPlumbInstance, DotEndpoint, RectangleEndpoint, BlankEndpoint } from '@jsplumb/core';\nimport { isString, forEach, fastTrim, log, removeWithFunction, uuid, snapToGrid, extend, findWithFunction, wrap, getWithFunction, getFromSetWithFunction, intersects, merge, each, getAllWithFunction, functionChain, isObject, isAssignableFrom, fromArray, isFunction } from '@jsplumb/util';\nimport { WILDCARD, FALSE as FALSE$1, TRUE as TRUE$1, UNDEFINED } from '@jsplumb/common';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction matchesSelector$1(el, selector, ctx) {\n  ctx = ctx || el.parentNode;\n  var possibles = ctx.querySelectorAll(selector);\n  for (var i = 0; i < possibles.length; i++) {\n    if (possibles[i] === el) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction consume(e, doNotPreventDefault) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.returnValue = false;\n  }\n  if (!doNotPreventDefault && e.preventDefault) {\n    e.preventDefault();\n  }\n}\nfunction findParent(el, selector, container, matchOnElementAlso) {\n  if (matchOnElementAlso && matchesSelector$1(el, selector, container)) {\n    return el;\n  } else {\n    el = el.parentNode;\n  }\n  while (el != null && el !== container) {\n    if (matchesSelector$1(el, selector)) {\n      return el;\n    } else {\n      el = el.parentNode;\n    }\n  }\n}\nfunction getEventSource(e) {\n  return e.srcElement || e.target;\n}\nfunction _setClassName(el, cn, classList) {\n  cn = fastTrim(cn);\n  if (typeof el.className.baseVal !== \"undefined\") {\n    el.className.baseVal = cn;\n  } else {\n    el.className = cn;\n  }\n  try {\n    var cl = el.classList;\n    if (cl != null) {\n      while (cl.length > 0) {\n        cl.remove(cl.item(0));\n      }\n      for (var i = 0; i < classList.length; i++) {\n        if (classList[i]) {\n          cl.add(classList[i]);\n        }\n      }\n    }\n  } catch (e) {\n    log(\"WARN: cannot set class list\", e);\n  }\n}\nfunction _getClassName(el) {\n  return el.className != null ? typeof el.className.baseVal === \"undefined\" ? el.className : el.className.baseVal : \"\";\n}\nfunction _classManip(el, classesToAdd, classesToRemove) {\n  var cta = classesToAdd == null ? [] : Array.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\n  var ctr = classesToRemove == null ? [] : Array.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\n  var className = _getClassName(el),\n      curClasses = className.split(/\\s+/);\n  var _oneSet = function _oneSet(add, classes) {\n    for (var i = 0; i < classes.length; i++) {\n      if (add) {\n        if (curClasses.indexOf(classes[i]) === -1) {\n          curClasses.push(classes[i]);\n        }\n      } else {\n        var idx = curClasses.indexOf(classes[i]);\n        if (idx !== -1) {\n          curClasses.splice(idx, 1);\n        }\n      }\n    }\n  };\n  _oneSet(true, cta);\n  _oneSet(false, ctr);\n  _setClassName(el, curClasses.join(\" \"), curClasses);\n}\nfunction isNodeList(el) {\n  return !isString(el) && !Array.isArray(el) && el.length != null && el.documentElement == null && el.nodeType == null;\n}\nfunction isArrayLike(el) {\n  return !isString(el) && (Array.isArray(el) || isNodeList(el));\n}\nfunction getClass(el) {\n  return _getClassName(el);\n}\nfunction addClass(el, clazz) {\n  var _one = function _one(el, clazz) {\n    if (el != null && clazz != null && clazz.length > 0) {\n      if (el.classList) {\n        var parts = fastTrim(clazz).split(/\\s+/);\n        forEach(parts, function (part) {\n          el.classList.add(part);\n        });\n      } else {\n        _classManip(el, clazz);\n      }\n    }\n  };\n  if (isNodeList(el)) {\n    forEach(el, function (el) {\n      return _one(el, clazz);\n    });\n  } else {\n    _one(el, clazz);\n  }\n}\nfunction hasClass(el, clazz) {\n  if (el.classList) {\n    return el.classList.contains(clazz);\n  } else {\n    return _getClassName(el).indexOf(clazz) !== -1;\n  }\n}\nfunction removeClass(el, clazz) {\n  var _one = function _one(el, clazz) {\n    if (el != null && clazz != null && clazz.length > 0) {\n      if (el.classList) {\n        var parts = fastTrim(clazz).split(/\\s+/);\n        parts.forEach(function (part) {\n          el.classList.remove(part);\n        });\n      } else {\n        _classManip(el, null, clazz);\n      }\n    }\n  };\n  if (isNodeList(el)) {\n    forEach(el, function (el) {\n      return _one(el, clazz);\n    });\n  } else {\n    _one(el, clazz);\n  }\n}\nfunction toggleClass(el, clazz) {\n  var _this = this;\n  var _one = function _one(el, clazz) {\n    if (el != null && clazz != null && clazz.length > 0) {\n      if (el.classList) {\n        el.classList.toggle(clazz);\n      } else {\n        if (_this.hasClass(el, clazz)) {\n          _this.removeClass(el, clazz);\n        } else {\n          _this.addClass(el, clazz);\n        }\n      }\n    }\n  };\n  if (isNodeList(el)) {\n    forEach(el, function (el) {\n      return _one(el, clazz);\n    });\n  } else {\n    _one(el, clazz);\n  }\n}\nfunction createElement(tag, style, clazz, atts) {\n  return createElementNS(null, tag, style, clazz, atts);\n}\nfunction createElementNS(ns, tag, style, clazz, atts) {\n  var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\n  var i;\n  style = style || {};\n  for (i in style) {\n    e.style[i] = style[i];\n  }\n  if (clazz) {\n    e.className = clazz;\n  }\n  atts = atts || {};\n  for (i in atts) {\n    e.setAttribute(i, \"\" + atts[i]);\n  }\n  return e;\n}\nfunction offsetRelativeToRoot(el) {\n  var box = el.getBoundingClientRect(),\n      body = document.body,\n      docElem = document.documentElement,\n  scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n      scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n  clientTop = docElem.clientTop || body.clientTop || 0,\n      clientLeft = docElem.clientLeft || body.clientLeft || 0,\n  top = box.top + scrollTop - clientTop,\n      left = box.left + scrollLeft - clientLeft;\n  return {\n    x: Math.round(left),\n    y: Math.round(top)\n  };\n}\nfunction offsetSize(el) {\n  return {\n    w: el.offsetWidth,\n    h: el.offsetHeight\n  };\n}\nfunction svgWidthHeightSize(el) {\n  try {\n    return {\n      w: parseFloat(el.width.baseVal.value),\n      h: parseFloat(el.height.baseVal.value)\n    };\n  } catch (e) {\n    return {\n      w: 0,\n      h: 0\n    };\n  }\n}\nfunction svgXYPosition(el) {\n  try {\n    return {\n      x: parseFloat(el.x.baseVal.value),\n      y: parseFloat(el.y.baseVal.value)\n    };\n  } catch (e) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n}\nfunction getElementPosition(el, instance) {\n  var pc = instance.getContainer().getBoundingClientRect();\n  var ec = el.getBoundingClientRect();\n  var z = instance.currentZoom;\n  return {\n    x: (ec.left - pc.left) / z,\n    y: (ec.top - pc.top) / z\n  };\n}\nfunction getElementSize(el, instance) {\n  var ec = el.getBoundingClientRect();\n  var z = instance.currentZoom;\n  return {\n    w: ec.width / z,\n    h: ec.height / z\n  };\n}\nvar ElementTypes;\n(function (ElementTypes) {\n  ElementTypes[\"SVG\"] = \"SVG\";\n  ElementTypes[\"HTML\"] = \"HTML\";\n})(ElementTypes || (ElementTypes = {}));\nfunction getElementType(el) {\n  return el instanceof SVGElement ? ElementTypes.SVG : ElementTypes.HTML;\n}\nfunction isSVGElement(el) {\n  return getElementType(el) === ElementTypes.SVG;\n}\n\nvar svgAttributeMap = {\n  \"stroke-linejoin\": \"stroke-linejoin\",\n  \"stroke-dashoffset\": \"stroke-dashoffset\",\n  \"stroke-linecap\": \"stroke-linecap\"\n};\nvar STROKE_DASHARRAY = \"stroke-dasharray\";\nvar DASHSTYLE = \"dashstyle\";\nvar FILL = \"fill\";\nvar STROKE = \"stroke\";\nvar STROKE_WIDTH = \"stroke-width\";\nvar LINE_WIDTH = \"strokeWidth\";\nvar ELEMENT_SVG = \"svg\";\nvar ELEMENT_PATH = \"path\";\nvar ns = {\n  svg: \"http://www.w3.org/2000/svg\"\n};\nfunction _attr(node, attributes) {\n  for (var i in attributes) {\n    node.setAttribute(i, \"\" + attributes[i]);\n  }\n}\nfunction _node(name, attributes) {\n  attributes = attributes || {};\n  attributes.version = \"1.1\";\n  attributes.xmlns = ns.svg;\n  return createElementNS(ns.svg, name, null, null, attributes);\n}\nfunction _pos(d) {\n  return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\n}\nfunction _applyStyles(parent, node, style) {\n  node.setAttribute(FILL, style.fill ? style.fill : NONE);\n  node.setAttribute(STROKE, style.stroke ? style.stroke : NONE);\n  if (style.strokeWidth) {\n    node.setAttribute(STROKE_WIDTH, style.strokeWidth);\n  }\n  if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\n    var sep = style[DASHSTYLE].indexOf(\",\") === -1 ? \" \" : \",\",\n        parts = style[DASHSTYLE].split(sep),\n        styleToUse = \"\";\n    forEach(parts, function (p) {\n      styleToUse += Math.floor(p * style.strokeWidth) + sep;\n    });\n    node.setAttribute(STROKE_DASHARRAY, styleToUse);\n  } else if (style[STROKE_DASHARRAY]) {\n    node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\n  }\n  for (var i in svgAttributeMap) {\n    if (style[i]) {\n      node.setAttribute(svgAttributeMap[i], style[i]);\n    }\n  }\n}\nfunction _appendAtIndex(svg, path, idx) {\n  if (svg.childNodes.length > idx) {\n    svg.insertBefore(path, svg.childNodes[idx]);\n  } else {\n    svg.appendChild(path);\n  }\n}\nvar svg = {\n  attr: _attr,\n  node: _node,\n  ns: ns\n};\n\nfunction compoundEvent(stem, event, subevent) {\n  var a = [stem, event];\n  if (subevent) {\n    a.push(subevent);\n  }\n  return a.join(\":\");\n}\nvar ATTRIBUTE_CONTAINER = \"data-jtk-container\";\nvar ATTRIBUTE_GROUP_CONTENT = \"data-jtk-group-content\";\nvar ATTRIBUTE_JTK_ENABLED = \"data-jtk-enabled\";\nvar ATTRIBUTE_JTK_SCOPE = \"data-jtk-scope\";\nvar ENDPOINT = \"endpoint\";\nvar ELEMENT = \"element\";\nvar CONNECTION = \"connection\";\nvar ELEMENT_DIV = \"div\";\nvar EVENT_CLICK = \"click\";\nvar EVENT_CONTEXTMENU = \"contextmenu\";\nvar EVENT_DBL_CLICK = \"dblclick\";\nvar EVENT_DBL_TAP = \"dbltap\";\nvar EVENT_FOCUS = \"focus\";\nvar EVENT_MOUSEDOWN = \"mousedown\";\nvar EVENT_MOUSEENTER = \"mouseenter\";\nvar EVENT_MOUSEEXIT = \"mouseexit\";\nvar EVENT_MOUSEMOVE = \"mousemove\";\nvar EVENT_MOUSEUP = \"mouseup\";\nvar EVENT_MOUSEOUT = \"mouseout\";\nvar EVENT_MOUSEOVER = \"mouseover\";\nvar EVENT_TAP = \"tap\";\nvar EVENT_TOUCHSTART = \"touchstart\";\nvar EVENT_TOUCHEND = \"touchend\";\nvar EVENT_TOUCHMOVE = \"touchmove\";\nvar EVENT_DRAG_MOVE = \"drag:move\";\nvar EVENT_DRAG_STOP = \"drag:stop\";\nvar EVENT_DRAG_START = \"drag:start\";\nvar EVENT_REVERT = \"revert\";\nvar EVENT_CONNECTION_ABORT = \"connection:abort\";\nvar EVENT_CONNECTION_DRAG = \"connection:drag\";\nvar EVENT_ELEMENT_CLICK = compoundEvent(ELEMENT, EVENT_CLICK);\nvar EVENT_ELEMENT_DBL_CLICK = compoundEvent(ELEMENT, EVENT_DBL_CLICK);\nvar EVENT_ELEMENT_DBL_TAP = compoundEvent(ELEMENT, EVENT_DBL_TAP);\nvar EVENT_ELEMENT_MOUSE_OUT = compoundEvent(ELEMENT, EVENT_MOUSEOUT);\nvar EVENT_ELEMENT_MOUSE_OVER = compoundEvent(ELEMENT, EVENT_MOUSEOVER);\nvar EVENT_ELEMENT_MOUSE_MOVE = compoundEvent(ELEMENT, EVENT_MOUSEMOVE);\nvar EVENT_ELEMENT_MOUSE_UP = compoundEvent(ELEMENT, EVENT_MOUSEUP);\nvar EVENT_ELEMENT_MOUSE_DOWN = compoundEvent(ELEMENT, EVENT_MOUSEDOWN);\nvar EVENT_ELEMENT_CONTEXTMENU = compoundEvent(ELEMENT, EVENT_CONTEXTMENU);\nvar EVENT_ELEMENT_TAP = compoundEvent(ELEMENT, EVENT_TAP);\nvar EVENT_ENDPOINT_CLICK = compoundEvent(ENDPOINT, EVENT_CLICK);\nvar EVENT_ENDPOINT_DBL_CLICK = compoundEvent(ENDPOINT, EVENT_DBL_CLICK);\nvar EVENT_ENDPOINT_DBL_TAP = compoundEvent(ENDPOINT, EVENT_DBL_TAP);\nvar EVENT_ENDPOINT_MOUSEOUT = compoundEvent(ENDPOINT, EVENT_MOUSEOUT);\nvar EVENT_ENDPOINT_MOUSEOVER = compoundEvent(ENDPOINT, EVENT_MOUSEOVER);\nvar EVENT_ENDPOINT_MOUSEUP = compoundEvent(ENDPOINT, EVENT_MOUSEUP);\nvar EVENT_ENDPOINT_MOUSEDOWN = compoundEvent(ENDPOINT, EVENT_MOUSEDOWN);\nvar EVENT_ENDPOINT_TAP = compoundEvent(ENDPOINT, EVENT_TAP);\nvar EVENT_CONNECTION_CLICK = compoundEvent(CONNECTION, EVENT_CLICK);\nvar EVENT_CONNECTION_DBL_CLICK = compoundEvent(CONNECTION, EVENT_DBL_CLICK);\nvar EVENT_CONNECTION_DBL_TAP = compoundEvent(CONNECTION, EVENT_DBL_TAP);\nvar EVENT_CONNECTION_MOUSEOUT = compoundEvent(CONNECTION, EVENT_MOUSEOUT);\nvar EVENT_CONNECTION_MOUSEOVER = compoundEvent(CONNECTION, EVENT_MOUSEOVER);\nvar EVENT_CONNECTION_MOUSEUP = compoundEvent(CONNECTION, EVENT_MOUSEUP);\nvar EVENT_CONNECTION_MOUSEDOWN = compoundEvent(CONNECTION, EVENT_MOUSEDOWN);\nvar EVENT_CONNECTION_CONTEXTMENU = compoundEvent(CONNECTION, EVENT_CONTEXTMENU);\nvar EVENT_CONNECTION_TAP = compoundEvent(CONNECTION, EVENT_TAP);\nvar PROPERTY_POSITION = \"position\";\nvar SELECTOR_CONNECTOR = cls(CLASS_CONNECTOR);\nvar SELECTOR_ENDPOINT = cls(CLASS_ENDPOINT);\nvar SELECTOR_GROUP = att(ATTRIBUTE_GROUP);\nvar SELECTOR_GROUP_CONTAINER = att(ATTRIBUTE_GROUP_CONTENT);\nvar SELECTOR_OVERLAY = cls(CLASS_OVERLAY);\n\nvar _touchMap, _tapProfiles2;\nfunction _touch(target, pageX, pageY, screenX, screenY, clientX, clientY) {\n  return new Touch({\n    target: target,\n    identifier: uuid(),\n    pageX: pageX,\n    pageY: pageY,\n    screenX: screenX,\n    screenY: screenY,\n    clientX: clientX || screenX,\n    clientY: clientY || screenY\n  });\n}\nfunction _touchList() {\n  var list = [];\n  list.push.apply(list, arguments);\n  list.item = function (index) {\n    return this[index];\n  };\n  return list;\n}\nfunction _touchAndList(target, pageX, pageY, screenX, screenY, clientX, clientY) {\n  return _touchList(_touch(target, pageX, pageY, screenX, screenY, clientX, clientY));\n}\nfunction matchesSelector(el, selector, ctx) {\n  ctx = ctx || el.parentNode;\n  var possibles = ctx.querySelectorAll(selector);\n  for (var i = 0; i < possibles.length; i++) {\n    if (possibles[i] === el) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction _t(e) {\n  return e.srcElement || e.target;\n}\nfunction _pi(e, target, obj, doCompute) {\n  if (!doCompute) {\n    return {\n      path: [target],\n      end: 1\n    };\n  } else {\n    var path = e.composedPath ? e.composedPath() : e.path;\n    if (typeof path !== \"undefined\" && path.indexOf) {\n      return {\n        path: path,\n        end: path.indexOf(obj)\n      };\n    } else {\n      var out = {\n        path: [],\n        end: -1\n      },\n          _one = function _one(el) {\n        out.path.push(el);\n        if (el === obj) {\n          out.end = out.path.length - 1;\n        } else if (el.parentNode != null) {\n          _one(el.parentNode);\n        }\n      };\n      _one(target);\n      return out;\n    }\n  }\n}\nfunction _d(l, fn) {\n  var i = 0,\n      j;\n  for (i = 0, j = l.length; i < j; i++) {\n    if (l[i][0] === fn) {\n      break;\n    }\n  }\n  if (i < l.length) {\n    l.splice(i, 1);\n  }\n}\nvar guid = 1;\nvar forceTouchEvents = false;\nvar forceMouseEvents = false;\nfunction isTouchDevice() {\n  return forceTouchEvents || \"ontouchstart\" in document.documentElement || navigator.maxTouchPoints != null && navigator.maxTouchPoints > 0;\n}\nfunction isMouseDevice() {\n  return forceMouseEvents || \"onmousedown\" in document.documentElement;\n}\nvar touchMap = (_touchMap = {}, _defineProperty(_touchMap, EVENT_MOUSEDOWN, EVENT_TOUCHSTART), _defineProperty(_touchMap, EVENT_MOUSEUP, EVENT_TOUCHEND), _defineProperty(_touchMap, EVENT_MOUSEMOVE, EVENT_TOUCHMOVE), _touchMap);\nvar PAGE = \"page\";\nvar SCREEN = \"screen\";\nvar CLIENT = \"client\";\nfunction _genLoc(e, prefix) {\n  if (e == null) return {\n    x: 0,\n    y: 0\n  };\n  var ts = touches(e),\n      t = getTouch(ts, 0);\n  return {\n    x: t[prefix + \"X\"],\n    y: t[prefix + \"Y\"]\n  };\n}\nfunction pageLocation(e) {\n  return _genLoc(e, PAGE);\n}\nfunction screenLocation(e) {\n  return _genLoc(e, SCREEN);\n}\nfunction clientLocation(e) {\n  return _genLoc(e, CLIENT);\n}\nfunction getTouch(touches, idx) {\n  return touches.item ? touches.item(idx) : touches[idx];\n}\nfunction touches(e) {\n  return e.touches && e.touches.length > 0 ? e.touches : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches : e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches : [e];\n}\nfunction touchCount(e) {\n  return touches(e).length;\n}\nfunction getPageLocation(e) {\n  if (e == null) {\n    return {\n      x: 0,\n      y: 0\n    };\n  } else if (e.pageX !== null) {\n    return {\n      x: e.pageX,\n      y: e.pageY\n    };\n  } else {\n    var ts = touches(e),\n        t = getTouch(ts, 0);\n    if (t != null && t.pageX != null) {\n      return {\n        x: t.pageX,\n        y: t.pageY\n      };\n    } else {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n  }\n}\nfunction _bind(obj, type, fn, originalFn, options) {\n  _store(obj, type, fn);\n  originalFn.__tauid = fn.__tauid;\n  if (obj.addEventListener) {\n    obj.addEventListener(type, fn, false, options);\n  } else if (obj.attachEvent) {\n    var key = type + fn.__tauid;\n    obj[\"e\" + key] = fn;\n    obj[key] = function () {\n      obj[\"e\" + key] && obj[\"e\" + key](window.event);\n    };\n    obj.attachEvent(\"on\" + type, obj[key]);\n  }\n}\nfunction _unbind(obj, type, fn) {\n  var _this = this;\n  if (fn == null) return;\n  _each$1(obj, function (_el) {\n    _unstore(_el, type, fn);\n    if (fn.__tauid != null) {\n      if (_el.removeEventListener) {\n        _el.removeEventListener(type, fn, false);\n        if (isTouchDevice() && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\n      } else if (_this.detachEvent) {\n        var key = type + fn.__tauid;\n        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\n        _el[key] = null;\n        _el[\"e\" + key] = null;\n      }\n    }\n    if (fn.__taTouchProxy) {\n      _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\n    }\n  });\n}\nfunction _each$1(obj, fn) {\n  if (obj == null) return;\n  var entries = typeof obj === \"string\" ? document.querySelectorAll(obj) : obj.length != null ? obj : [obj];\n  for (var i = 0; i < entries.length; i++) {\n    fn(entries[i]);\n  }\n}\nfunction _store(obj, event, fn) {\n  var g = guid++;\n  obj.__ta = obj.__ta || {};\n  obj.__ta[event] = obj.__ta[event] || {};\n  obj.__ta[event][g] = fn;\n  fn.__tauid = g;\n  return g;\n}\nfunction _unstore(obj, event, fn) {\n  obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\n  if (fn.__taExtra) {\n    for (var i = 0; i < fn.__taExtra.length; i++) {\n      _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\n    }\n    fn.__taExtra.length = 0;\n  }\n  fn.__taUnstore && fn.__taUnstore();\n}\nvar NOT_SELECTOR_REGEX = /:not\\(([^)]+)\\)/;\nfunction _curryChildFilter(children, obj, fn, evt) {\n  if (children == null) {\n    return fn;\n  } else {\n    var c = children.split(\",\"),\n        pc = [],\n        nc = [];\n    forEach(c, function (sel) {\n      var m = sel.match(NOT_SELECTOR_REGEX);\n      if (m != null) {\n        nc.push(m[1]);\n      } else {\n        pc.push(sel);\n      }\n    });\n    if (nc.length > 0 && pc.length === 0) {\n      pc.push(WILDCARD);\n    }\n    var _fn = function _fn(e) {\n      _fn.__tauid = fn.__tauid;\n      var t = _t(e);\n      var done = false;\n      var target = t;\n      var pathInfo = _pi(e, t, obj, children != null);\n      if (pathInfo.end != -1) {\n        for (var p = 0; !done && p < pathInfo.end; p++) {\n          target = pathInfo.path[p];\n          for (var i = 0; i < nc.length; i++) {\n            if (matchesSelector(target, nc[i], obj)) {\n              return;\n            }\n          }\n          for (var _i = 0; !done && _i < pc.length; _i++) {\n            if (matchesSelector(target, pc[_i], obj)) {\n              fn.apply(target, [e, target]);\n              done = true;\n              break;\n            }\n          }\n        }\n      }\n    };\n    registerExtraFunction(fn, evt, _fn);\n    return _fn;\n  }\n}\nfunction registerExtraFunction(fn, evt, newFn) {\n  fn.__taExtra = fn.__taExtra || [];\n  fn.__taExtra.push([evt, newFn]);\n}\nvar DefaultHandler = function DefaultHandler(obj, evt, fn, children, options) {\n  if (isTouchDevice() && touchMap[evt]) {\n    var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\n    _bind(obj, touchMap[evt], tfn, fn, options);\n  }\n  if (evt === EVENT_FOCUS && obj.getAttribute(ATTRIBUTE_TABINDEX) == null) {\n    obj.setAttribute(ATTRIBUTE_TABINDEX, \"1\");\n  }\n  _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn, options);\n};\nvar _tapProfiles = (_tapProfiles2 = {}, _defineProperty(_tapProfiles2, EVENT_TAP, {\n  touches: 1,\n  taps: 1\n}), _defineProperty(_tapProfiles2, EVENT_DBL_TAP, {\n  touches: 1,\n  taps: 2\n}), _defineProperty(_tapProfiles2, EVENT_CONTEXTMENU, {\n  touches: 2,\n  taps: 1\n}), _tapProfiles2);\nfunction meeHelper(type, evt, obj, target) {\n  for (var i in obj.__tamee[type]) {\n    if (obj.__tamee[type].hasOwnProperty(i)) {\n      obj.__tamee[type][i].apply(target, [evt]);\n    }\n  }\n}\nvar TapHandler = function () {\n  function TapHandler() {\n    _classCallCheck(this, TapHandler);\n  }\n  _createClass(TapHandler, null, [{\n    key: \"generate\",\n    value: function generate(clickThreshold, dblClickThreshold) {\n      return function (obj, evt, fn, children) {\n        if (evt == EVENT_CONTEXTMENU && isMouseDevice()) DefaultHandler(obj, evt, fn, children);else {\n          if (obj.__taTapHandler == null) {\n            var tt = obj.__taTapHandler = {\n              tap: [],\n              dbltap: [],\n              down: false,\n              taps: 0,\n              downSelectors: []\n            };\n            var down = function down(e) {\n              var target = _t(e),\n                  pathInfo = _pi(e, target, obj, children != null),\n                  finished = false;\n              for (var p = 0; p < pathInfo.end; p++) {\n                if (finished) return;\n                target = pathInfo.path[p];\n                for (var i = 0; i < tt.downSelectors.length; i++) {\n                  if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\n                    tt.down = true;\n                    setTimeout(clearSingle, clickThreshold);\n                    setTimeout(clearDouble, dblClickThreshold);\n                    finished = true;\n                    break;\n                  }\n                }\n              }\n            },\n                up = function up(e) {\n              if (tt.down) {\n                var target = _t(e),\n                    currentTarget,\n                    pathInfo;\n                tt.taps++;\n                var tc = touchCount(e);\n                for (var eventId in _tapProfiles) {\n                  if (_tapProfiles.hasOwnProperty(eventId)) {\n                    var p = _tapProfiles[eventId];\n                    if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\n                      for (var i = 0; i < tt[eventId].length; i++) {\n                        pathInfo = _pi(e, target, obj, tt[eventId][i][1] != null);\n                        for (var pLoop = 0; pLoop < pathInfo.end; pLoop++) {\n                          currentTarget = pathInfo.path[pLoop];\n                          if (tt[eventId][i][1] == null || matchesSelector(currentTarget, tt[eventId][i][1], obj)) {\n                            tt[eventId][i][0].apply(currentTarget, [e, currentTarget]);\n                            break;\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            },\n                clearSingle = function clearSingle() {\n              tt.down = false;\n            },\n                clearDouble = function clearDouble() {\n              tt.taps = 0;\n            };\n            obj.__taTapHandler.downHandler = down;\n            obj.__taTapHandler.upHandler = up;\n            DefaultHandler(obj, EVENT_MOUSEDOWN, down);\n            DefaultHandler(obj, EVENT_MOUSEUP, up);\n          }\n          obj.__taTapHandler.downSelectors.push(children);\n          obj.__taTapHandler[evt].push([fn, children]);\n          fn.__taUnstore = function () {\n            if (obj.__taTapHandler != null) {\n              removeWithFunction(obj.__taTapHandler.downSelectors, function (ds) {\n                return ds === children;\n              });\n              _d(obj.__taTapHandler[evt], fn);\n              if (obj.__taTapHandler.downSelectors.length === 0) {\n                _unbind(obj, EVENT_MOUSEDOWN, obj.__taTapHandler.downHandler);\n                _unbind(obj, EVENT_MOUSEUP, obj.__taTapHandler.upHandler);\n                delete obj.__taTapHandler;\n              }\n            }\n          };\n        }\n      };\n    }\n  }]);\n  return TapHandler;\n}();\nvar MouseEnterExitHandler = function () {\n  function MouseEnterExitHandler() {\n    _classCallCheck(this, MouseEnterExitHandler);\n  }\n  _createClass(MouseEnterExitHandler, null, [{\n    key: \"generate\",\n    value: function generate() {\n      var activeElements = [];\n      return function (obj, evt, fn, children) {\n        if (!obj.__tamee) {\n          obj.__tamee = {\n            over: false,\n            mouseenter: [],\n            mouseexit: []\n          };\n          var over = function over(e) {\n            var t = _t(e);\n            if (children == null && t == obj && !obj.__tamee.over || matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over)) {\n              meeHelper(EVENT_MOUSEENTER, e, obj, t);\n              t.__tamee = t.__tamee || {};\n              t.__tamee.over = true;\n              activeElements.push(t);\n            }\n          },\n              out = function out(e) {\n            var t = _t(e);\n            for (var i = 0; i < activeElements.length; i++) {\n              if (t == activeElements[i] && !matchesSelector(e.relatedTarget || e.toElement, \"*\", t)) {\n                t.__tamee.over = false;\n                activeElements.splice(i, 1);\n                meeHelper(EVENT_MOUSEEXIT, e, obj, t);\n              }\n            }\n          };\n          _bind(obj, EVENT_MOUSEOVER, _curryChildFilter(children, obj, over, EVENT_MOUSEOVER), over);\n          _bind(obj, EVENT_MOUSEOUT, _curryChildFilter(children, obj, out, EVENT_MOUSEOUT), out);\n        }\n        fn.__taUnstore = function () {\n          delete obj.__tamee[evt][fn.__tauid];\n        };\n        _store(obj, evt, fn);\n        obj.__tamee[evt][fn.__tauid] = fn;\n      };\n    }\n  }]);\n  return MouseEnterExitHandler;\n}();\nvar EventManager = function () {\n  function EventManager(params) {\n    _classCallCheck(this, EventManager);\n    _defineProperty(this, \"clickThreshold\", void 0);\n    _defineProperty(this, \"dblClickThreshold\", void 0);\n    _defineProperty(this, \"tapHandler\", void 0);\n    _defineProperty(this, \"mouseEnterExitHandler\", void 0);\n    params = params || {};\n    this.clickThreshold = params.clickThreshold || 250;\n    this.dblClickThreshold = params.dblClickThreshold || 450;\n    this.mouseEnterExitHandler = MouseEnterExitHandler.generate();\n    this.tapHandler = TapHandler.generate(this.clickThreshold, this.dblClickThreshold);\n  }\n  _createClass(EventManager, [{\n    key: \"_doBind\",\n    value: function _doBind(el, evt, fn, children, options) {\n      if (fn == null) return;\n      var jel = el;\n      if (evt === EVENT_TAP || evt === EVENT_DBL_TAP || evt === EVENT_CONTEXTMENU) {\n        this.tapHandler(jel, evt, fn, children, options);\n      } else if (evt === EVENT_MOUSEENTER || evt == EVENT_MOUSEEXIT) this.mouseEnterExitHandler(jel, evt, fn, children, options);else {\n        DefaultHandler(jel, evt, fn, children, options);\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(el, event, children, fn, options) {\n      var _c = fn == null ? null : children,\n          _f = fn == null ? children : fn;\n      this._doBind(el, event, _f, _c, options);\n      return this;\n    }\n  }, {\n    key: \"off\",\n    value: function off(el, event, fn) {\n      _unbind(el, event, fn);\n      return this;\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(el, event, originalEvent, payload, detail) {\n      var originalIsMouse = isMouseDevice() && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\n      var eventToBind = isTouchDevice() && !isMouseDevice() && touchMap[event] ? touchMap[event] : event,\n          bindingAMouseEvent = !(isTouchDevice() && !isMouseDevice() && touchMap[event]);\n      var pl = pageLocation(originalEvent),\n          sl = screenLocation(originalEvent),\n          cl = clientLocation(originalEvent);\n      _each$1(el, function (_el) {\n        var evt;\n        originalEvent = originalEvent || {\n          screenX: sl.x,\n          screenY: sl.y,\n          clientX: cl.x,\n          clientY: cl.y\n        };\n        var _decorate = function _decorate(_evt) {\n          if (payload) {\n            _evt.payload = payload;\n          }\n        };\n        var eventGenerators = {\n          \"TouchEvent\": function TouchEvent(evt) {\n            var touchList = _touchAndList(_el, pl.x, pl.y, sl.x, sl.y, cl.x, cl.y),\n                init = evt.initTouchEvent || evt.initEvent;\n            init(eventToBind, true, true, window, null, sl.x, sl.y, cl.x, cl.y, false, false, false, false, touchList, touchList, touchList, 1, 0);\n          },\n          \"MouseEvents\": function MouseEvents(evt) {\n            evt.initMouseEvent(eventToBind, true, true, window, detail == null ? 1 : detail, sl.x, sl.y, cl.x, cl.y, false, false, false, false, 1, _el);\n          }\n        };\n        var ite = !bindingAMouseEvent && !originalIsMouse && isTouchDevice() && touchMap[event],\n            evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\n        evt = document.createEvent(evtName);\n        eventGenerators[evtName](evt);\n        _decorate(evt);\n        _el.dispatchEvent(evt);\n      });\n      return this;\n    }\n  }]);\n  return EventManager;\n}();\nfunction setForceTouchEvents(value) {\n  forceTouchEvents = value;\n}\nfunction setForceMouseEvents(value) {\n  forceMouseEvents = value;\n}\n\nfunction findDelegateElement(parentElement, childElement, selector) {\n  if (matchesSelector$1(childElement, selector, parentElement)) {\n    return childElement;\n  } else {\n    var currentParent = childElement.parentNode;\n    while (currentParent != null && currentParent !== parentElement) {\n      if (matchesSelector$1(currentParent, selector, parentElement)) {\n        return currentParent;\n      } else {\n        currentParent = currentParent.parentNode;\n      }\n    }\n  }\n}\nfunction _assignId(obj) {\n  if (typeof obj === \"function\") {\n    obj._katavorioId = uuid();\n    return obj._katavorioId;\n  } else {\n    return obj;\n  }\n}\nfunction isInsideParent(instance, _el, pos) {\n  var p = _el.parentNode,\n      s = instance.getSize(p),\n      ss = instance.getSize(_el),\n      leftEdge = pos.x,\n      rightEdge = leftEdge + ss.w,\n      topEdge = pos.y,\n      bottomEdge = topEdge + ss.h;\n  return rightEdge > 0 && leftEdge < s.w && bottomEdge > 0 && topEdge < s.h;\n}\nfunction findMatchingSelector(availableSelectors, parentElement, childElement) {\n  var el = null;\n  var draggableId = parentElement.getAttribute(\"katavorio-draggable\"),\n      prefix = draggableId != null ? \"[katavorio-draggable='\" + draggableId + \"'] \" : \"\";\n  for (var i = 0; i < availableSelectors.length; i++) {\n    el = findDelegateElement(parentElement, childElement, prefix + availableSelectors[i].selector);\n    if (el != null) {\n      if (availableSelectors[i].filter) {\n        var matches = matchesSelector$1(childElement, availableSelectors[i].filter, el),\n            exclude = availableSelectors[i].filterExclude === true;\n        if (exclude && !matches || matches) {\n          return null;\n        }\n      }\n      return [availableSelectors[i], el];\n    }\n  }\n  return null;\n}\nvar EVENT_START = \"start\";\nvar EVENT_BEFORE_START = \"beforeStart\";\nvar EVENT_DRAG = \"drag\";\nvar EVENT_DROP = \"drop\";\nvar EVENT_OVER = \"over\";\nvar EVENT_OUT = \"out\";\nvar EVENT_STOP = \"stop\";\nvar ATTRIBUTE_DRAGGABLE = \"katavorio-draggable\";\nvar CLASS_DRAGGABLE$1 = ATTRIBUTE_DRAGGABLE;\nvar DEFAULT_GRID_X = 10;\nvar DEFAULT_GRID_Y = 10;\nvar TRUE = function TRUE() {\n  return true;\n};\nvar FALSE = function FALSE() {\n  return false;\n};\nvar _classes = {\n  delegatedDraggable: \"katavorio-delegated-draggable\",\n  draggable: CLASS_DRAGGABLE$1,\n  drag: \"katavorio-drag\",\n  selected: \"katavorio-drag-selected\",\n  noSelect: \"katavorio-drag-no-select\",\n  ghostProxy: \"katavorio-ghost-proxy\",\n  clonedDrag: \"katavorio-clone-drag\"\n};\nvar PositioningStrategies;\n(function (PositioningStrategies) {\n  PositioningStrategies[\"absolutePosition\"] = \"absolutePosition\";\n  PositioningStrategies[\"transform\"] = \"transform\";\n  PositioningStrategies[\"xyAttributes\"] = \"xyAttributes\";\n})(PositioningStrategies || (PositioningStrategies = {}));\nvar positionerSetters = new Map();\npositionerSetters.set(PositioningStrategies.absolutePosition, function (el, p) {\n  el.style.left = \"\".concat(p.x, \"px\");\n  el.style.top = \"\".concat(p.y, \"px\");\n});\npositionerSetters.set(PositioningStrategies.xyAttributes, function (el, p) {\n  el.setAttribute(\"x\", \"\".concat(p.x));\n  el.setAttribute(\"y\", \"\".concat(p.y));\n});\nvar positionerGetters = new Map();\npositionerGetters.set(PositioningStrategies.absolutePosition, function (el) {\n  return {\n    x: el.offsetLeft,\n    y: el.offsetTop\n  };\n});\npositionerGetters.set(PositioningStrategies.xyAttributes, function (el) {\n  return {\n    x: parseFloat(el.getAttribute(\"x\")),\n    y: parseFloat(el.getAttribute(\"y\"))\n  };\n});\nvar sizeSetters = new Map();\nsizeSetters.set(PositioningStrategies.absolutePosition, function (el, s) {\n  el.style.width = \"\".concat(s.w, \"px\");\n  el.style.height = \"\".concat(s.h, \"px\");\n});\nsizeSetters.set(PositioningStrategies.xyAttributes, function (el, s) {\n  el.setAttribute(\"width\", \"\".concat(s.w));\n  el.setAttribute(\"height\", \"\".concat(s.h));\n});\nvar sizeGetters = new Map();\nsizeGetters.set(PositioningStrategies.absolutePosition, function (el) {\n  return {\n    w: el.offsetWidth,\n    h: el.offsetHeight\n  };\n});\nsizeGetters.set(PositioningStrategies.xyAttributes, function (el) {\n  return {\n    w: parseFloat(el.getAttribute(\"width\")),\n    h: parseFloat(el.getAttribute(\"height\"))\n  };\n});\nvar _events = [EVENT_STOP, EVENT_START, EVENT_DRAG, EVENT_DROP, EVENT_OVER, EVENT_OUT, EVENT_BEFORE_START];\nvar _devNull = function _devNull() {};\nvar _each = function _each(obj, fn) {\n  if (obj == null) return;\n  obj = !isString(obj) && obj.tagName == null && obj.length != null ? obj : [obj];\n  for (var i = 0; i < obj.length; i++) {\n    fn.apply(obj[i], [obj[i]]);\n  }\n};\nvar _inputFilter = function _inputFilter(e, el, collicat) {\n  var t = e.srcElement || e.target;\n  return !matchesSelector$1(t, collicat.getInputFilterSelector(), el);\n};\nvar Base = function () {\n  function Base(el, manager) {\n    _classCallCheck(this, Base);\n    this.el = el;\n    this.manager = manager;\n    _defineProperty(this, \"_class\", void 0);\n    _defineProperty(this, \"uuid\", uuid());\n    _defineProperty(this, \"enabled\", true);\n    _defineProperty(this, \"scopes\", []);\n    _defineProperty(this, \"eventManager\", void 0);\n    this.eventManager = manager.eventManager;\n  }\n  _createClass(Base, [{\n    key: \"setEnabled\",\n    value: function setEnabled(e) {\n      this.enabled = e;\n    }\n  }, {\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      return this.enabled;\n    }\n  }, {\n    key: \"toggleEnabled\",\n    value: function toggleEnabled() {\n      this.enabled = !this.enabled;\n    }\n  }, {\n    key: \"addScope\",\n    value: function addScope(scopes) {\n      var m = {};\n      _each(this.scopes, function (s) {\n        m[s] = true;\n      });\n      _each(scopes ? scopes.split(/\\s+/) : [], function (s) {\n        m[s] = true;\n      });\n      this.scopes.length = 0;\n      for (var i in m) {\n        this.scopes.push(i);\n      }\n    }\n  }, {\n    key: \"removeScope\",\n    value: function removeScope(scopes) {\n      var m = {};\n      _each(this.scopes, function (s) {\n        m[s] = true;\n      });\n      _each(scopes ? scopes.split(/\\s+/) : [], function (s) {\n        delete m[s];\n      });\n      this.scopes.length = 0;\n      for (var i in m) {\n        this.scopes.push(i);\n      }\n    }\n  }, {\n    key: \"toggleScope\",\n    value: function toggleScope(scopes) {\n      var m = {};\n      _each(this.scopes, function (s) {\n        m[s] = true;\n      });\n      _each(scopes ? scopes.split(/\\s+/) : [], function (s) {\n        if (m[s]) delete m[s];else m[s] = true;\n      });\n      this.scopes.length = 0;\n      for (var i in m) {\n        this.scopes.push(i);\n      }\n    }\n  }]);\n  return Base;\n}();\nfunction getConstrainingRectangle(el) {\n  return {\n    w: el.parentNode.offsetWidth + el.parentNode.scrollLeft,\n    h: el.parentNode.offsetHeight + el.parentNode.scrollTop\n  };\n}\nvar ContainmentType;\n(function (ContainmentType) {\n  ContainmentType[\"notNegative\"] = \"notNegative\";\n  ContainmentType[\"parent\"] = \"parent\";\n  ContainmentType[\"parentEnclosed\"] = \"parentEnclosed\";\n})(ContainmentType || (ContainmentType = {}));\nvar Drag = function (_Base) {\n  _inherits(Drag, _Base);\n  var _super = _createSuper(Drag);\n  function Drag(el, params, manager) {\n    var _this;\n    _classCallCheck(this, Drag);\n    _this = _super.call(this, el, manager);\n    _defineProperty(_assertThisInitialized(_this), \"_class\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"rightButtonCanDrag\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"consumeStartEvent\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"clone\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"scroll\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"trackScroll\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_downAt\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_posAtDown\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_pagePosAtDown\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_pageDelta\", {\n      x: 0,\n      y: 0\n    });\n    _defineProperty(_assertThisInitialized(_this), \"_moving\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_lastPosition\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_lastScrollValues\", {\n      x: 0,\n      y: 0\n    });\n    _defineProperty(_assertThisInitialized(_this), \"_initialScroll\", {\n      x: 0,\n      y: 0\n    });\n    _defineProperty(_assertThisInitialized(_this), \"_size\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_currentParentPosition\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostParentPosition\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_dragEl\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_multipleDrop\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostProxyOffsets\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostDx\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostDy\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_isConstrained\", false);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostProxyParent\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_useGhostProxy\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ghostProxyFunction\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_activeSelectorParams\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_availableSelectors\", []);\n    _defineProperty(_assertThisInitialized(_this), \"_canDrag\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_consumeFilteredEvents\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_parent\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_ignoreZoom\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_filters\", {});\n    _defineProperty(_assertThisInitialized(_this), \"_constrainRect\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementToDrag\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"downListener\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"moveListener\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"upListener\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"scrollTracker\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"listeners\", {\n      \"start\": [],\n      \"drag\": [],\n      \"stop\": [],\n      \"over\": [],\n      \"out\": [],\n      \"beforeStart\": [],\n      \"revert\": []\n    });\n    _this._class = _this.manager.css.draggable;\n    addClass(_this.el, _this._class);\n    _this.downListener = _this._downListener.bind(_assertThisInitialized(_this));\n    _this.upListener = _this._upListener.bind(_assertThisInitialized(_this));\n    _this.moveListener = _this._moveListener.bind(_assertThisInitialized(_this));\n    _this.rightButtonCanDrag = params.rightButtonCanDrag === true;\n    _this.consumeStartEvent = params.consumeStartEvent !== false;\n    _this._dragEl = _this.el;\n    _this.clone = params.clone === true;\n    _this.scroll = params.scroll === true;\n    _this.trackScroll = params.trackScroll !== false;\n    _this._multipleDrop = params.multipleDrop !== false;\n    _this._canDrag = params.canDrag || TRUE;\n    _this._consumeFilteredEvents = params.consumeFilteredEvents;\n    _this._parent = params.parent;\n    _this._ignoreZoom = params.ignoreZoom === true;\n    _this._ghostProxyParent = params.ghostProxyParent;\n    if (_this.trackScroll) {\n      _this.scrollTracker = _this._trackScroll.bind(_assertThisInitialized(_this));\n      document.addEventListener(\"scroll\", _this.scrollTracker);\n    }\n    if (params.ghostProxy === true) {\n      _this._useGhostProxy = TRUE;\n    } else {\n      if (params.ghostProxy && typeof params.ghostProxy === \"function\") {\n        _this._useGhostProxy = params.ghostProxy;\n      } else {\n        _this._useGhostProxy = function (container, dragEl) {\n          if (_this._activeSelectorParams && _this._activeSelectorParams.useGhostProxy) {\n            return _this._activeSelectorParams.useGhostProxy(container, dragEl);\n          } else {\n            return false;\n          }\n        };\n      }\n    }\n    if (params.makeGhostProxy) {\n      _this._ghostProxyFunction = params.makeGhostProxy;\n    } else {\n      _this._ghostProxyFunction = function (el) {\n        if (_this._activeSelectorParams && _this._activeSelectorParams.makeGhostProxy) {\n          return _this._activeSelectorParams.makeGhostProxy(el);\n        } else {\n          return el.cloneNode(true);\n        }\n      };\n    }\n    if (params.selector) {\n      var draggableId = _this.el.getAttribute(ATTRIBUTE_DRAGGABLE);\n      if (draggableId == null) {\n        draggableId = \"\" + new Date().getTime();\n        _this.el.setAttribute(\"katavorio-draggable\", draggableId);\n      }\n      _this._availableSelectors.push(params);\n    }\n    _this.eventManager.on(_this.el, EVENT_MOUSEDOWN, _this.downListener);\n    return _this;\n  }\n  _createClass(Drag, [{\n    key: \"_trackScroll\",\n    value: function _trackScroll(e) {\n      if (this._moving) {\n        var currentScrollValues = {\n          x: document.documentElement.scrollLeft,\n          y: document.documentElement.scrollTop\n        },\n            dsx = currentScrollValues.x - this._lastScrollValues.x,\n            dsy = currentScrollValues.y - this._lastScrollValues.y,\n            _pos = {\n          x: dsx + this._lastPosition.x,\n          y: dsy + this._lastPosition.y\n        },\n        dx = _pos.x - this._downAt.x,\n            dy = _pos.y - this._downAt.y,\n            _z = this._ignoreZoom ? 1 : this.manager.getZoom();\n        if (this._dragEl && this._dragEl.parentNode) {\n          dx += this._dragEl.parentNode.scrollLeft - this._initialScroll.x;\n          dy += this._dragEl.parentNode.scrollTop - this._initialScroll.y;\n        }\n        dx /= _z;\n        dy /= _z;\n        this.moveBy(dx, dy, e);\n        this._lastPosition = _pos;\n        this._lastScrollValues = currentScrollValues;\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(evt, fn) {\n      if (this.listeners[evt]) {\n        this.listeners[evt].push(fn);\n      }\n    }\n  }, {\n    key: \"off\",\n    value: function off(evt, fn) {\n      if (this.listeners[evt]) {\n        var l = [];\n        for (var i = 0; i < this.listeners[evt].length; i++) {\n          if (this.listeners[evt][i] !== fn) {\n            l.push(this.listeners[evt][i]);\n          }\n        }\n        this.listeners[evt] = l;\n      }\n    }\n  }, {\n    key: \"_upListener\",\n    value: function _upListener(e) {\n      if (this._downAt) {\n        this._downAt = null;\n        this.eventManager.off(document, EVENT_MOUSEMOVE, this.moveListener);\n        this.eventManager.off(document, EVENT_MOUSEUP, this.upListener);\n        removeClass(document.body, _classes.noSelect);\n        this.unmark(e);\n        this.stop(e);\n        this._moving = false;\n        if (this.clone) {\n          this._dragEl && this._dragEl.parentNode && this._dragEl.parentNode.removeChild(this._dragEl);\n          this._dragEl = null;\n        } else {\n          if (this._activeSelectorParams && this._activeSelectorParams.revertFunction) {\n            if (this._activeSelectorParams.revertFunction(this._dragEl, this.manager.getPosition(this._dragEl)) === true) {\n              this.manager.setPosition(this._dragEl, this._posAtDown);\n              this._dispatch(EVENT_REVERT, this._dragEl);\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"_downListener\",\n    value: function _downListener(e) {\n      if (e.defaultPrevented) {\n        return;\n      }\n      var isNotRightClick = this.rightButtonCanDrag || e.which !== 3 && e.button !== 2;\n      if (isNotRightClick && this.isEnabled() && this._canDrag()) {\n        var _f = this._testFilter(e) && _inputFilter(e, this.el, this.manager);\n        if (_f) {\n          this._activeSelectorParams = null;\n          this._elementToDrag = null;\n          if (this._availableSelectors.length === 0) {\n            console.log(\"JSPLUMB: no available drag selectors\");\n          }\n          var eventTarget = e.target || e.srcElement;\n          var match = findMatchingSelector(this._availableSelectors, this.el, eventTarget);\n          if (match != null) {\n            this._activeSelectorParams = match[0];\n            this._elementToDrag = match[1];\n          }\n          if (this._activeSelectorParams == null || this._elementToDrag == null) {\n            return;\n          }\n          var initial = this._activeSelectorParams.dragInit ? this._activeSelectorParams.dragInit(this._elementToDrag, e) : null;\n          if (initial != null) {\n            this._elementToDrag = initial;\n          }\n          if (this.clone) {\n            this._dragEl = this._elementToDrag.cloneNode(true);\n            addClass(this._dragEl, _classes.clonedDrag);\n            this._dragEl.setAttribute(\"id\", null);\n            this._dragEl.style.position = \"absolute\";\n            if (this._parent != null) {\n              var _p2 = this.manager.getPosition(this.el);\n              this._dragEl.style.left = _p2.x + \"px\";\n              this._dragEl.style.top = _p2.y + \"px\";\n              this._parent.appendChild(this._dragEl);\n            } else {\n              var b = offsetRelativeToRoot(this._elementToDrag);\n              this._dragEl.style.left = b.x + \"px\";\n              this._dragEl.style.top = b.y + \"px\";\n              document.body.appendChild(this._dragEl);\n            }\n          } else {\n            this._dragEl = this._elementToDrag;\n          }\n          if (this.consumeStartEvent) {\n            consume(e);\n          }\n          this._downAt = pageLocation(e);\n          if (this._dragEl && this._dragEl.parentNode) {\n            this._initialScroll = {\n              x: this._dragEl.parentNode.scrollLeft,\n              y: this._dragEl.parentNode.scrollTop\n            };\n          }\n          this._posAtDown = this.manager.getPosition(this._dragEl);\n          this._pagePosAtDown = offsetRelativeToRoot(this._dragEl);\n          this._pageDelta = {\n            x: this._pagePosAtDown.x - this._posAtDown.x,\n            y: this._pagePosAtDown.y - this._posAtDown.y\n          };\n          this._size = this.manager.getSize(this._dragEl);\n          this.eventManager.on(document, EVENT_MOUSEMOVE, this.moveListener);\n          this.eventManager.on(document, EVENT_MOUSEUP, this.upListener);\n          addClass(document.body, _classes.noSelect);\n          this._dispatch(EVENT_BEFORE_START, {\n            el: this.el,\n            pos: this._posAtDown,\n            e: e,\n            drag: this,\n            size: this._size\n          });\n        } else if (this._consumeFilteredEvents) {\n          consume(e);\n        }\n      }\n    }\n  }, {\n    key: \"_moveListener\",\n    value: function _moveListener(e) {\n      if (this._downAt) {\n        if (!this._moving) {\n          var dispatchResult = this._dispatch(EVENT_START, {\n            el: this.el,\n            pos: this._posAtDown,\n            e: e,\n            drag: this,\n            size: this._size\n          });\n          if (dispatchResult !== false) {\n            if (!this._downAt) {\n              return;\n            }\n            this.mark(dispatchResult);\n            this._moving = true;\n          } else {\n            this.abort();\n          }\n        }\n        if (this._downAt) {\n          var _pos2 = pageLocation(e),\n              dx = _pos2.x - this._downAt.x,\n              dy = _pos2.y - this._downAt.y,\n              _z2 = this._ignoreZoom ? 1 : this.manager.getZoom();\n          this._lastPosition = {\n            x: _pos2.x,\n            y: _pos2.y\n          };\n          this._lastScrollValues = {\n            x: document.documentElement.scrollLeft,\n            y: document.documentElement.scrollTop\n          };\n          if (this._dragEl && this._dragEl.parentNode) {\n            dx += this._dragEl.parentNode.scrollLeft - this._initialScroll.x;\n            dy += this._dragEl.parentNode.scrollTop - this._initialScroll.y;\n          }\n          dx /= _z2;\n          dy /= _z2;\n          this.moveBy(dx, dy, e);\n        }\n      }\n    }\n  }, {\n    key: \"getDragDelta\",\n    value: function getDragDelta() {\n      if (this._posAtDown != null && this._downAt != null) {\n        return {\n          x: this._downAt.x - this._posAtDown.x,\n          y: this._downAt.y - this._posAtDown.y\n        };\n      } else {\n        return {\n          x: 0,\n          y: 0\n        };\n      }\n    }\n  }, {\n    key: \"mark\",\n    value: function mark(payload) {\n      this._posAtDown = this.manager.getPosition(this._dragEl);\n      this._pagePosAtDown = offsetRelativeToRoot(this._dragEl);\n      this._pageDelta = {\n        x: this._pagePosAtDown.x - this._posAtDown.x,\n        y: this._pagePosAtDown.y - this._posAtDown.y\n      };\n      this._size = this.manager.getSize(this._dragEl);\n      addClass(this._dragEl, this.manager.css.drag);\n      this._constrainRect = getConstrainingRectangle(this._dragEl);\n      this._ghostDx = 0;\n      this._ghostDy = 0;\n    }\n  }, {\n    key: \"unmark\",\n    value: function unmark(e) {\n      if (this._isConstrained && this._useGhostProxy(this._elementToDrag, this._dragEl)) {\n        this._ghostProxyOffsets = {\n          x: this._dragEl.offsetLeft - this._ghostDx,\n          y: this._dragEl.offsetTop - this._ghostDy\n        };\n        this._dragEl.parentNode.removeChild(this._dragEl);\n        this._dragEl = this._elementToDrag;\n      } else {\n        this._ghostProxyOffsets = null;\n      }\n      removeClass(this._dragEl, this.manager.css.drag);\n      this._isConstrained = false;\n    }\n  }, {\n    key: \"moveBy\",\n    value: function moveBy(dx, dy, e) {\n      var desiredLoc = this.toGrid({\n        x: this._posAtDown.x + dx,\n        y: this._posAtDown.y + dy\n      }),\n          cPos = this._doConstrain(desiredLoc, this._dragEl, this._constrainRect, this._size, e);\n      if (cPos != null) {\n        if (this._useGhostProxy(this.el, this._dragEl)) {\n          if (desiredLoc.x !== cPos.x || desiredLoc.y !== cPos.y) {\n            if (!this._isConstrained) {\n              var gp = this._ghostProxyFunction(this._elementToDrag);\n              addClass(gp, _classes.ghostProxy);\n              if (this._ghostProxyParent) {\n                this._ghostProxyParent.appendChild(gp);\n                this._currentParentPosition = offsetRelativeToRoot(this._elementToDrag.parentNode);\n                this._ghostParentPosition = offsetRelativeToRoot(this._ghostProxyParent);\n                this._ghostDx = this._currentParentPosition.x - this._ghostParentPosition.x;\n                this._ghostDy = this._currentParentPosition.y - this._ghostParentPosition.y;\n              } else {\n                this._elementToDrag.parentNode.appendChild(gp);\n              }\n              this._dragEl = gp;\n              this._isConstrained = true;\n            }\n            cPos = desiredLoc;\n          } else {\n            if (this._isConstrained) {\n              this._dragEl.parentNode.removeChild(this._dragEl);\n              this._dragEl = this._elementToDrag;\n              this._isConstrained = false;\n              this._currentParentPosition = null;\n              this._ghostParentPosition = null;\n              this._ghostDx = 0;\n              this._ghostDy = 0;\n            }\n          }\n        }\n        this.manager.setPosition(this._dragEl, {\n          x: cPos.x + this._ghostDx,\n          y: cPos.y + this._ghostDy\n        });\n        this._dispatch(EVENT_DRAG, {\n          el: this.el,\n          pos: cPos,\n          e: e,\n          drag: this,\n          size: this._size,\n          originalPos: this._posAtDown\n        });\n      }\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      if (this._downAt != null) {\n        this._upListener();\n      }\n    }\n  }, {\n    key: \"getDragElement\",\n    value: function getDragElement(retrieveOriginalElement) {\n      return retrieveOriginalElement ? this._elementToDrag || this.el : this._dragEl || this.el;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(e, force) {\n      if (force || this._moving) {\n        var positions = [],\n            dPos = this.manager.getPosition(this._dragEl);\n        positions.push([this._dragEl, dPos, this, this._size]);\n        this._dispatch(EVENT_STOP, {\n          el: this._dragEl,\n          pos: this._ghostProxyOffsets || dPos,\n          finalPos: dPos,\n          e: e,\n          drag: this,\n          selection: positions,\n          size: this._size,\n          originalPos: {\n            x: this._posAtDown.x,\n            y: this._posAtDown.y\n          }\n        });\n      } else if (!this._moving) {\n        this._activeSelectorParams.dragAbort ? this._activeSelectorParams.dragAbort(this._elementToDrag) : null;\n      }\n    }\n  }, {\n    key: \"_dispatch\",\n    value: function _dispatch(evt, value) {\n      var result = null;\n      if (this._activeSelectorParams && this._activeSelectorParams[evt]) {\n        result = this._activeSelectorParams[evt](value);\n      } else if (this.listeners[evt]) {\n        for (var i = 0; i < this.listeners[evt].length; i++) {\n          try {\n            var v = this.listeners[evt][i](value);\n            if (v != null) {\n              result = v;\n            }\n          } catch (e) {}\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"resolveGrid\",\n    value: function resolveGrid() {\n      var out = {\n        grid: null,\n        thresholdX: DEFAULT_GRID_X / 2,\n        thresholdY: DEFAULT_GRID_Y / 2\n      };\n      if (this._activeSelectorParams != null && this._activeSelectorParams.grid != null) {\n        out.grid = this._activeSelectorParams.grid;\n        if (this._activeSelectorParams.snapThreshold != null) {\n          out.thresholdX = this._activeSelectorParams.snapThreshold;\n          out.thresholdY = this._activeSelectorParams.snapThreshold;\n        }\n      }\n      return out;\n    }\n  }, {\n    key: \"toGrid\",\n    value: function toGrid(pos) {\n      var _this$resolveGrid = this.resolveGrid(),\n          grid = _this$resolveGrid.grid,\n          thresholdX = _this$resolveGrid.thresholdX,\n          thresholdY = _this$resolveGrid.thresholdY;\n      if (grid == null) {\n        return pos;\n      } else {\n        var tx = grid ? grid.w / 2 : thresholdX,\n            ty = grid ? grid.h / 2 : thresholdY;\n        return snapToGrid(pos, grid, tx, ty);\n      }\n    }\n  }, {\n    key: \"setUseGhostProxy\",\n    value: function setUseGhostProxy(val) {\n      this._useGhostProxy = val ? TRUE : FALSE;\n    }\n  }, {\n    key: \"_doConstrain\",\n    value: function _doConstrain(pos, dragEl, _constrainRect, _size, e) {\n      if (this._activeSelectorParams != null && this._activeSelectorParams.constrainFunction && typeof this._activeSelectorParams.constrainFunction === \"function\") {\n        return this._activeSelectorParams.constrainFunction(pos, dragEl, _constrainRect, _size, e);\n      } else {\n        return pos;\n      }\n    }\n  }, {\n    key: \"_testFilter\",\n    value: function _testFilter(e) {\n      for (var key in this._filters) {\n        var f = this._filters[key];\n        var rv = f[0](e);\n        if (f[1]) {\n          rv = !rv;\n        }\n        if (!rv) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: \"addFilter\",\n    value: function addFilter(f, _exclude) {\n      var _this2 = this;\n      if (f) {\n        var key = _assignId(f);\n        this._filters[key] = [function (e) {\n          var t = e.srcElement || e.target;\n          var m;\n          if (isString(f)) {\n            m = matchesSelector$1(t, f, _this2.el);\n          } else if (typeof f === \"function\") {\n            m = f(e, _this2.el);\n          }\n          return m;\n        }, _exclude !== false];\n      }\n    }\n  }, {\n    key: \"removeFilter\",\n    value: function removeFilter(f) {\n      var key = typeof f === \"function\" ? f._katavorioId : f;\n      delete this._filters[key];\n    }\n  }, {\n    key: \"clearAllFilters\",\n    value: function clearAllFilters() {\n      this._filters = {};\n    }\n  }, {\n    key: \"addSelector\",\n    value: function addSelector(params, atStart) {\n      if (params.selector) {\n        if (atStart) {\n          this._availableSelectors.unshift(params);\n        } else {\n          this._availableSelectors.push(params);\n        }\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.eventManager.off(this.el, EVENT_MOUSEDOWN, this.downListener);\n      this.eventManager.off(document, EVENT_MOUSEMOVE, this.moveListener);\n      this.eventManager.off(document, EVENT_MOUSEUP, this.upListener);\n      this.downListener = null;\n      this.upListener = null;\n      this.moveListener = null;\n      if (this.scrollTracker != null) {\n        document.removeEventListener(\"scroll\", this.scrollTracker);\n      }\n    }\n  }]);\n  return Drag;\n}(Base);\nvar DEFAULT_INPUTS = [\"input\", \"textarea\", \"select\", \"button\", \"option\"];\nvar DEFAULT_INPUT_FILTER_SELECTOR = DEFAULT_INPUTS.join(\",\");\nvar Collicat = function () {\n  function Collicat(options) {\n    _classCallCheck(this, Collicat);\n    _defineProperty(this, \"eventManager\", void 0);\n    _defineProperty(this, \"zoom\", 1);\n    _defineProperty(this, \"css\", {});\n    _defineProperty(this, \"inputFilterSelector\", void 0);\n    _defineProperty(this, \"positioningStrategy\", void 0);\n    _defineProperty(this, \"_positionSetter\", void 0);\n    _defineProperty(this, \"_positionGetter\", void 0);\n    _defineProperty(this, \"_sizeSetter\", void 0);\n    _defineProperty(this, \"_sizeGetter\", void 0);\n    options = options || {};\n    this.inputFilterSelector = options.inputFilterSelector || DEFAULT_INPUT_FILTER_SELECTOR;\n    this.eventManager = new EventManager();\n    this.zoom = options.zoom || 1;\n    this.positioningStrategy = options.positioningStrategy || PositioningStrategies.absolutePosition;\n    this._positionGetter = positionerGetters.get(this.positioningStrategy);\n    this._positionSetter = positionerSetters.get(this.positioningStrategy);\n    this._sizeGetter = sizeGetters.get(this.positioningStrategy);\n    this._sizeSetter = sizeSetters.get(this.positioningStrategy);\n    var _c = options.css || {};\n    extend(this.css, _c);\n  }\n  _createClass(Collicat, [{\n    key: \"getPosition\",\n    value: function getPosition(el) {\n      return this._positionGetter(el);\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(el, p) {\n      this._positionSetter(el, p);\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize(el) {\n      return this._sizeGetter(el);\n    }\n  }, {\n    key: \"getZoom\",\n    value: function getZoom() {\n      return this.zoom;\n    }\n  }, {\n    key: \"setZoom\",\n    value: function setZoom(z) {\n      this.zoom = z;\n    }\n  }, {\n    key: \"_prepareParams\",\n    value: function _prepareParams(p) {\n      p = p || {};\n      var _p = {\n        events: {}\n      },\n          i;\n      for (i in p) {\n        _p[i] = p[i];\n      }\n      for (i = 0; i < _events.length; i++) {\n        _p.events[_events[i]] = p[_events[i]] || _devNull;\n      }\n      return _p;\n    }\n  }, {\n    key: \"getInputFilterSelector\",\n    value: function getInputFilterSelector() {\n      return this.inputFilterSelector;\n    }\n  }, {\n    key: \"setInputFilterSelector\",\n    value: function setInputFilterSelector(selector) {\n      this.inputFilterSelector = selector;\n      return this;\n    }\n  }, {\n    key: \"draggable\",\n    value: function draggable(el, params) {\n      if (el._katavorioDrag == null) {\n        var _p3 = this._prepareParams(params);\n        var d = new Drag(el, _p3, this);\n        addClass(el, _classes.delegatedDraggable);\n        el._katavorioDrag = d;\n        return d;\n      } else {\n        return el._katavorioDrag;\n      }\n    }\n  }, {\n    key: \"destroyDraggable\",\n    value: function destroyDraggable(el) {\n      if (el._katavorioDrag) {\n        el._katavorioDrag.destroy();\n        delete el._katavorioDrag;\n      }\n    }\n  }]);\n  return Collicat;\n}();\n\nvar CLASS_DRAG_SELECTED = \"jtk-drag-selected\";\nvar DragSelection = function () {\n  function DragSelection(instance) {\n    _classCallCheck(this, DragSelection);\n    this.instance = instance;\n    _defineProperty(this, \"_dragSelection\", []);\n    _defineProperty(this, \"_dragSizes\", new Map());\n    _defineProperty(this, \"_dragElements\", new Map());\n    _defineProperty(this, \"_dragElementStartPositions\", new Map());\n    _defineProperty(this, \"_dragElementPositions\", new Map());\n    _defineProperty(this, \"__activeSet\", void 0);\n  }\n  _createClass(DragSelection, [{\n    key: \"_activeSet\",\n    get: function get() {\n      if (this.__activeSet == null) {\n        return this._dragSelection;\n      } else {\n        return this.__activeSet;\n      }\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this._dragSelection.length;\n    }\n  }, {\n    key: \"filterActiveSet\",\n    value: function filterActiveSet(fn) {\n      var _this = this;\n      this.__activeSet = [];\n      forEach(this._dragSelection, function (p) {\n        if (fn(p)) {\n          _this.__activeSet.push(p);\n        }\n      });\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var _this2 = this;\n      this.reset();\n      forEach(this._dragSelection, function (p) {\n        return _this2.instance.removeClass(p.jel, CLASS_DRAG_SELECTED);\n      });\n      this._dragSelection.length = 0;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this._dragElementStartPositions.clear();\n      this._dragElementPositions.clear();\n      this._dragSizes.clear();\n      this._dragElements.clear();\n      this.__activeSet = null;\n    }\n  }, {\n    key: \"initialisePositions\",\n    value: function initialisePositions() {\n      var _this3 = this;\n      forEach(this._activeSet, function (p) {\n        var vp = _this3.instance.viewport.getPosition(p.id);\n        var off = {\n          x: parseInt(\"\" + p.jel.offsetLeft, 10),\n          y: parseInt(\"\" + p.jel.offsetTop, 10)\n        };\n        _this3._dragElementStartPositions.set(p.id, off);\n        _this3._dragElementPositions.set(p.id, off);\n        _this3._dragSizes.set(p.id, {\n          w: vp.w,\n          h: vp.h\n        });\n      });\n    }\n  }, {\n    key: \"updatePositions\",\n    value: function updatePositions(currentPosition, originalPosition, callback) {\n      var _this4 = this;\n      var dx = currentPosition.x - originalPosition.x,\n          dy = currentPosition.y - originalPosition.y;\n      forEach(this._activeSet, function (p) {\n        var op = _this4._dragElementStartPositions.get(p.id);\n        if (op) {\n          var x = op.x + dx,\n              y = op.y + dy;\n          var _s = _this4._dragSizes.get(p.id);\n          var _b = {\n            x: x,\n            y: y,\n            w: _s.w,\n            h: _s.h\n          };\n          if (p.jel._jsPlumbParentGroup && p.jel._jsPlumbParentGroup.constrain) {\n            var constrainRect = {\n              w: p.jel.parentNode.offsetWidth + p.jel.parentNode.scrollLeft,\n              h: p.jel.parentNode.offsetHeight + p.jel.parentNode.scrollTop\n            };\n            _b.x = Math.max(_b.x, 0);\n            _b.y = Math.max(_b.y, 0);\n            _b.x = Math.min(_b.x, constrainRect.w - _s.w);\n            _b.y = Math.min(_b.y, constrainRect.h - _s.h);\n          }\n          _this4._dragElementPositions.set(p.id, {\n            x: x,\n            y: y\n          });\n          p.jel.style.left = _b.x + \"px\";\n          p.jel.style.top = _b.y + \"px\";\n          callback(p.jel, p.id, _s, _b);\n        }\n      });\n    }\n  }, {\n    key: \"each\",\n    value: function each(f) {\n      var _this5 = this;\n      forEach(this._activeSet, function (p) {\n        var s = _this5._dragSizes.get(p.id);\n        var o = _this5._dragElementPositions.get(p.id);\n        var orig = _this5._dragElementStartPositions.get(p.id);\n        f(p.jel, p.id, o, s, orig);\n      });\n    }\n  }, {\n    key: \"add\",\n    value: function add(el, id) {\n      var jel = el;\n      id = id || this.instance.getId(jel);\n      var idx = findWithFunction(this._dragSelection, function (p) {\n        return p.id === id;\n      });\n      if (idx === -1) {\n        this.instance.addClass(el, CLASS_DRAG_SELECTED);\n        this._dragSelection.push({\n          id: id,\n          jel: jel\n        });\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(el) {\n      var _this6 = this;\n      var jel = el;\n      this._dragSelection = this._dragSelection.filter(function (p) {\n        var out = p.jel !== jel;\n        if (!out) {\n          _this6.instance.removeClass(p.jel, CLASS_DRAG_SELECTED);\n        }\n        return out;\n      });\n    }\n  }, {\n    key: \"toggle\",\n    value: function toggle(el) {\n      var jel = el;\n      var idx = findWithFunction(this._dragSelection, function (p) {\n        return p.jel === jel;\n      });\n      if (idx !== -1) {\n        this.remove(jel);\n      } else {\n        this.add(el);\n      }\n    }\n  }]);\n  return DragSelection;\n}();\n\nvar CLASS_DELEGATED_DRAGGABLE = \"jtk-delegated-draggable\";\nvar CLASS_DRAGGABLE = \"jtk-draggable\";\nvar CLASS_DRAG_CONTAINER = \"jtk-drag\";\nvar CLASS_GHOST_PROXY = \"jtk-ghost-proxy\";\nvar CLASS_DRAG_ACTIVE = \"jtk-drag-active\";\nvar CLASS_DRAGGED = \"jtk-dragged\";\nvar CLASS_DRAG_HOVER = \"jtk-drag-hover\";\nvar DragManager = function () {\n  function DragManager(instance, dragSelection, options) {\n    var _this = this;\n    _classCallCheck(this, DragManager);\n    this.instance = instance;\n    this.dragSelection = dragSelection;\n    _defineProperty(this, \"collicat\", void 0);\n    _defineProperty(this, \"drag\", void 0);\n    _defineProperty(this, \"_draggables\", {});\n    _defineProperty(this, \"_dlist\", []);\n    _defineProperty(this, \"_elementsWithEndpoints\", {});\n    _defineProperty(this, \"_draggablesForElements\", {});\n    _defineProperty(this, \"handlers\", []);\n    _defineProperty(this, \"_trackScroll\", void 0);\n    _defineProperty(this, \"_filtersToAdd\", []);\n    this.collicat = new Collicat({\n      zoom: this.instance.currentZoom,\n      css: {\n        noSelect: this.instance.dragSelectClass,\n        delegatedDraggable: CLASS_DELEGATED_DRAGGABLE,\n        draggable: CLASS_DRAGGABLE,\n        drag: CLASS_DRAG_CONTAINER,\n        selected: CLASS_DRAG_SELECTED,\n        active: CLASS_DRAG_ACTIVE,\n        hover: CLASS_DRAG_HOVER,\n        ghostProxy: CLASS_GHOST_PROXY\n      }\n    });\n    this.instance.bind(EVENT_ZOOM, function (z) {\n      _this.collicat.setZoom(z);\n    });\n    options = options || {};\n    this._trackScroll = options.trackScroll !== false;\n  }\n  _createClass(DragManager, [{\n    key: \"addHandler\",\n    value: function addHandler(handler, dragOptions) {\n      var _this2 = this;\n      var o = extend({\n        selector: handler.selector\n      }, dragOptions || {});\n      o.start = wrap(o.start, function (p) {\n        return handler.onStart(p);\n      }, false);\n      o.drag = wrap(o.drag, function (p) {\n        return handler.onDrag(p);\n      });\n      o.stop = wrap(o.stop, function (p) {\n        return handler.onStop(p);\n      });\n      var handlerBeforeStart = (handler.onBeforeStart || function (p) {}).bind(handler);\n      o.beforeStart = wrap(o.beforeStart, function (p) {\n        return handlerBeforeStart(p);\n      });\n      o.dragInit = function (el, e) {\n        return handler.onDragInit(el, e);\n      };\n      o.dragAbort = function (el) {\n        return handler.onDragAbort(el);\n      };\n      if (handler.useGhostProxy) {\n        o.useGhostProxy = handler.useGhostProxy;\n        o.makeGhostProxy = handler.makeGhostProxy;\n      }\n      if (o.constrainFunction == null && o.containment != null) {\n        switch (o.containment) {\n          case ContainmentType.notNegative:\n            {\n              o.constrainFunction = function (pos, dragEl, _constrainRect, _size) {\n                return {\n                  x: Math.max(0, Math.min(pos.x)),\n                  y: Math.max(0, Math.min(pos.y))\n                };\n              };\n              break;\n            }\n          case ContainmentType.parent:\n            {\n              var padding = o.containmentPadding || 5;\n              o.constrainFunction = function (pos, dragEl, _constrainRect, _size) {\n                var x = pos.x < 0 ? 0 : pos.x > _constrainRect.w - padding ? _constrainRect.w - padding : pos.x;\n                var y = pos.y < 0 ? 0 : pos.y > _constrainRect.h - padding ? _constrainRect.h - padding : pos.y;\n                return {\n                  x: x,\n                  y: y\n                };\n              };\n              break;\n            }\n          case ContainmentType.parentEnclosed:\n            {\n              o.constrainFunction = function (pos, dragEl, _constrainRect, _size) {\n                var x = pos.x < 0 ? 0 : pos.x + _size.w > _constrainRect.w ? _constrainRect.w - _size.w : pos.x;\n                var y = pos.y < 0 ? 0 : pos.y + _size.h > _constrainRect.h ? _constrainRect.h - _size.h : pos.y;\n                return {\n                  x: x,\n                  y: y\n                };\n              };\n              break;\n            }\n        }\n      }\n      if (this.drag == null) {\n        o.trackScroll = this._trackScroll;\n        this.drag = this.collicat.draggable(this.instance.getContainer(), o);\n        forEach(this._filtersToAdd, function (filterToAdd) {\n          return _this2.drag.addFilter(filterToAdd[0], filterToAdd[1]);\n        });\n        this.drag.on(EVENT_REVERT, function (el) {\n          _this2.instance.revalidate(el);\n        });\n      } else {\n        this.drag.addSelector(o);\n      }\n      this.handlers.push({\n        handler: handler,\n        options: o\n      });\n      handler.init(this.drag);\n    }\n  }, {\n    key: \"addSelector\",\n    value: function addSelector(params, atStart) {\n      this.drag && this.drag.addSelector(params, atStart);\n    }\n  }, {\n    key: \"addFilter\",\n    value: function addFilter(filter, exclude) {\n      if (this.drag == null) {\n        this._filtersToAdd.push([filter, exclude === true]);\n      } else {\n        this.drag.addFilter(filter, exclude);\n      }\n    }\n  }, {\n    key: \"removeFilter\",\n    value: function removeFilter(filter) {\n      if (this.drag != null) {\n        this.drag.removeFilter(filter);\n      }\n    }\n  }, {\n    key: \"setFilters\",\n    value: function setFilters(filters) {\n      var _this3 = this;\n      forEach(filters, function (f) {\n        _this3.drag.addFilter(f[0], f[1]);\n      });\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      var out = [];\n      forEach(this.handlers, function (p) {\n        p.handler.reset();\n      });\n      this.handlers.length = 0;\n      if (this.drag != null) {\n        var currentFilters = this.drag._filters;\n        for (var f in currentFilters) {\n          out.push([f, currentFilters[f][1]]);\n        }\n        this.collicat.destroyDraggable(this.instance.getContainer());\n      }\n      delete this.drag;\n      return out;\n    }\n  }, {\n    key: \"setOption\",\n    value: function setOption(handler, options) {\n      var handlerAndOptions = getWithFunction(this.handlers, function (p) {\n        return p.handler === handler;\n      });\n      if (handlerAndOptions != null) {\n        extend(handlerAndOptions.options, options || {});\n      }\n    }\n  }]);\n  return DragManager;\n}();\n\nfunction decodeDragGroupSpec(instance, spec) {\n  if (isString(spec)) {\n    return {\n      id: spec,\n      active: true\n    };\n  } else {\n    return {\n      id: spec.id,\n      active: spec.active\n    };\n  }\n}\nfunction isActiveDragGroupMember(dragGroup, el) {\n  var details = getFromSetWithFunction(dragGroup.members, function (m) {\n    return m.el === el;\n  });\n  if (details !== null) {\n    return details.active === true;\n  } else {\n    return false;\n  }\n}\nfunction getAncestors(el) {\n  var ancestors = [];\n  var p = el._jsPlumbParentGroup;\n  while (p != null) {\n    ancestors.push(p.el);\n    p = p.group;\n  }\n  return ancestors;\n}\nvar ElementDragHandler = function () {\n  function ElementDragHandler(instance, _dragSelection) {\n    _classCallCheck(this, ElementDragHandler);\n    this.instance = instance;\n    this._dragSelection = _dragSelection;\n    _defineProperty(this, \"selector\", \"> \" + SELECTOR_MANAGED_ELEMENT + \":not(\" + cls(CLASS_OVERLAY) + \")\");\n    _defineProperty(this, \"_dragOffset\", null);\n    _defineProperty(this, \"_groupLocations\", []);\n    _defineProperty(this, \"_intersectingGroups\", []);\n    _defineProperty(this, \"_currentDragParentGroup\", null);\n    _defineProperty(this, \"_dragGroupByElementIdMap\", {});\n    _defineProperty(this, \"_dragGroupMap\", {});\n    _defineProperty(this, \"_currentDragGroup\", null);\n    _defineProperty(this, \"_currentDragGroupOffsets\", new Map());\n    _defineProperty(this, \"_currentDragGroupSizes\", new Map());\n    _defineProperty(this, \"_currentDragGroupOriginalPositions\", new Map());\n    _defineProperty(this, \"_dragPayload\", null);\n    _defineProperty(this, \"drag\", void 0);\n    _defineProperty(this, \"originalPosition\", void 0);\n  }\n  _createClass(ElementDragHandler, [{\n    key: \"onDragInit\",\n    value: function onDragInit(el) {\n      return null;\n    }\n  }, {\n    key: \"onDragAbort\",\n    value: function onDragAbort(el) {\n      return null;\n    }\n  }, {\n    key: \"getDropGroup\",\n    value: function getDropGroup() {\n      var dropGroup = null;\n      if (this._intersectingGroups.length > 0) {\n        var targetGroup = this._intersectingGroups[0].groupLoc.group;\n        var intersectingElement = this._intersectingGroups[0].intersectingElement;\n        var currentGroup = intersectingElement._jsPlumbParentGroup;\n        if (currentGroup !== targetGroup) {\n          if (currentGroup == null || !currentGroup.overrideDrop(intersectingElement, targetGroup)) {\n            dropGroup = this._intersectingGroups[0];\n          }\n        }\n      }\n      return dropGroup;\n    }\n  }, {\n    key: \"onStop\",\n    value: function onStop(params) {\n      var _this$_currentDragGro,\n          _this = this;\n      var jel = params.drag.getDragElement();\n      var dropGroup = this.getDropGroup();\n      var elementsToProcess = [];\n      elementsToProcess.push({\n        el: jel,\n        id: this.instance.getId(jel),\n        pos: params.finalPos,\n        originalGroup: jel._jsPlumbParentGroup,\n        redrawResult: null,\n        originalPos: params.originalPos,\n        reverted: false,\n        dropGroup: dropGroup != null ? dropGroup.groupLoc.group : null\n      });\n      function addElementToProcess(el, id, currentPos, s, originalPosition) {\n        var x = currentPos.x,\n            y = currentPos.y;\n        if (el._jsPlumbParentGroup && el._jsPlumbParentGroup.constrain) {\n          var constrainRect = {\n            w: el.parentNode.offsetWidth + el.parentNode.scrollLeft,\n            h: el.parentNode.offsetHeight + el.parentNode.scrollTop\n          };\n          x = Math.max(x, 0);\n          y = Math.max(y, 0);\n          x = Math.min(x, constrainRect.w - s.w);\n          y = Math.min(y, constrainRect.h - s.h);\n          currentPos.x = x;\n          currentPos.y = y;\n        }\n        elementsToProcess.push({\n          el: el,\n          id: id,\n          pos: currentPos,\n          originalPos: originalPosition,\n          originalGroup: el._jsPlumbParentGroup,\n          redrawResult: null,\n          reverted: false,\n          dropGroup: dropGroup === null || dropGroup === void 0 ? void 0 : dropGroup.groupLoc.group\n        });\n      }\n      this._dragSelection.each(function (el, id, o, s, originalPosition) {\n        if (el !== params.el) {\n          addElementToProcess(el, id, {\n            x: o.x,\n            y: o.y\n          }, s, originalPosition);\n        }\n      });\n      (_this$_currentDragGro = this._currentDragGroup) === null || _this$_currentDragGro === void 0 ? void 0 : _this$_currentDragGro.members.forEach(function (d) {\n        if (d.el !== params.el) {\n          var offset = _this._currentDragGroupOffsets.get(d.elId);\n          var s = _this._currentDragGroupSizes.get(d.elId);\n          var pp = {\n            x: params.finalPos.x + offset[0].x,\n            y: params.finalPos.y + offset[0].y\n          };\n          addElementToProcess(d.el, d.elId, pp, s, _this._currentDragGroupOriginalPositions.get(d.elId));\n        }\n      });\n      forEach(elementsToProcess, function (p) {\n        var wasInGroup = p.originalGroup != null,\n            isInOriginalGroup = wasInGroup && isInsideParent(_this.instance, p.el, p.pos),\n            parentOffset = {\n          x: 0,\n          y: 0\n        };\n        if (wasInGroup && !isInOriginalGroup) {\n          if (dropGroup == null) {\n            var orphanedPosition = _this._pruneOrOrphan(p, true, true);\n            if (orphanedPosition.pos != null) {\n              p.pos = orphanedPosition.pos.pos;\n            } else {\n              if (!orphanedPosition.pruned && p.originalGroup.revert) {\n                p.pos = p.originalPos;\n                p.reverted = true;\n              }\n            }\n          }\n        } else if (wasInGroup && isInOriginalGroup) {\n          parentOffset = _this._computeOffsetByParentGroup(p.originalGroup);\n        }\n        if (dropGroup != null && !isInOriginalGroup) {\n          _this.instance.groupManager.addToGroup(dropGroup.groupLoc.group, false, p.el);\n        } else {\n          p.dropGroup = null;\n        }\n        if (p.reverted) {\n          _this.instance.setPosition(p.el, p.pos);\n        }\n        p.redrawResult = _this.instance.setElementPosition(p.el, p.pos.x + parentOffset.x, p.pos.y + parentOffset.y);\n        _this.instance.removeClass(p.el, CLASS_DRAGGED);\n        _this.instance.select({\n          source: p.el\n        }).removeClass(_this.instance.elementDraggingClass + \" \" + _this.instance.sourceElementDraggingClass, true);\n        _this.instance.select({\n          target: p.el\n        }).removeClass(_this.instance.elementDraggingClass + \" \" + _this.instance.targetElementDraggingClass, true);\n      });\n      if (elementsToProcess[0].originalGroup != null) {\n        var currentGroup = jel._jsPlumbParentGroup;\n        if (currentGroup !== elementsToProcess[0].originalGroup) {\n          var originalElement = params.drag.getDragElement(true);\n          if (elementsToProcess[0].originalGroup.ghost) {\n            var o1 = this.instance.getPosition(this.instance.getGroupContentArea(currentGroup));\n            var o2 = this.instance.getPosition(this.instance.getGroupContentArea(elementsToProcess[0].originalGroup));\n            var o = {\n              x: o2.x + params.pos.x - o1.x,\n              y: o2.y + params.pos.y - o1.y\n            };\n            originalElement.style.left = o.x + \"px\";\n            originalElement.style.top = o.y + \"px\";\n            this.instance.revalidate(originalElement);\n          }\n        }\n      }\n      this.instance.fire(EVENT_DRAG_STOP, {\n        elements: elementsToProcess,\n        e: params.e,\n        el: jel,\n        payload: this._dragPayload\n      });\n      this._cleanup();\n    }\n  }, {\n    key: \"_cleanup\",\n    value: function _cleanup() {\n      var _this2 = this;\n      forEach(this._groupLocations, function (groupLoc) {\n        _this2.instance.removeClass(groupLoc.el, CLASS_DRAG_ACTIVE);\n        _this2.instance.removeClass(groupLoc.el, CLASS_DRAG_HOVER);\n      });\n      this._currentDragParentGroup = null;\n      this._groupLocations.length = 0;\n      this.instance.hoverSuspended = false;\n      this._dragOffset = null;\n      this._dragSelection.reset();\n      this._dragPayload = null;\n      this._currentDragGroupOffsets.clear();\n      this._currentDragGroupSizes.clear();\n      this._currentDragGroupOriginalPositions.clear();\n      this._currentDragGroup = null;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {}\n  }, {\n    key: \"init\",\n    value: function init(drag) {\n      this.drag = drag;\n    }\n  }, {\n    key: \"onDrag\",\n    value: function onDrag(params) {\n      var _this3 = this;\n      var el = params.drag.getDragElement();\n      var id = this.instance.getId(el);\n      var finalPos = params.pos;\n      var elSize = this.instance.viewport.getPosition(id);\n      var ui = {\n        x: finalPos.x,\n        y: finalPos.y\n      };\n      this._intersectingGroups.length = 0;\n      if (this._dragOffset != null) {\n        ui.x += this._dragOffset.x;\n        ui.y += this._dragOffset.y;\n      }\n      var _one = function _one(el, bounds, findIntersectingGroups) {\n        if (findIntersectingGroups) {\n          var ancestorsOfIntersectingGroups = new Set();\n          forEach(_this3._groupLocations, function (groupLoc) {\n            if (!ancestorsOfIntersectingGroups.has(groupLoc.group.id) && intersects(bounds, groupLoc.r)) {\n              if (groupLoc.group !== _this3._currentDragParentGroup) {\n                _this3.instance.addClass(groupLoc.el, CLASS_DRAG_HOVER);\n              }\n              _this3._intersectingGroups.push({\n                groupLoc: groupLoc,\n                intersectingElement: params.drag.getDragElement(true),\n                d: 0\n              });\n              forEach(_this3.instance.groupManager.getAncestors(groupLoc.group), function (g) {\n                return ancestorsOfIntersectingGroups.add(g.id);\n              });\n            } else {\n              _this3.instance.removeClass(groupLoc.el, CLASS_DRAG_HOVER);\n            }\n          });\n        }\n        _this3.instance.setElementPosition(el, bounds.x, bounds.y);\n        _this3.instance.fire(EVENT_DRAG_MOVE, {\n          el: el,\n          e: params.e,\n          pos: {\n            x: bounds.x,\n            y: bounds.y\n          },\n          originalPosition: _this3.originalPosition,\n          payload: _this3._dragPayload\n        });\n      };\n      var elBounds = {\n        x: ui.x,\n        y: ui.y,\n        w: elSize.w,\n        h: elSize.h\n      };\n      _one(el, elBounds, true);\n      this._dragSelection.updatePositions(finalPos, this.originalPosition, function (el, id, s, b) {\n        _one(el, b, false);\n      });\n      this._currentDragGroupOffsets.forEach(function (v, k) {\n        var s = _this3._currentDragGroupSizes.get(k);\n        var _b = {\n          x: elBounds.x + v[0].x,\n          y: elBounds.y + v[0].y,\n          w: s.w,\n          h: s.h\n        };\n        v[1].style.left = _b.x + \"px\";\n        v[1].style.top = _b.y + \"px\";\n        _one(v[1], _b, false);\n      });\n    }\n  }, {\n    key: \"_computeOffsetByParentGroup\",\n    value: function _computeOffsetByParentGroup(group) {\n      var parentGroupOffset = this.instance.getPosition(group.el);\n      var contentArea = group.contentArea;\n      if (contentArea !== group.el) {\n        var caOffset = this.instance.getPosition(contentArea);\n        parentGroupOffset.x += caOffset.x;\n        parentGroupOffset.y += caOffset.y;\n      }\n      if (group.el._jsPlumbParentGroup) {\n        var ancestorOffset = this._computeOffsetByParentGroup(group.el._jsPlumbParentGroup);\n        parentGroupOffset.x += ancestorOffset.x;\n        parentGroupOffset.y += ancestorOffset.y;\n      }\n      return parentGroupOffset;\n    }\n  }, {\n    key: \"onStart\",\n    value: function onStart(params) {\n      var _this4 = this;\n      var el = params.drag.getDragElement();\n      var elOffset = this.instance.getPosition(el);\n      this.originalPosition = {\n        x: params.pos.x,\n        y: params.pos.y\n      };\n      if (el._jsPlumbParentGroup) {\n        this._dragOffset = this._computeOffsetByParentGroup(el._jsPlumbParentGroup);\n        this._currentDragParentGroup = el._jsPlumbParentGroup;\n      }\n      var cont = true;\n      var nd = el.getAttribute(ATTRIBUTE_NOT_DRAGGABLE);\n      if (this.instance.elementsDraggable === false || nd != null && nd !== FALSE$1) {\n        cont = false;\n      }\n      if (cont) {\n        this._groupLocations.length = 0;\n        this._intersectingGroups.length = 0;\n        this.instance.hoverSuspended = true;\n        var originalElement = params.drag.getDragElement(true),\n            descendants = originalElement.querySelectorAll(SELECTOR_MANAGED_ELEMENT),\n            ancestors = getAncestors(originalElement),\n            a = [];\n        Array.prototype.push.apply(a, descendants);\n        Array.prototype.push.apply(a, ancestors);\n        this._dragSelection.filterActiveSet(function (p) {\n          return a.indexOf(p.jel) === -1;\n        });\n        this._dragSelection.initialisePositions();\n        var _one = function _one(_el, dragGroup, dragGroupMemberSpec) {\n          if (!_el._isJsPlumbGroup || _this4.instance.allowNestedGroups) {\n            var isNotInAGroup = !_el._jsPlumbParentGroup;\n            var membersAreDroppable = isNotInAGroup || _el._jsPlumbParentGroup.dropOverride !== true;\n            var isGhostOrNotConstrained = !isNotInAGroup && (_el._jsPlumbParentGroup.ghost || _el._jsPlumbParentGroup.constrain !== true);\n            if (isNotInAGroup || membersAreDroppable && isGhostOrNotConstrained) {\n              forEach(_this4.instance.groupManager.getGroups(), function (group) {\n                var elementGroup = _el._jsPlumbGroup;\n                if (group.droppable !== false && group.enabled !== false && _el._jsPlumbGroup !== group && !_this4.instance.groupManager.isDescendant(group, elementGroup)) {\n                  var groupEl = group.el,\n                      groupElId = _this4.instance.getId(groupEl),\n                      p = _this4.instance.viewport.getPosition(groupElId),\n                      boundingRect = {\n                    x: p.x,\n                    y: p.y,\n                    w: p.w,\n                    h: p.h\n                  };\n                  var groupLocation = {\n                    el: groupEl,\n                    r: boundingRect,\n                    group: group\n                  };\n                  _this4._groupLocations.push(groupLocation);\n                  if (group !== _this4._currentDragParentGroup) {\n                    _this4.instance.addClass(groupEl, CLASS_DRAG_ACTIVE);\n                  }\n                }\n              });\n              _this4._groupLocations.sort(function (a, b) {\n                if (_this4.instance.groupManager.isDescendant(a.group, b.group)) {\n                  return -1;\n                } else if (_this4.instance.groupManager.isAncestor(b.group, a.group)) {\n                  return 1;\n                } else {\n                  return 0;\n                }\n              });\n            }\n          }\n          _this4.instance.select({\n            source: _el\n          }).addClass(_this4.instance.elementDraggingClass + \" \" + _this4.instance.sourceElementDraggingClass, true);\n          _this4.instance.select({\n            target: _el\n          }).addClass(_this4.instance.elementDraggingClass + \" \" + _this4.instance.targetElementDraggingClass, true);\n          return _this4.instance.fire(EVENT_DRAG_START, {\n            el: _el,\n            e: params.e,\n            originalPosition: _this4.originalPosition,\n            pos: _this4.originalPosition,\n            dragGroup: dragGroup,\n            dragGroupMemberSpec: dragGroupMemberSpec\n          });\n        };\n        var elId = this.instance.getId(el);\n        this._currentDragGroup = this._dragGroupByElementIdMap[elId];\n        if (this._currentDragGroup && !isActiveDragGroupMember(this._currentDragGroup, el)) {\n          this._currentDragGroup = null;\n        }\n        var dragStartReturn = _one(el);\n        if (dragStartReturn === false) {\n          this._cleanup();\n          return false;\n        } else {\n          this._dragPayload = dragStartReturn;\n        }\n        if (this._currentDragGroup != null) {\n          this._currentDragGroupOffsets.clear();\n          this._currentDragGroupSizes.clear();\n          this._currentDragGroup.members.forEach(function (jel) {\n            var vp = _this4.instance.viewport.getPosition(jel.elId);\n            _this4._currentDragGroupOffsets.set(jel.elId, [{\n              x: vp.x - elOffset.x,\n              y: vp.y - elOffset.y\n            }, jel.el]);\n            _this4._currentDragGroupSizes.set(jel.elId, vp);\n            _this4._currentDragGroupOriginalPositions.set(jel.elId, {\n              x: vp.x,\n              y: vp.y\n            });\n            _one(jel.el, _this4._currentDragGroup, jel);\n          });\n        }\n      }\n      return cont;\n    }\n  }, {\n    key: \"addToDragGroup\",\n    value: function addToDragGroup(spec) {\n      var _this5 = this;\n      var details = decodeDragGroupSpec(this.instance, spec);\n      var dragGroup = this._dragGroupMap[details.id];\n      if (dragGroup == null) {\n        dragGroup = {\n          id: details.id,\n          members: new Set()\n        };\n        this._dragGroupMap[details.id] = dragGroup;\n      }\n      for (var _len = arguments.length, els = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        els[_key - 1] = arguments[_key];\n      }\n      this.removeFromDragGroup.apply(this, els);\n      forEach(els, function (el) {\n        var elId = _this5.instance.getId(el);\n        dragGroup.members.add({\n          elId: elId,\n          el: el,\n          active: details.active\n        });\n        _this5._dragGroupByElementIdMap[elId] = dragGroup;\n      });\n    }\n  }, {\n    key: \"removeFromDragGroup\",\n    value: function removeFromDragGroup() {\n      var _this6 = this;\n      for (var _len2 = arguments.length, els = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        els[_key2] = arguments[_key2];\n      }\n      forEach(els, function (el) {\n        var id = _this6.instance.getId(el);\n        var dragGroup = _this6._dragGroupByElementIdMap[id];\n        if (dragGroup != null) {\n          var s = new Set();\n          dragGroup.members.forEach(function (member) {\n            if (member.el !== el) {\n              s.add(member);\n            }\n          });\n          dragGroup.members = s;\n          delete _this6._dragGroupByElementIdMap[id];\n        }\n      });\n    }\n  }, {\n    key: \"setDragGroupState\",\n    value: function setDragGroupState(active) {\n      var _this7 = this;\n      for (var _len3 = arguments.length, els = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        els[_key3 - 1] = arguments[_key3];\n      }\n      var elementIds = els.map(function (el) {\n        return _this7.instance.getId(el);\n      });\n      forEach(elementIds, function (id) {\n        var dragGroup = _this7._dragGroupByElementIdMap[id];\n        if (dragGroup != null) {\n          var member = getFromSetWithFunction(dragGroup.members, function (m) {\n            return m.elId === id;\n          });\n          if (member != null) {\n            member.active = active;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"clearDragGroup\",\n    value: function clearDragGroup(name) {\n      var _this8 = this;\n      var dragGroup = this._dragGroupMap[name];\n      if (dragGroup != null) {\n        dragGroup.members.forEach(function (member) {\n          delete _this8._dragGroupByElementIdMap[member.elId];\n        });\n        dragGroup.members.clear();\n      }\n    }\n  }, {\n    key: \"_pruneOrOrphan\",\n    value: function _pruneOrOrphan(params, doNotTransferToAncestor, isDefinitelyNotInsideParent) {\n      var jel = params.el;\n      var orphanedPosition = {\n        pruned: false,\n        pos: null\n      };\n      if (isDefinitelyNotInsideParent || !isInsideParent(this.instance, jel, params.pos)) {\n        var group = jel._jsPlumbParentGroup;\n        if (group.prune) {\n          if (jel._isJsPlumbGroup) {\n            this.instance.removeGroup(jel._jsPlumbGroup);\n          } else {\n            group.remove(params.el, true);\n          }\n          orphanedPosition.pruned = true;\n        } else if (group.orphan) {\n          orphanedPosition.pos = this.instance.groupManager.orphan(params.el, doNotTransferToAncestor);\n          if (jel._isJsPlumbGroup) {\n            group.removeGroup(jel._jsPlumbGroup);\n          } else {\n            group.remove(params.el);\n          }\n        }\n      }\n      return orphanedPosition;\n    }\n  }]);\n  return ElementDragHandler;\n}();\n\nfunction _makeFloatingEndpoint(ep, endpoint, referenceCanvas, sourceElement, sourceElementId, instance) {\n  var floatingAnchor = createFloatingAnchor(instance, sourceElement, sourceElementId);\n  var p = {\n    paintStyle: ep.getPaintStyle(),\n    preparedAnchor: floatingAnchor,\n    element: sourceElement,\n    scope: ep.scope,\n    cssClass: [CLASS_ENDPOINT_FLOATING, ep.cssClass].join(\" \")\n  };\n  if (endpoint != null) {\n    if (isAssignableFrom(endpoint, EndpointRepresentation)) {\n      p.existingEndpoint = endpoint;\n    } else {\n      p.endpoint = endpoint;\n    }\n  }\n  var actualEndpoint = instance._internal_newEndpoint(p);\n  instance._paintEndpoint(actualEndpoint, {});\n  return actualEndpoint;\n}\nfunction selectorFilter(evt, _el, selector, _instance, negate) {\n  var t = evt.target || evt.srcElement,\n      ok = false,\n      sel = _instance.getSelector(_el, selector);\n  for (var j = 0; j < sel.length; j++) {\n    if (sel[j] === t) {\n      ok = true;\n      break;\n    }\n  }\n  return negate ? !ok : ok;\n}\nvar SELECTOR_DRAG_ACTIVE_OR_HOVER = cls(CLASS_DRAG_ACTIVE, CLASS_DRAG_HOVER);\nvar SOURCE_SELECTOR_UNIQUE_ENDPOINT_DATA = \"sourceSelectorEndpoint\";\nvar EndpointDragHandler = function () {\n  function EndpointDragHandler(instance) {\n    _classCallCheck(this, EndpointDragHandler);\n    this.instance = instance;\n    _defineProperty(this, \"jpc\", void 0);\n    _defineProperty(this, \"existingJpc\", void 0);\n    _defineProperty(this, \"_originalAnchorSpec\", void 0);\n    _defineProperty(this, \"ep\", void 0);\n    _defineProperty(this, \"endpointRepresentation\", void 0);\n    _defineProperty(this, \"canvasElement\", void 0);\n    _defineProperty(this, \"_activeDefinition\", void 0);\n    _defineProperty(this, \"placeholderInfo\", {\n      id: null,\n      element: null\n    });\n    _defineProperty(this, \"floatingIndex\", void 0);\n    _defineProperty(this, \"floatingId\", void 0);\n    _defineProperty(this, \"floatingElement\", void 0);\n    _defineProperty(this, \"floatingEndpoint\", void 0);\n    _defineProperty(this, \"floatingAnchor\", void 0);\n    _defineProperty(this, \"_stopped\", void 0);\n    _defineProperty(this, \"inPlaceCopy\", void 0);\n    _defineProperty(this, \"endpointDropTargets\", []);\n    _defineProperty(this, \"currentDropTarget\", null);\n    _defineProperty(this, \"payload\", void 0);\n    _defineProperty(this, \"floatingConnections\", {});\n    _defineProperty(this, \"_forceReattach\", void 0);\n    _defineProperty(this, \"_forceDetach\", void 0);\n    _defineProperty(this, \"mousedownHandler\", void 0);\n    _defineProperty(this, \"mouseupHandler\", void 0);\n    _defineProperty(this, \"selector\", cls(CLASS_ENDPOINT));\n    var container = instance.getContainer();\n    this.mousedownHandler = this._mousedownHandler.bind(this);\n    this.mouseupHandler = this._mouseupHandler.bind(this);\n    instance.on(container, EVENT_MOUSEDOWN, SELECTOR_MANAGED_ELEMENT, this.mousedownHandler);\n    instance.on(container, EVENT_MOUSEUP, [SELECTOR_MANAGED_ELEMENT, cls(CLASS_ENDPOINT)].join(\",\"), this.mouseupHandler);\n  }\n  _createClass(EndpointDragHandler, [{\n    key: \"_resolveDragParent\",\n    value: function _resolveDragParent(def, eventTarget) {\n      var container = this.instance.getContainer();\n      var parent = findParent(eventTarget, SELECTOR_MANAGED_ELEMENT, container, true);\n      if (def.parentSelector != null) {\n        var child = findParent(eventTarget, def.parentSelector, container, true);\n        if (child != null) {\n          parent = findParent(child.parentNode, SELECTOR_MANAGED_ELEMENT, container, false);\n        }\n        return child || parent;\n      } else {\n        return parent;\n      }\n    }\n  }, {\n    key: \"_mousedownHandler\",\n    value: function _mousedownHandler(e) {\n      var sourceEl;\n      var sourceSelector;\n      if (e.which === 3 || e.button === 2) {\n        return;\n      }\n      var eventTarget = e.target || e.srcElement;\n      sourceSelector = this._getSourceDefinition(e);\n      if (sourceSelector != null) {\n        sourceEl = this._resolveDragParent(sourceSelector.def.def, eventTarget);\n        if (sourceEl == null || sourceEl.getAttribute(ATTRIBUTE_JTK_ENABLED) === FALSE$1) {\n          return;\n        }\n      }\n      if (sourceSelector) {\n        var sourceElement = e.currentTarget,\n            def;\n        if (eventTarget.getAttribute(ATTRIBUTE_JTK_ENABLED) !== FALSE$1) {\n          consume(e);\n          this._activeDefinition = sourceSelector;\n          def = sourceSelector.def.def;\n          if (def.canAcceptNewConnection != null && !def.canAcceptNewConnection(sourceEl, e)) {\n            return false;\n          }\n          var elxy = getPositionOnElement(e, sourceEl, this.instance.currentZoom);\n          var tempEndpointParams = {\n            element: sourceEl\n          };\n          extend(tempEndpointParams, def);\n          tempEndpointParams.isTemporarySource = true;\n          if (def.scope) {\n            tempEndpointParams.scope = def.scope;\n          } else {\n            var scopeFromElement = eventTarget.getAttribute(ATTRIBUTE_JTK_SCOPE);\n            if (scopeFromElement != null) {\n              tempEndpointParams.scope = scopeFromElement;\n            }\n          }\n          var extractedParameters = def.parameterExtractor ? def.parameterExtractor(sourceEl, eventTarget, e) : {};\n          tempEndpointParams = merge(tempEndpointParams, extractedParameters);\n          if (tempEndpointParams.maxConnections != null && tempEndpointParams.maxConnections >= 0) {\n            var sourceCount = this.instance.select({\n              source: sourceEl\n            }).length;\n            if (sourceCount >= tempEndpointParams.maxConnections) {\n              consume(e);\n              if (def.onMaxConnections) {\n                def.onMaxConnections({\n                  element: sourceEl,\n                  maxConnections: tempEndpointParams.maxConnections\n                }, e);\n              }\n              e.stopImmediatePropagation && e.stopImmediatePropagation();\n              return false;\n            }\n          }\n          if (def.anchorPositionFinder) {\n            var maybeAnchorSpec = def.anchorPositionFinder(sourceEl, elxy, def, e);\n            if (maybeAnchorSpec != null) {\n              tempEndpointParams.anchor = maybeAnchorSpec;\n            }\n          }\n          this._originalAnchorSpec = tempEndpointParams.anchor || (this.instance.areDefaultAnchorsSet() ? this.instance.defaults.anchors[0] : this.instance.defaults.anchor);\n          var _originalAnchor = this.instance.router.prepareAnchor(this._originalAnchorSpec);\n          var anchorSpecToUse = [elxy.x, elxy.y, 0, 0];\n          if (_originalAnchor.locations.length > 0) {\n            anchorSpecToUse[2] = _originalAnchor.locations[0].ox;\n            anchorSpecToUse[3] = _originalAnchor.locations[0].oy;\n          } else if (_originalAnchor.isContinuous) {\n            var dx = elxy.x < 0.5 ? elxy.x : 1 - elxy.x;\n            var dy = elxy.y < 0.5 ? elxy.y : 1 - elxy.y;\n            anchorSpecToUse[2] = dx < dy ? elxy.x < 0.5 ? -1 : 1 : 0;\n            anchorSpecToUse[3] = dy < dx ? elxy.y < 0.5 ? -1 : 1 : 0;\n          }\n          tempEndpointParams.anchor = anchorSpecToUse;\n          tempEndpointParams.deleteOnEmpty = true;\n          this.ep = this.instance._internal_newEndpoint(tempEndpointParams);\n          var payload = {};\n          if (def.extract) {\n            for (var att in def.extract) {\n              var v = eventTarget.getAttribute(att);\n              if (v) {\n                payload[def.extract[att]] = v;\n              }\n            }\n            this.ep.mergeParameters(payload);\n          }\n          if (tempEndpointParams.uniqueEndpoint) {\n            var elementId = this.ep.elementId;\n            var existingUniqueEndpoint = this.instance.getManagedData(elementId, SOURCE_SELECTOR_UNIQUE_ENDPOINT_DATA, sourceSelector.id);\n            if (existingUniqueEndpoint == null) {\n              this.instance.setManagedData(elementId, SOURCE_SELECTOR_UNIQUE_ENDPOINT_DATA, sourceSelector.id, this.ep);\n              this.ep.deleteOnEmpty = false;\n            } else {\n              this.ep.finalEndpoint = existingUniqueEndpoint;\n            }\n          }\n          sourceElement._jsPlumbOrphanedEndpoints = sourceElement._jsPlumbOrphanedEndpoints || [];\n          sourceElement._jsPlumbOrphanedEndpoints.push(this.ep);\n          this.instance.trigger(this.ep.endpoint.canvas, EVENT_MOUSEDOWN, e, payload);\n        }\n      }\n    }\n  }, {\n    key: \"_mouseupHandler\",\n    value: function _mouseupHandler(e) {\n      var el = e.currentTarget || e.srcElement;\n      if (el._jsPlumbOrphanedEndpoints) {\n        each(el._jsPlumbOrphanedEndpoints, this.instance._maybePruneEndpoint.bind(this.instance));\n        el._jsPlumbOrphanedEndpoints.length = 0;\n      }\n      this._activeDefinition = null;\n    }\n  }, {\n    key: \"onDragInit\",\n    value: function onDragInit(el) {\n      var ipco = getElementPosition(el, this.instance),\n          ips = getElementSize(el, this.instance);\n      this._makeDraggablePlaceholder(ipco, ips);\n      this.placeholderInfo.element.jtk = el.jtk;\n      return this.placeholderInfo.element;\n    }\n  }, {\n    key: \"onDragAbort\",\n    value: function onDragAbort(el) {\n      this._cleanupDraggablePlaceholder();\n    }\n  }, {\n    key: \"_makeDraggablePlaceholder\",\n    value: function _makeDraggablePlaceholder(ipco, ips) {\n      this.placeholderInfo = this.placeholderInfo || {};\n      var n = createElement(ELEMENT_DIV, {\n        position: \"absolute\"\n      });\n      this.instance._appendElementToContainer(n);\n      var id = this.instance.getId(n);\n      this.instance.setPosition(n, ipco);\n      n.style.width = ips.w + \"px\";\n      n.style.height = ips.h + \"px\";\n      this.instance.manage(n);\n      this.placeholderInfo.id = id;\n      this.placeholderInfo.element = n;\n      return n;\n    }\n  }, {\n    key: \"_cleanupDraggablePlaceholder\",\n    value: function _cleanupDraggablePlaceholder() {\n      if (this.placeholderInfo.element) {\n        this.instance.unmanage(this.placeholderInfo.element, true);\n        delete this.placeholderInfo.element;\n        delete this.placeholderInfo.id;\n      }\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      var c = this.instance.getContainer();\n      this.instance.off(c, EVENT_MOUSEUP, this.mouseupHandler);\n      this.instance.off(c, EVENT_MOUSEDOWN, this.mousedownHandler);\n    }\n  }, {\n    key: \"init\",\n    value: function init(drag) {}\n  }, {\n    key: \"startNewConnectionDrag\",\n    value: function startNewConnectionDrag(scope, data) {\n      this.jpc = this.instance._newConnection({\n        sourceEndpoint: this.ep,\n        targetEndpoint: this.floatingEndpoint,\n        source: this.ep.element,\n        target: this.placeholderInfo.element,\n        paintStyle: this.ep.connectorStyle,\n        hoverPaintStyle: this.ep.connectorHoverStyle,\n        connector: this.ep.connector,\n        overlays: this.ep.connectorOverlays,\n        type: this.ep.edgeType,\n        cssClass: this.ep.connectorClass,\n        hoverClass: this.ep.connectorHoverClass,\n        scope: scope,\n        data: data\n      });\n      this.jpc.pending = true;\n      this.jpc.addClass(this.instance.draggingClass);\n      this.ep.addClass(this.instance.draggingClass);\n      this.instance.fire(EVENT_CONNECTION_DRAG, this.jpc);\n    }\n  }, {\n    key: \"startExistingConnectionDrag\",\n    value: function startExistingConnectionDrag() {\n      this.existingJpc = true;\n      this.instance.setHover(this.jpc, false);\n      var anchorIdx = this.jpc.endpoints[0].id === this.ep.id ? 0 : 1;\n      this.ep.detachFromConnection(this.jpc, null, true);\n      this.floatingEndpoint.addConnection(this.jpc);\n      this.instance.fire(EVENT_CONNECTION_DRAG, this.jpc);\n      this.instance.sourceOrTargetChanged(this.jpc.endpoints[anchorIdx].elementId, this.placeholderInfo.id, this.jpc, this.placeholderInfo.element, anchorIdx);\n      this.jpc.suspendedEndpoint = this.jpc.endpoints[anchorIdx];\n      this.jpc.suspendedElement = this.jpc.endpoints[anchorIdx].element;\n      this.jpc.suspendedElementId = this.jpc.endpoints[anchorIdx].elementId;\n      this.jpc.suspendedElementType = anchorIdx === 0 ? SOURCE : TARGET;\n      this.instance.setHover(this.jpc.suspendedEndpoint, false);\n      this.floatingEndpoint.referenceEndpoint = this.jpc.suspendedEndpoint;\n      this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters);\n      this.jpc.endpoints[anchorIdx] = this.floatingEndpoint;\n      this.jpc.addClass(this.instance.draggingClass);\n      this.floatingId = this.placeholderInfo.id;\n      this.floatingIndex = anchorIdx;\n      this.instance._refreshEndpoint(this.ep);\n    }\n  }, {\n    key: \"_shouldStartDrag\",\n    value: function _shouldStartDrag() {\n      var _continue = true;\n      if (!this.ep.enabled) {\n        _continue = false;\n      }\n      if (this.jpc == null && !this.ep.isSource && !this.ep.isTemporarySource) {\n        _continue = false;\n      }\n      if (this.ep.isSource && this.ep.isFull() && !(this.jpc != null && this.ep.dragAllowedWhenFull)) {\n        _continue = false;\n      }\n      if (this.jpc != null && !this.jpc.isDetachable(this.ep)) {\n        if (this.ep.isFull()) {\n          _continue = false;\n        } else {\n          this.jpc = null;\n        }\n      }\n      var payload = {};\n      var beforeDrag = this.instance.checkCondition(this.jpc == null ? INTERCEPT_BEFORE_DRAG : INTERCEPT_BEFORE_START_DETACH, {\n        endpoint: this.ep,\n        source: this.ep.element,\n        sourceId: this.ep.elementId,\n        connection: this.jpc\n      });\n      if (beforeDrag === false) {\n        _continue = false;\n      }\n      else if (_typeof(beforeDrag) === \"object\") {\n        payload = beforeDrag;\n        extend(payload, this.payload || {});\n      } else {\n        payload = this.payload || {};\n      }\n      return [_continue, payload];\n    }\n  }, {\n    key: \"_createFloatingEndpoint\",\n    value: function _createFloatingEndpoint(canvasElement) {\n      var endpointToFloat = this.ep.endpoint;\n      if (this.ep.edgeType != null) {\n        var aae = this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType);\n        endpointToFloat = aae.endpoints[1];\n      }\n      this.floatingEndpoint = _makeFloatingEndpoint(this.ep, endpointToFloat, canvasElement, this.placeholderInfo.element, this.placeholderInfo.id, this.instance);\n      this.floatingAnchor = this.floatingEndpoint._anchor;\n      this.floatingEndpoint.deleteOnEmpty = true;\n      this.floatingElement = this.floatingEndpoint.endpoint.canvas;\n      this.floatingId = this.instance.getId(this.floatingElement);\n    }\n  }, {\n    key: \"_populateTargets\",\n    value: function _populateTargets(canvasElement, event) {\n      var _this = this;\n      var isSourceDrag = this.jpc && this.jpc.endpoints[0] === this.ep;\n      var boundingRect;\n      var matchingEndpoints = this.instance.getContainer().querySelectorAll([\".\", CLASS_ENDPOINT, \"[\", ATTRIBUTE_SCOPE_PREFIX, this.ep.scope, \"]:not(.\", CLASS_ENDPOINT_FLOATING, \")\"].join(\"\"));\n      forEach(matchingEndpoints, function (candidate) {\n        if ((_this.jpc != null || candidate !== canvasElement) && candidate !== _this.floatingElement && (_this.jpc != null || !candidate.jtk.endpoint.isFull())) {\n          if (isSourceDrag && candidate.jtk.endpoint.isSource || !isSourceDrag && candidate.jtk.endpoint.isTarget) {\n            var o = getElementPosition(candidate, _this.instance),\n                s = getElementSize(candidate, _this.instance);\n            boundingRect = {\n              x: o.x,\n              y: o.y,\n              w: s.w,\n              h: s.h\n            };\n            _this.endpointDropTargets.push({\n              el: candidate,\n              targetEl: candidate,\n              r: boundingRect,\n              endpoint: candidate.jtk.endpoint,\n              def: null\n            });\n            _this.instance.addClass(candidate, CLASS_DRAG_ACTIVE);\n          }\n        }\n      });\n      if (isSourceDrag) {\n        var sourceDef = getWithFunction(this.instance.sourceSelectors, function (sSel) {\n          return sSel.isEnabled() && (sSel.def.def.scope == null || sSel.def.def.scope === _this.ep.scope);\n        });\n        if (sourceDef != null) {\n          var targetZones = this._findTargetZones(sourceDef);\n          forEach(targetZones, function (el) {\n            if (el.getAttribute(ATTRIBUTE_JTK_ENABLED) !== FALSE$1) {\n              var scopeFromElement = el.getAttribute(ATTRIBUTE_JTK_SCOPE);\n              if (scopeFromElement != null && scopeFromElement !== _this.ep.scope) {\n                return;\n              }\n              var d = {\n                r: null,\n                el: el\n              };\n              d.targetEl = findParent(el, SELECTOR_MANAGED_ELEMENT, _this.instance.getContainer(), true);\n              var o = getElementPosition(d.el, _this.instance),\n                  s = getElementSize(d.el, _this.instance);\n              d.r = {\n                x: o.x,\n                y: o.y,\n                w: s.w,\n                h: s.h\n              };\n              if (sourceDef.def.def.rank != null) {\n                d.rank = sourceDef.def.def.rank;\n              }\n              d.def = sourceDef.def;\n              _this.endpointDropTargets.push(d);\n              _this.instance.addClass(d.targetEl, CLASS_DRAG_ACTIVE);\n            }\n          });\n        }\n      } else {\n        var targetDefs = getAllWithFunction(this.instance.targetSelectors, function (tSel) {\n          return tSel.isEnabled();\n        });\n        targetDefs.forEach(function (targetDef) {\n          var targetZones = _this._findTargetZones(targetDef);\n          forEach(targetZones, function (el) {\n            if (el.getAttribute(ATTRIBUTE_JTK_ENABLED) !== FALSE$1) {\n              var scopeFromElement = el.getAttribute(ATTRIBUTE_JTK_SCOPE);\n              if (scopeFromElement != null && scopeFromElement !== _this.ep.scope) {\n                return;\n              }\n              var d = {\n                r: null,\n                el: el\n              };\n              if (targetDef.def.def.parentSelector != null) {\n                d.targetEl = findParent(el, targetDef.def.def.parentSelector, _this.instance.getContainer(), true);\n              }\n              if (d.targetEl == null) {\n                d.targetEl = findParent(el, SELECTOR_MANAGED_ELEMENT, _this.instance.getContainer(), true);\n              }\n              if (targetDef.def.def.allowLoopback === false || _this._activeDefinition && _this._activeDefinition.def.def.allowLoopback === false) {\n                if (d.targetEl === _this.ep.element) {\n                  return;\n                }\n              }\n              if (targetDef.def.def.canAcceptNewConnection != null && !targetDef.def.def.canAcceptNewConnection(d.targetEl, event)) {\n                return;\n              }\n              var maxConnections = targetDef.def.def.maxConnections;\n              if (maxConnections != null && maxConnections !== -1) {\n                if (_this.instance.select({\n                  target: d.targetEl\n                }).length >= maxConnections) {\n                  return;\n                }\n              }\n              var o = getElementPosition(el, _this.instance),\n                  s = getElementSize(el, _this.instance);\n              d.r = {\n                x: o.x,\n                y: o.y,\n                w: s.w,\n                h: s.h\n              };\n              d.def = targetDef.def;\n              if (targetDef.def.def.rank != null) {\n                d.rank = targetDef.def.def.rank;\n              }\n              _this.endpointDropTargets.push(d);\n              _this.instance.addClass(d.targetEl, CLASS_DRAG_ACTIVE);\n            }\n          });\n        });\n      }\n      this.endpointDropTargets.sort(function (a, b) {\n        if (a.targetEl._isJsPlumbGroup && !b.targetEl._isJsPlumbGroup) {\n          return 1;\n        } else if (!a.targetEl._isJsPlumbGroup && b.targetEl._isJsPlumbGroup) {\n          return -1;\n        } else {\n          if (a.targetEl._isJsPlumbGroup && b.targetEl._isJsPlumbGroup) {\n            if (_this.instance.groupManager.isAncestor(a.targetEl._jsPlumbGroup, b.targetEl._jsPlumbGroup)) {\n              return -1;\n            } else if (_this.instance.groupManager.isAncestor(b.targetEl._jsPlumbGroup, a.targetEl._jsPlumbGroup)) {\n              return 1;\n            }\n          } else {\n            if (a.rank != null && b.rank != null) {\n              if (a.rank > b.rank) {\n                return -1;\n              } else if (a.rank < b.rank) {\n                return 1;\n              } else ;\n            } else {\n              return 0;\n            }\n          }\n        }\n      });\n    }\n  }, {\n    key: \"_findTargetZones\",\n    value: function _findTargetZones(dragSelector) {\n      var targetZonesSelector;\n      if (dragSelector.redrop === REDROP_POLICY_ANY) {\n        var t = this.instance.targetSelectors.map(function (s) {\n          return s.selector;\n        });\n        t.push.apply(t, _toConsumableArray(this.instance.sourceSelectors.map(function (s) {\n          return s.selector;\n        })));\n        t.push(SELECTOR_MANAGED_ELEMENT);\n        targetZonesSelector = t.join(\",\");\n      } else if (dragSelector.redrop === REDROP_POLICY_STRICT) {\n        targetZonesSelector = dragSelector.selector;\n      } else if (dragSelector.redrop === REDROP_POLICY_ANY_SOURCE) {\n        targetZonesSelector = this.instance.sourceSelectors.map(function (s) {\n          return s.selector;\n        }).join(\",\");\n      } else if (dragSelector.redrop === REDROP_POLICY_ANY_TARGET) {\n        targetZonesSelector = this.instance.targetSelectors.map(function (s) {\n          return s.selector;\n        }).join(\",\");\n      } else if (dragSelector.redrop === REDROP_POLICY_ANY_SOURCE_OR_TARGET) {\n        var _t = this.instance.targetSelectors.map(function (s) {\n          return s.selector;\n        });\n        _t.push.apply(_t, _toConsumableArray(this.instance.sourceSelectors.map(function (s) {\n          return s.selector;\n        })));\n        targetZonesSelector = _t.join(\",\");\n      }\n      return this.instance.getContainer().querySelectorAll(targetZonesSelector);\n    }\n  }, {\n    key: \"onStart\",\n    value: function onStart(p) {\n      this.endpointDropTargets.length = 0;\n      this.currentDropTarget = null;\n      this._stopped = false;\n      var dragEl = p.drag.getDragElement();\n      this.ep = dragEl.jtk.endpoint;\n      if (!this.ep) {\n        return false;\n      }\n      this.endpointRepresentation = this.ep.endpoint;\n      this.canvasElement = this.endpointRepresentation.canvas;\n      this.jpc = this.ep.connectorSelector();\n      var _this$_shouldStartDra = this._shouldStartDrag(),\n          _this$_shouldStartDra2 = _slicedToArray(_this$_shouldStartDra, 2),\n          _continue = _this$_shouldStartDra2[0],\n          payload = _this$_shouldStartDra2[1];\n      if (_continue === false) {\n        this._stopped = true;\n        return false;\n      }\n      this.instance.setHover(this.ep, false);\n      this.instance.isConnectionBeingDragged = true;\n      if (this.jpc && !this.ep.isFull() && this.ep.isSource) {\n        this.jpc = null;\n      }\n      this._createFloatingEndpoint(this.canvasElement);\n      this._populateTargets(this.canvasElement, p.e);\n      if (this.jpc == null) {\n        this.startNewConnectionDrag(this.ep.scope, payload);\n      } else {\n        this.startExistingConnectionDrag();\n      }\n      this._registerFloatingConnection(this.placeholderInfo, this.jpc);\n      this.instance.currentlyDragging = true;\n    }\n  }, {\n    key: \"onBeforeStart\",\n    value: function onBeforeStart(beforeStartParams) {\n      this.payload = beforeStartParams.e.payload || {};\n    }\n  }, {\n    key: \"onDrag\",\n    value: function onDrag(params) {\n      if (this._stopped) {\n        return true;\n      }\n      if (this.placeholderInfo.element) {\n        var floatingElementSize = getElementSize(this.floatingElement, this.instance);\n        this.instance.setElementPosition(this.placeholderInfo.element, params.pos.x, params.pos.y);\n        var boundingRect = {\n          x: params.pos.x,\n          y: params.pos.y,\n          w: floatingElementSize.w,\n          h: floatingElementSize.h\n        },\n            newDropTarget,\n            idx,\n            _cont;\n        for (var i = 0; i < this.endpointDropTargets.length; i++) {\n          if (intersects(boundingRect, this.endpointDropTargets[i].r)) {\n            newDropTarget = this.endpointDropTargets[i];\n            break;\n          }\n        }\n        if (newDropTarget !== this.currentDropTarget && this.currentDropTarget != null) {\n          idx = this._getFloatingAnchorIndex();\n          this.instance.removeClass(this.currentDropTarget.el, CLASS_DRAG_HOVER);\n          if (this.currentDropTarget.endpoint) {\n            this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass);\n            this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass);\n          }\n          this.floatingAnchor.out();\n        }\n        if (newDropTarget != null) {\n          this.instance.addClass(newDropTarget.el, CLASS_DRAG_HOVER);\n          idx = this._getFloatingAnchorIndex();\n          if (newDropTarget.endpoint != null) {\n            _cont = newDropTarget.endpoint.isSource && idx === 0 || newDropTarget.endpoint.isTarget && idx !== 0 || this.jpc.suspendedEndpoint && newDropTarget.endpoint.referenceEndpoint && newDropTarget.endpoint.referenceEndpoint.id === this.jpc.suspendedEndpoint.id;\n            if (_cont) {\n              var bb = this.instance.checkCondition(CHECK_DROP_ALLOWED, {\n                sourceEndpoint: this.jpc.endpoints[idx],\n                targetEndpoint: newDropTarget.endpoint.endpoint,\n                connection: this.jpc\n              });\n              if (bb) {\n                newDropTarget.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass);\n                newDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass);\n              } else {\n                newDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass);\n                newDropTarget.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass);\n              }\n              this.floatingAnchor.over(newDropTarget.endpoint);\n              this.instance._paintConnection(this.jpc);\n            } else {\n              newDropTarget = null;\n            }\n          }\n        }\n        this.currentDropTarget = newDropTarget;\n      }\n    }\n  }, {\n    key: \"_maybeCleanup\",\n    value: function _maybeCleanup(ep) {\n      if (ep._mtNew && ep.connections.length === 0) {\n        this.instance.deleteEndpoint(ep);\n      } else {\n        delete ep._mtNew;\n      }\n    }\n  }, {\n    key: \"_reattachOrDiscard\",\n    value: function _reattachOrDiscard(originalEvent) {\n      var existingConnection = this.jpc.suspendedEndpoint != null;\n      var idx = this._getFloatingAnchorIndex();\n      if (existingConnection && this._shouldReattach()) {\n        if (idx === 0) {\n          this.jpc.source = this.jpc.suspendedElement;\n          this.jpc.sourceId = this.jpc.suspendedElementId;\n        } else {\n          this.jpc.target = this.jpc.suspendedElement;\n          this.jpc.targetId = this.jpc.suspendedElementId;\n        }\n        this._doForceReattach(idx);\n        return true;\n      } else {\n        this._discard(idx, originalEvent);\n        return false;\n      }\n    }\n  }, {\n    key: \"onStop\",\n    value: function onStop(p) {\n      var _this2 = this;\n      var originalEvent = p.e;\n      this.instance.isConnectionBeingDragged = false;\n      this.instance.currentlyDragging = false;\n      var classesToRemove = classList(CLASS_DRAG_HOVER, CLASS_DRAG_ACTIVE);\n      var matchingSelectors = this.instance.getContainer().querySelectorAll(SELECTOR_DRAG_ACTIVE_OR_HOVER);\n      forEach(matchingSelectors, function (el) {\n        _this2.instance.removeClass(el, classesToRemove);\n      });\n      if (this.jpc && this.jpc.endpoints != null) {\n        var existingConnection = this.jpc.suspendedEndpoint != null;\n        var idx = this._getFloatingAnchorIndex();\n        var suspendedEndpoint = this.jpc.suspendedEndpoint;\n        var dropEndpoint;\n        if (this.currentDropTarget != null) {\n          dropEndpoint = this._getDropEndpoint(p, this.jpc);\n          if (dropEndpoint == null) {\n            this._reattachOrDiscard(p.e);\n          } else {\n            if (suspendedEndpoint && suspendedEndpoint.id === dropEndpoint.id) {\n              this._doForceReattach(idx);\n            } else {\n              if (!dropEndpoint.enabled) {\n                this._reattachOrDiscard(p.e);\n              } else if (dropEndpoint.isFull()) {\n                dropEndpoint.fire(EVENT_MAX_CONNECTIONS, {\n                  endpoint: this,\n                  connection: this.jpc,\n                  maxConnections: this.instance.defaults.maxConnections\n                }, originalEvent);\n                this._reattachOrDiscard(p.e);\n              } else {\n                if (idx === 0) {\n                  this.jpc.source = dropEndpoint.element;\n                  this.jpc.sourceId = dropEndpoint.elementId;\n                } else {\n                  this.jpc.target = dropEndpoint.element;\n                  this.jpc.targetId = dropEndpoint.elementId;\n                }\n                var _doContinue = true;\n                if (existingConnection && this.jpc.suspendedEndpoint.id !== dropEndpoint.id) {\n                  if (!this.jpc.isDetachAllowed(this.jpc) || !this.jpc.endpoints[idx].isDetachAllowed(this.jpc) || !this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc) || !this.instance.checkCondition(\"beforeDetach\", this.jpc)) {\n                    _doContinue = false;\n                  }\n                }\n                _doContinue = _doContinue && dropEndpoint.isDropAllowed(this.jpc.sourceId, this.jpc.targetId, this.jpc.scope, this.jpc, dropEndpoint);\n                if (_doContinue) {\n                  this._drop(dropEndpoint, idx, originalEvent, _doContinue);\n                } else {\n                  this._reattachOrDiscard(p.e);\n                }\n              }\n            }\n          }\n        } else {\n          this._reattachOrDiscard(p.e);\n        }\n        this.instance._refreshEndpoint(this.ep);\n        this.ep.removeClass(this.instance.draggingClass);\n        this._cleanupDraggablePlaceholder();\n        this.jpc.removeClass(this.instance.draggingClass);\n        delete this.jpc.suspendedEndpoint;\n        delete this.jpc.suspendedElement;\n        delete this.jpc.suspendedElementType;\n        delete this.jpc.suspendedElementId;\n        delete this.jpc.suspendedIndex;\n        delete this.floatingId;\n        delete this.floatingIndex;\n        delete this.floatingElement;\n        delete this.floatingEndpoint;\n        delete this.floatingAnchor;\n        delete this.jpc.pending;\n        if (dropEndpoint != null) {\n          this._maybeCleanup(dropEndpoint);\n        }\n      }\n    }\n  }, {\n    key: \"_getSourceDefinition\",\n    value: function _getSourceDefinition(evt) {\n      var selector;\n      var container = this.instance.getContainer();\n      for (var i = 0; i < this.instance.sourceSelectors.length; i++) {\n        selector = this.instance.sourceSelectors[i];\n        if (selector.isEnabled()) {\n          var r = selectorFilter(evt, container, selector.selector, this.instance, selector.exclude);\n          if (r !== false) {\n            return selector;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"_getDropEndpoint\",\n    value: function _getDropEndpoint(p, jpc) {\n      var dropEndpoint;\n      if (this.currentDropTarget.endpoint == null) {\n        var targetDefinition = this.currentDropTarget.def;\n        var eventTarget = p.e.target || p.e.srcElement;\n        if (targetDefinition == null) {\n          return null;\n        }\n        var targetElement = this.currentDropTarget.targetEl;\n        var elxy = getPositionOnElement(p.e, targetElement, this.instance.currentZoom);\n        var eps = this.instance._deriveEndpointAndAnchorSpec(jpc.getType().join(\" \"), true);\n        var pp = eps.endpoints ? extend(p, {\n          endpoint: targetDefinition.def.endpoint || eps.endpoints[1],\n          cssClass: targetDefinition.def.cssClass || \"\",\n          source: targetDefinition.def.source === true,\n          target: targetDefinition.def.target === true\n        }) : p;\n        var anchorsToUse = this.instance.validAnchorsSpec(eps.anchors) ? eps.anchors : this.instance.areDefaultAnchorsSet() ? this.instance.defaults.anchors : null;\n        var anchorFromDef = targetDefinition.def.anchor;\n        var anchorFromPositionFinder = targetDefinition.def.anchorPositionFinder ? targetDefinition.def.anchorPositionFinder(targetElement, elxy, targetDefinition.def, p.e) : null;\n        var dropAnchor = anchorFromPositionFinder != null ? anchorFromPositionFinder : anchorFromDef != null ? anchorFromDef : anchorsToUse != null && anchorsToUse[1] != null ? anchorsToUse[1] : null;\n        if (dropAnchor != null) {\n          pp = extend(pp, {\n            anchor: dropAnchor\n          });\n        }\n        if (targetDefinition.def.portId != null) {\n          pp.portId = targetDefinition.def.portId;\n        }\n        var extractedParameters = targetDefinition.def.parameterExtractor ? targetDefinition.def.parameterExtractor(this.currentDropTarget.el, eventTarget, p.e) : {};\n        pp = merge(pp, extractedParameters);\n        pp.element = targetElement;\n        dropEndpoint = this.instance._internal_newEndpoint(pp);\n        dropEndpoint._mtNew = true;\n        dropEndpoint.deleteOnEmpty = true;\n        if (targetDefinition.def.parameters) {\n          dropEndpoint.mergeParameters(targetDefinition.def.parameters);\n        }\n        if (targetDefinition.def.extract) {\n          var tpayload = {};\n          for (var att in targetDefinition.def.extract) {\n            var v = this.currentDropTarget.el.getAttribute(att);\n            if (v) {\n              tpayload[targetDefinition.def.extract[att]] = v;\n            }\n          }\n          dropEndpoint.mergeParameters(tpayload);\n        }\n      } else {\n        dropEndpoint = this.currentDropTarget.endpoint;\n      }\n      if (dropEndpoint) {\n        dropEndpoint.removeClass(this.instance.endpointDropAllowedClass);\n        dropEndpoint.removeClass(this.instance.endpointDropForbiddenClass);\n      }\n      return dropEndpoint;\n    }\n  }, {\n    key: \"_doForceReattach\",\n    value: function _doForceReattach(idx) {\n      this.floatingEndpoint.detachFromConnection(this.jpc, null, true);\n      this.jpc.endpoints[idx] = this.jpc.suspendedEndpoint;\n      this.instance.setHover(this.jpc, false);\n      this.jpc._forceDetach = true;\n      this.jpc.suspendedEndpoint.addConnection(this.jpc);\n      this.instance.sourceOrTargetChanged(this.floatingId, this.jpc.suspendedEndpoint.elementId, this.jpc, this.jpc.suspendedEndpoint.element, idx);\n      this.instance.deleteEndpoint(this.floatingEndpoint);\n      this.instance.repaint(this.jpc.source);\n      delete this.jpc._forceDetach;\n    }\n  }, {\n    key: \"_shouldReattach\",\n    value: function _shouldReattach() {\n      if (this.jpc.isReattach() || this.jpc._forceReattach) {\n        return true;\n      } else {\n        var suspendedEndpoint = this.jpc.suspendedEndpoint,\n            otherEndpointIdx = this.jpc.suspendedElementType == SOURCE ? 1 : 0,\n            otherEndpoint = this.jpc.endpoints[otherEndpointIdx];\n        return !functionChain(true, false, [[suspendedEndpoint, IS_DETACH_ALLOWED, [this.jpc]], [otherEndpoint, IS_DETACH_ALLOWED, [this.jpc]], [this.jpc, IS_DETACH_ALLOWED, [this.jpc]], [this.instance, CHECK_CONDITION, [INTERCEPT_BEFORE_DETACH, this.jpc]]]);\n      }\n    }\n  }, {\n    key: \"_discard\",\n    value: function _discard(idx, originalEvent) {\n      if (this.jpc.pending) {\n        this.instance.fire(EVENT_CONNECTION_ABORT, this.jpc, originalEvent);\n      } else {\n        if (idx === 0) {\n          this.jpc.source = this.jpc.suspendedEndpoint.element;\n          this.jpc.sourceId = this.jpc.suspendedEndpoint.elementId;\n        } else {\n          this.jpc.target = this.jpc.suspendedEndpoint.element;\n          this.jpc.targetId = this.jpc.suspendedEndpoint.elementId;\n        }\n        this.jpc.endpoints[idx] = this.jpc.suspendedEndpoint;\n      }\n      if (this.floatingEndpoint) {\n        this.floatingEndpoint.detachFromConnection(this.jpc);\n      }\n      this.instance.deleteConnection(this.jpc, {\n        originalEvent: originalEvent,\n        force: true\n      });\n    }\n  }, {\n    key: \"_drop\",\n    value: function _drop(dropEndpoint, idx, originalEvent, optionalData) {\n      this.jpc.endpoints[idx].detachFromConnection(this.jpc);\n      if (this.jpc.suspendedEndpoint) {\n        this.jpc.suspendedEndpoint.detachFromConnection(this.jpc);\n      }\n      this.jpc.endpoints[idx] = dropEndpoint;\n      dropEndpoint.addConnection(this.jpc);\n      if (this.jpc.suspendedEndpoint) {\n        var suspendedElementId = this.jpc.suspendedEndpoint.elementId;\n        this.instance.fireMoveEvent({\n          index: idx,\n          originalSourceId: idx === 0 ? suspendedElementId : this.jpc.sourceId,\n          newSourceId: idx === 0 ? dropEndpoint.elementId : this.jpc.sourceId,\n          originalTargetId: idx === 1 ? suspendedElementId : this.jpc.targetId,\n          newTargetId: idx === 1 ? dropEndpoint.elementId : this.jpc.targetId,\n          originalEndpoint: this.jpc.suspendedEndpoint,\n          connection: this.jpc,\n          newEndpoint: dropEndpoint\n        }, originalEvent);\n      }\n      if (idx === 1) {\n        this.instance.sourceOrTargetChanged(this.floatingId, this.jpc.targetId, this.jpc, this.jpc.target, 1);\n      } else {\n        this.instance.sourceOrTargetChanged(this.floatingId, this.jpc.sourceId, this.jpc, this.jpc.source, 0);\n      }\n      if (this.jpc.endpoints[0].finalEndpoint) {\n        var _toDelete = this.jpc.endpoints[0];\n        _toDelete.detachFromConnection(this.jpc);\n        this.jpc.endpoints[0] = this.jpc.endpoints[0].finalEndpoint;\n        this.jpc.endpoints[0].addConnection(this.jpc);\n      }\n      if (isObject(optionalData)) {\n        this.jpc.mergeData(optionalData);\n      }\n      if (this._originalAnchorSpec) {\n        this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec);\n        this._originalAnchorSpec = null;\n      }\n      this.instance._finaliseConnection(this.jpc, null, originalEvent);\n      this.instance.setHover(this.jpc, false);\n      this.instance.revalidate(this.jpc.endpoints[0].element);\n    }\n  }, {\n    key: \"_registerFloatingConnection\",\n    value: function _registerFloatingConnection(info, conn) {\n      this.floatingConnections[info.id] = conn;\n    }\n  }, {\n    key: \"_getFloatingAnchorIndex\",\n    value: function _getFloatingAnchorIndex() {\n      return this.floatingIndex == null ? 1 : this.floatingIndex;\n    }\n  }]);\n  return EndpointDragHandler;\n}();\n\nvar GroupDragHandler = function (_ElementDragHandler) {\n  _inherits(GroupDragHandler, _ElementDragHandler);\n  var _super = _createSuper(GroupDragHandler);\n  function GroupDragHandler(instance, dragSelection) {\n    var _this;\n    _classCallCheck(this, GroupDragHandler);\n    _this = _super.call(this, instance, dragSelection);\n    _this.instance = instance;\n    _this.dragSelection = dragSelection;\n    _defineProperty(_assertThisInitialized(_this), \"selector\", [\">\", SELECTOR_GROUP, SELECTOR_MANAGED_ELEMENT].join(\" \"));\n    _defineProperty(_assertThisInitialized(_this), \"doRevalidate\", void 0);\n    _this.doRevalidate = _this._revalidate.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(GroupDragHandler, [{\n    key: \"reset\",\n    value: function reset() {\n      this.drag.off(EVENT_REVERT, this.doRevalidate);\n    }\n  }, {\n    key: \"_revalidate\",\n    value: function _revalidate(el) {\n      this.instance.revalidate(el);\n    }\n  }, {\n    key: \"init\",\n    value: function init(drag) {\n      this.drag = drag;\n      drag.on(EVENT_REVERT, this.doRevalidate);\n    }\n  }, {\n    key: \"useGhostProxy\",\n    value: function useGhostProxy(container, dragEl) {\n      var group = dragEl._jsPlumbParentGroup;\n      return group == null ? false : group.ghost === true;\n    }\n  }, {\n    key: \"makeGhostProxy\",\n    value: function makeGhostProxy(el) {\n      var jel = el;\n      var newEl = jel.cloneNode(true);\n      newEl._jsPlumbParentGroup = jel._jsPlumbParentGroup;\n      return newEl;\n    }\n  }]);\n  return GroupDragHandler;\n}(ElementDragHandler);\n\nvar HTMLElementOverlay = function () {\n  function HTMLElementOverlay(instance, overlay) {\n    _classCallCheck(this, HTMLElementOverlay);\n    this.instance = instance;\n    this.overlay = overlay;\n    _defineProperty(this, \"htmlElementOverlay\", void 0);\n    this.htmlElementOverlay = overlay;\n  }\n  _createClass(HTMLElementOverlay, null, [{\n    key: \"getElement\",\n    value: function getElement(o, component, elementCreator) {\n      if (o.canvas == null) {\n        if (elementCreator && component) {\n          o.canvas = elementCreator(component);\n          var cls = o.instance.overlayClass + \" \" + (o.cssClass ? o.cssClass : \"\");\n          o.instance.addClass(o.canvas, cls);\n        } else {\n          o.canvas = createElement(ELEMENT_DIV, {}, o.instance.overlayClass + \" \" + (o.cssClass ? o.cssClass : \"\"));\n        }\n        o.instance.setAttribute(o.canvas, \"jtk-overlay-id\", o.id);\n        for (var att in o.attributes) {\n          o.instance.setAttribute(o.canvas, att, o.attributes[att]);\n        }\n        o.canvas.style.position = ABSOLUTE;\n        o.instance._appendElement(o.canvas, o.instance.getContainer());\n        o.instance.getId(o.canvas);\n        var ts = \"translate(-50%, -50%)\";\n        o.canvas.style.webkitTransform = ts;\n        o.canvas.style.mozTransform = ts;\n        o.canvas.style.msTransform = ts;\n        o.canvas.style.oTransform = ts;\n        o.canvas.style.transform = ts;\n        if (!o.isVisible()) {\n          o.canvas.style.display = NONE;\n        }\n        o.canvas.jtk = {\n          overlay: o\n        };\n      }\n      return o.canvas;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(o) {\n      o.canvas && o.canvas.parentNode && o.canvas.parentNode.removeChild(o.canvas);\n      delete o.canvas;\n      delete o.cachedDimensions;\n    }\n  }, {\n    key: \"_getDimensions\",\n    value: function _getDimensions(o, forceRefresh) {\n      if (o.cachedDimensions == null || forceRefresh) {\n        o.cachedDimensions = {\n          w: 1,\n          h: 1\n        };\n      }\n      return o.cachedDimensions;\n    }\n  }]);\n  return HTMLElementOverlay;\n}();\n\nfunction ensureSVGOverlayPath(o) {\n  if (o.path == null) {\n    var atts = extend({\n      \"jtk-overlay-id\": o.id\n    }, o.attributes);\n    o.path = _node(ELEMENT_PATH, atts);\n    var cls = o.instance.overlayClass + \" \" + (o.cssClass ? o.cssClass : \"\");\n    o.instance.addClass(o.path, cls);\n    o.path.jtk = {\n      overlay: o\n    };\n  }\n  var parent = o.path.parentNode;\n  if (parent == null) {\n    if (o.component instanceof Connection) {\n      var connector = o.component.connector;\n      parent = connector != null ? connector.canvas : null;\n    } else if (o.component instanceof Endpoint) {\n      var endpoint = o.component.endpoint;\n      parent = endpoint != null ? endpoint.canvas : endpoint;\n    }\n    if (parent != null) {\n      _appendAtIndex(parent, o.path, 1);\n    }\n  }\n  return o.path;\n}\nfunction paintSVGOverlay(o, path, params, extents) {\n  ensureSVGOverlayPath(o);\n  var offset = [0, 0];\n  if (extents.xmin < 0) {\n    offset[0] = -extents.xmin;\n  }\n  if (extents.ymin < 0) {\n    offset[1] = -extents.ymin;\n  }\n  var a = {\n    \"d\": path,\n    stroke: params.stroke ? params.stroke : null,\n    fill: params.fill ? params.fill : null,\n    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\n    \"pointer-events\": \"visibleStroke\"\n  };\n  _attr(o.path, a);\n}\nfunction destroySVGOverlay(o, force) {\n  var _o = o;\n  if (_o.path != null && _o.path.parentNode != null) {\n    _o.path.parentNode.removeChild(_o.path);\n  }\n  if (_o.bgPath != null && _o.bgPath.parentNode != null) {\n    _o.bgPath.parentNode.removeChild(_o.bgPath);\n  }\n  delete _o.path;\n  delete _o.bgPath;\n}\n(function (_Overlay) {\n  _inherits(SVGElementOverlay, _Overlay);\n  var _super = _createSuper(SVGElementOverlay);\n  function SVGElementOverlay() {\n    var _this;\n    _classCallCheck(this, SVGElementOverlay);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"path\", void 0);\n    return _this;\n  }\n  return SVGElementOverlay;\n})(Overlay);\n\nvar SvgComponent = function () {\n  function SvgComponent() {\n    _classCallCheck(this, SvgComponent);\n  }\n  _createClass(SvgComponent, null, [{\n    key: \"paint\",\n    value: function paint(connector, instance, paintStyle, extents) {\n      if (paintStyle != null) {\n        var xy = [connector.x, connector.y],\n            wh = [connector.w, connector.h];\n        if (extents != null) {\n          if (extents.xmin < 0) {\n            xy[0] += extents.xmin;\n          }\n          if (extents.ymin < 0) {\n            xy[1] += extents.ymin;\n          }\n          wh[0] = extents.xmax + (extents.xmin < 0 ? -extents.xmin : 0);\n          wh[1] = extents.ymax + (extents.ymin < 0 ? -extents.ymin : 0);\n        }\n        if (isFinite(wh[0]) && isFinite(wh[1])) {\n          var attrs = {\n            \"width\": \"\" + (wh[0] || 0),\n            \"height\": \"\" + (wh[1] || 0)\n          };\n          if (instance.containerType === ElementTypes.HTML) {\n            _attr(connector.canvas, extend(attrs, {\n              style: _pos([xy[0], xy[1]])\n            }));\n          } else {\n            _attr(connector.canvas, extend(attrs, {\n              x: xy[0],\n              y: xy[1]\n            }));\n          }\n        }\n      }\n    }\n  }]);\n  return SvgComponent;\n}();\n\nfunction paintSvgConnector(instance, connector, paintStyle, extents) {\n  getConnectorElement(instance, connector);\n  SvgComponent.paint(connector, instance, paintStyle, extents);\n  var p = \"\",\n      offset = [0, 0];\n  if (extents.xmin < 0) {\n    offset[0] = -extents.xmin;\n  }\n  if (extents.ymin < 0) {\n    offset[1] = -extents.ymin;\n  }\n  if (connector.segments.length > 0) {\n    p = instance.getPathData(connector);\n    var a = {\n      d: p,\n      transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\n      \"pointer-events\": \"visibleStroke\"\n    },\n        outlineStyle = null;\n    if (paintStyle.outlineStroke) {\n      var outlineWidth = paintStyle.outlineWidth || 1,\n          outlineStrokeWidth = paintStyle.strokeWidth + 2 * outlineWidth;\n      outlineStyle = extend({}, paintStyle);\n      outlineStyle.stroke = paintStyle.outlineStroke;\n      outlineStyle.strokeWidth = outlineStrokeWidth;\n      if (connector.bgPath == null) {\n        connector.bgPath = _node(ELEMENT_PATH, a);\n        instance.addClass(connector.bgPath, instance.connectorOutlineClass);\n        _appendAtIndex(connector.canvas, connector.bgPath, 0);\n      } else {\n        _attr(connector.bgPath, a);\n      }\n      _applyStyles(connector.canvas, connector.bgPath, outlineStyle);\n    }\n    var cany = connector;\n    if (cany.path == null) {\n      cany.path = _node(ELEMENT_PATH, a);\n      _appendAtIndex(cany.canvas, cany.path, paintStyle.outlineStroke ? 1 : 0);\n    } else {\n      if (cany.path.parentNode !== cany.canvas) {\n        _appendAtIndex(cany.canvas, cany.path, paintStyle.outlineStroke ? 1 : 0);\n      }\n      _attr(connector.path, a);\n    }\n    _applyStyles(connector.canvas, connector.path, paintStyle);\n  }\n}\nfunction getConnectorElement(instance, c) {\n  if (c.canvas != null) {\n    return c.canvas;\n  } else {\n    var svg = _node(ELEMENT_SVG, {\n      \"style\": \"\",\n      \"width\": \"0\",\n      \"height\": \"0\",\n      \"pointer-events\": NONE,\n      \"position\": ABSOLUTE\n    });\n    c.canvas = svg;\n    instance._appendElement(c.canvas, instance.getContainer());\n    if (c.cssClass != null) {\n      instance.addClass(svg, c.cssClass);\n    }\n    instance.addClass(svg, instance.connectorClass);\n    svg.jtk = svg.jtk || {};\n    svg.jtk.connector = c;\n    return svg;\n  }\n}\n\nvar SvgEndpoint = function () {\n  function SvgEndpoint() {\n    _classCallCheck(this, SvgEndpoint);\n  }\n  _createClass(SvgEndpoint, null, [{\n    key: \"getEndpointElement\",\n    value: function getEndpointElement(ep) {\n      if (ep.canvas != null) {\n        return ep.canvas;\n      } else {\n        var canvas = _node(ELEMENT_SVG, {\n          \"style\": \"\",\n          \"width\": \"0\",\n          \"height\": \"0\",\n          \"pointer-events\": \"all\",\n          \"position\": ABSOLUTE\n        });\n        ep.canvas = canvas;\n        var classes = ep.classes.join(\" \");\n        ep.instance.addClass(canvas, classes);\n        var scopes = ep.endpoint.scope.split(/\\s/);\n        for (var i = 0; i < scopes.length; i++) {\n          ep.instance.setAttribute(canvas, ATTRIBUTE_SCOPE_PREFIX + scopes[i], TRUE$1);\n        }\n        ep.instance._appendElementToContainer(canvas);\n        if (ep.cssClass != null) {\n          ep.instance.addClass(canvas, ep.cssClass);\n        }\n        ep.instance.addClass(canvas, ep.instance.endpointClass);\n        canvas.jtk = canvas.jtk || {};\n        canvas.jtk.endpoint = ep.endpoint;\n        canvas.style.display = ep.endpoint.visible !== false ? BLOCK : NONE;\n        return canvas;\n      }\n    }\n  }, {\n    key: \"paint\",\n    value: function paint(ep, handlers, paintStyle) {\n      if (ep.endpoint.deleted !== true) {\n        this.getEndpointElement(ep);\n        SvgComponent.paint(ep, ep.instance, paintStyle);\n        var s = extend({}, paintStyle);\n        if (s.outlineStroke) {\n          s.stroke = s.outlineStroke;\n        }\n        if (ep.node == null) {\n          ep.node = handlers.makeNode(ep, s);\n          ep.canvas.appendChild(ep.node);\n        } else if (handlers.updateNode != null) {\n          handlers.updateNode(ep, ep.node);\n        }\n        _applyStyles(ep.canvas, ep.node, s);\n      }\n    }\n  }]);\n  return SvgEndpoint;\n}();\n\nvar endpointMap = {};\nfunction registerEndpointRenderer(name, fns) {\n  endpointMap[name] = fns;\n}\nfunction getPositionOnElement(evt, el, zoom) {\n  var jel = el;\n  var box = _typeof(el.getBoundingClientRect) !== UNDEFINED ? el.getBoundingClientRect() : {\n    left: 0,\n    top: 0,\n    width: 0,\n    height: 0\n  },\n      body = document.body,\n      docElem = document.documentElement,\n      scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n      scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n      clientTop = docElem.clientTop || body.clientTop || 0,\n      clientLeft = docElem.clientLeft || body.clientLeft || 0,\n      pst = 0,\n      psl = 0,\n      top = box.top + scrollTop - clientTop + pst * zoom,\n      left = box.left + scrollLeft - clientLeft + psl * zoom,\n      cl = pageLocation(evt),\n      w = box.width || jel.offsetWidth * zoom,\n      h = box.height || jel.offsetHeight * zoom,\n      x = (cl.x - left) / w,\n      y = (cl.y - top) / h;\n  return {\n    x: x,\n    y: y\n  };\n}\nfunction isSVGElementOverlay(o) {\n  return isArrowOverlay(o) || isDiamondOverlay(o) || isPlainArrowOverlay(o);\n}\nfunction setVisible(component, v) {\n  if (component.canvas) {\n    component.canvas.style.display = v ? \"block\" : \"none\";\n  }\n}\nfunction cleanup(component) {\n  if (component.canvas) {\n    component.canvas.parentNode.removeChild(component.canvas);\n  }\n  delete component.canvas;\n}\nfunction getEndpointCanvas(ep) {\n  return ep.canvas;\n}\nfunction getLabelElement(o) {\n  return HTMLElementOverlay.getElement(o);\n}\nfunction getCustomElement(o) {\n  return HTMLElementOverlay.getElement(o, o.component, function (c) {\n    var el = o.create(c);\n    o.instance.addClass(el, o.instance.overlayClass);\n    return el;\n  });\n}\nfunction groupDragConstrain(desiredLoc, dragEl, constrainRect, size) {\n  var x = desiredLoc.x,\n      y = desiredLoc.y;\n  if (dragEl._jsPlumbParentGroup && dragEl._jsPlumbParentGroup.constrain) {\n    x = Math.max(desiredLoc.x, 0);\n    y = Math.max(desiredLoc.y, 0);\n    x = Math.min(x, constrainRect.w - size.w);\n    y = Math.min(y, constrainRect.h - size.h);\n  }\n  return {\n    x: x,\n    y: y\n  };\n}\nvar BrowserJsPlumbInstance = function (_JsPlumbInstance) {\n  _inherits(BrowserJsPlumbInstance, _JsPlumbInstance);\n  var _super = _createSuper(BrowserJsPlumbInstance);\n  function BrowserJsPlumbInstance(_instanceIndex, defaults) {\n    var _this;\n    _classCallCheck(this, BrowserJsPlumbInstance);\n    _this = _super.call(this, _instanceIndex, defaults);\n    _this._instanceIndex = _instanceIndex;\n    _defineProperty(_assertThisInitialized(_this), \"containerType\", null);\n    _defineProperty(_assertThisInitialized(_this), \"dragSelection\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"dragManager\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorDblClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorDblTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointDblClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayDblClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayDblTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorMouseover\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorMouseout\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointMouseover\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointMouseout\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorContextmenu\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorMousedown\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_connectorMouseup\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointMousedown\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_endpointMouseup\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayMouseover\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_overlayMouseout\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementClick\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementDblTap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementMouseenter\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementMouseexit\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementMousemove\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementMouseup\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementMousedown\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_elementContextmenu\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_resizeObserver\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"eventManager\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"draggingClass\", \"jtk-dragging\");\n    _defineProperty(_assertThisInitialized(_this), \"elementDraggingClass\", \"jtk-element-dragging\");\n    _defineProperty(_assertThisInitialized(_this), \"hoverClass\", \"jtk-hover\");\n    _defineProperty(_assertThisInitialized(_this), \"sourceElementDraggingClass\", \"jtk-source-element-dragging\");\n    _defineProperty(_assertThisInitialized(_this), \"targetElementDraggingClass\", \"jtk-target-element-dragging\");\n    _defineProperty(_assertThisInitialized(_this), \"hoverSourceClass\", \"jtk-source-hover\");\n    _defineProperty(_assertThisInitialized(_this), \"hoverTargetClass\", \"jtk-target-hover\");\n    _defineProperty(_assertThisInitialized(_this), \"dragSelectClass\", \"jtk-drag-select\");\n    _defineProperty(_assertThisInitialized(_this), \"managedElementsSelector\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"elementsDraggable\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"elementDragHandler\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"groupDragOptions\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"elementDragOptions\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"svg\", {\n      node: function node(name, attributes) {\n        return _node(name, attributes);\n      },\n      attr: function attr(node, attributes) {\n        return _attr(node, attributes);\n      },\n      pos: function pos(d) {\n        return _pos(d);\n      }\n    });\n    defaults = defaults || {};\n    _this.containerType = getElementType(_this.getContainer());\n    _this.elementsDraggable = defaults && defaults.elementsDraggable !== false;\n    _this.managedElementsSelector = defaults ? defaults.managedElementsSelector || SELECTOR_MANAGED_ELEMENT : SELECTOR_MANAGED_ELEMENT;\n    _this.eventManager = new EventManager();\n    _this.dragSelection = new DragSelection(_assertThisInitialized(_this));\n    _this.dragManager = new DragManager(_assertThisInitialized(_this), _this.dragSelection);\n    _this.dragManager.addHandler(new EndpointDragHandler(_assertThisInitialized(_this)));\n    _this.groupDragOptions = {\n      constrainFunction: groupDragConstrain\n    };\n    _this.dragManager.addHandler(new GroupDragHandler(_assertThisInitialized(_this), _this.dragSelection), _this.groupDragOptions);\n    _this.elementDragHandler = new ElementDragHandler(_assertThisInitialized(_this), _this.dragSelection);\n    _this.elementDragOptions = defaults && defaults.dragOptions || {};\n    _this.dragManager.addHandler(_this.elementDragHandler, _this.elementDragOptions);\n    if (defaults && defaults.dragOptions && defaults.dragOptions.filter) {\n      _this.dragManager.addFilter(defaults.dragOptions.filter);\n    }\n    _this._createEventListeners();\n    _this._attachEventDelegates();\n    if (defaults.resizeObserver !== false) {\n      try {\n        _this._resizeObserver = new ResizeObserver(function (entries) {\n          var updates = entries.filter(function (e) {\n            var a = _this.getAttribute(e.target, ATTRIBUTE_MANAGED);\n            if (a != null) {\n              var v = _this.viewport._elementMap.get(a);\n              return v ? v.w !== e.contentRect.width || v.h !== e.contentRect.height : false;\n            } else {\n              return false;\n            }\n          });\n          updates.forEach(function (el) {\n            return _this.revalidate(el.target);\n          });\n        });\n      } catch (e) {\n        log(\"WARN: ResizeObserver could not be attached.\");\n      }\n    }\n    return _this;\n  }\n  _createClass(BrowserJsPlumbInstance, [{\n    key: \"fireOverlayMethod\",\n    value: function fireOverlayMethod(overlay, event, e) {\n      var stem = overlay.component instanceof Connection ? CONNECTION : ENDPOINT;\n      var mappedEvent = compoundEvent(stem, event)\n      ;\n      e._jsPlumbOverlay = overlay;\n      overlay.fire(event, {\n        e: e,\n        overlay: overlay\n      });\n      this.fire(mappedEvent, overlay.component, e);\n    }\n  }, {\n    key: \"addDragFilter\",\n    value: function addDragFilter(filter, exclude) {\n      this.dragManager.addFilter(filter, exclude);\n    }\n  }, {\n    key: \"removeDragFilter\",\n    value: function removeDragFilter(filter) {\n      this.dragManager.removeFilter(filter);\n    }\n  }, {\n    key: \"setDragGrid\",\n    value: function setDragGrid(grid) {\n      this.dragManager.setOption(this.elementDragHandler, {\n        grid: grid\n      });\n    }\n  }, {\n    key: \"setDragConstrainFunction\",\n    value: function setDragConstrainFunction(constrainFunction) {\n      this.dragManager.setOption(this.elementDragHandler, {\n        constrainFunction: constrainFunction\n      });\n    }\n  }, {\n    key: \"_removeElement\",\n    value: function _removeElement(element) {\n      element.parentNode && element.parentNode.removeChild(element);\n    }\n  }, {\n    key: \"_appendElement\",\n    value: function _appendElement(el, parent) {\n      if (parent) {\n        parent.appendChild(el);\n      }\n    }\n  }, {\n    key: \"_appendElementToGroup\",\n    value: function _appendElementToGroup(group, el) {\n      this.getGroupContentArea(group).appendChild(el);\n    }\n  }, {\n    key: \"_appendElementToContainer\",\n    value: function _appendElementToContainer(el) {\n      this._appendElement(el, this.getContainer());\n    }\n  }, {\n    key: \"_getAssociatedElements\",\n    value: function _getAssociatedElements(el) {\n      var a = [];\n      if (el.nodeType !== 3 && el.nodeType !== 8) {\n        var els = el.querySelectorAll(SELECTOR_MANAGED_ELEMENT);\n        Array.prototype.push.apply(a, els);\n      }\n      return a.filter(function (_a) {\n        return _a.nodeType !== 3 && _a.nodeType !== 8;\n      });\n    }\n  }, {\n    key: \"shouldFireEvent\",\n    value: function shouldFireEvent(event, value, originalEvent) {\n      return true;\n    }\n  }, {\n    key: \"getClass\",\n    value: function getClass$1(el) {\n      return getClass(el);\n    }\n  }, {\n    key: \"addClass\",\n    value: function addClass$1(el, clazz) {\n      addClass(el, clazz);\n    }\n  }, {\n    key: \"hasClass\",\n    value: function hasClass$1(el, clazz) {\n      return hasClass(el, clazz);\n    }\n  }, {\n    key: \"removeClass\",\n    value: function removeClass$1(el, clazz) {\n      removeClass(el, clazz);\n    }\n  }, {\n    key: \"toggleClass\",\n    value: function toggleClass$1(el, clazz) {\n      toggleClass(el, clazz);\n    }\n  }, {\n    key: \"setAttribute\",\n    value: function setAttribute(el, name, value) {\n      el.setAttribute(name, value);\n    }\n  }, {\n    key: \"getAttribute\",\n    value: function getAttribute(el, name) {\n      return el.getAttribute(name);\n    }\n  }, {\n    key: \"setAttributes\",\n    value: function setAttributes(el, atts) {\n      for (var i in atts) {\n        el.setAttribute(i, atts[i]);\n      }\n    }\n  }, {\n    key: \"removeAttribute\",\n    value: function removeAttribute(el, attName) {\n      el.removeAttribute && el.removeAttribute(attName);\n    }\n  }, {\n    key: \"on\",\n    value: function on(el, event, callbackOrSelector, callback) {\n      var _this2 = this;\n      var _one = function _one(_el) {\n        if (callback == null) {\n          _this2.eventManager.on(_el, event, callbackOrSelector);\n        } else {\n          _this2.eventManager.on(_el, event, callbackOrSelector, callback);\n        }\n      };\n      if (isNodeList(el)) {\n        forEach(el, function (el) {\n          return _one(el);\n        });\n      } else {\n        _one(el);\n      }\n      return this;\n    }\n  }, {\n    key: \"off\",\n    value: function off(el, event, callback) {\n      var _this3 = this;\n      if (isNodeList(el)) {\n        forEach(el, function (_el) {\n          return _this3.eventManager.off(_el, event, callback);\n        });\n      } else {\n        this.eventManager.off(el, event, callback);\n      }\n      return this;\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(el, event, originalEvent, payload, detail) {\n      this.eventManager.trigger(el, event, originalEvent, payload, detail);\n    }\n  }, {\n    key: \"getOffsetRelativeToRoot\",\n    value: function getOffsetRelativeToRoot(el) {\n      return offsetRelativeToRoot(el);\n    }\n  }, {\n    key: \"getOffset\",\n    value: function getOffset(el) {\n      var jel = el;\n      var container = this.getContainer();\n      var out = this.getPosition(jel),\n          op = el !== container && jel.offsetParent !== container ? jel.offsetParent : null,\n          _maybeAdjustScroll = function _maybeAdjustScroll(offsetParent) {\n        if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\n          out.x -= offsetParent.scrollLeft;\n          out.y -= offsetParent.scrollTop;\n        }\n      };\n      while (op != null) {\n        out.x += op.offsetLeft;\n        out.y += op.offsetTop;\n        _maybeAdjustScroll(op);\n        op = op.offsetParent === container ? null : op.offsetParent;\n      }\n      if (container != null && (container.scrollTop > 0 || container.scrollLeft > 0)) {\n        var pp = jel.offsetParent != null ? this.getStyle(jel.offsetParent, PROPERTY_POSITION) : STATIC,\n        p = this.getStyle(jel, PROPERTY_POSITION);\n        if (p !== ABSOLUTE && p !== FIXED && pp !== ABSOLUTE && pp !== FIXED) {\n          out.x -= container.scrollLeft;\n          out.y -= container.scrollTop;\n        }\n      }\n      return out;\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize(el) {\n      var _el = el;\n      if (_el.offsetWidth != null) {\n        return offsetSize(el);\n      } else if (_el.width && _el.width.baseVal) {\n        return svgWidthHeightSize(_el);\n      }\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition(el) {\n      var _el = el;\n      if (_el.offsetLeft != null) {\n        return {\n          x: parseFloat(_el.offsetLeft),\n          y: parseFloat(_el.offsetTop)\n        };\n      } else if (_el.x && _el.x.baseVal) {\n        return svgXYPosition(_el);\n      }\n    }\n  }, {\n    key: \"getStyle\",\n    value: function getStyle(el, prop) {\n      if (_typeof(window.getComputedStyle) !== UNDEFINED) {\n        return getComputedStyle(el, null).getPropertyValue(prop);\n      } else {\n        return el.currentStyle[prop];\n      }\n    }\n  }, {\n    key: \"getGroupContentArea\",\n    value: function getGroupContentArea(group) {\n      var da = this.getSelector(group.el, SELECTOR_GROUP_CONTAINER);\n      return da && da.length > 0 ? da[0] : group.el;\n    }\n  }, {\n    key: \"getSelector\",\n    value: function getSelector(ctx, spec) {\n      var sel = null;\n      if (arguments.length === 1) {\n        if (!isString(ctx)) {\n          var nodeList = document.createDocumentFragment();\n          nodeList.appendChild(ctx);\n          return fromArray(nodeList.childNodes);\n        }\n        sel = fromArray(document.querySelectorAll(ctx));\n      } else {\n        sel = fromArray(ctx.querySelectorAll(spec));\n      }\n      return sel;\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(el, p) {\n      var jel = el;\n      jel.style.left = p.x + \"px\";\n      jel.style.top = p.y + \"px\";\n    }\n  }, {\n    key: \"setDraggable\",\n    value: function setDraggable(element, draggable) {\n      if (draggable) {\n        this.removeAttribute(element, ATTRIBUTE_NOT_DRAGGABLE);\n      } else {\n        this.setAttribute(element, ATTRIBUTE_NOT_DRAGGABLE, TRUE$1);\n      }\n    }\n  }, {\n    key: \"isDraggable\",\n    value: function isDraggable(el) {\n      var d = this.getAttribute(el, ATTRIBUTE_NOT_DRAGGABLE);\n      return d == null || d === FALSE$1;\n    }\n  }, {\n    key: \"toggleDraggable\",\n    value: function toggleDraggable(el) {\n      var state = this.isDraggable(el);\n      this.setDraggable(el, !state);\n      return !state;\n    }\n  }, {\n    key: \"_createEventListeners\",\n    value: function _createEventListeners() {\n      var _connClick = function _connClick(event, e) {\n        if (!e.defaultPrevented && e._jsPlumbOverlay == null) {\n          var connectorElement = findParent(getEventSource(e), SELECTOR_CONNECTOR, this.getContainer(), true);\n          this.fire(event, connectorElement.jtk.connector.connection, e);\n        }\n      };\n      this._connectorClick = _connClick.bind(this, EVENT_CONNECTION_CLICK);\n      this._connectorDblClick = _connClick.bind(this, EVENT_CONNECTION_DBL_CLICK);\n      this._connectorTap = _connClick.bind(this, EVENT_CONNECTION_TAP);\n      this._connectorDblTap = _connClick.bind(this, EVENT_CONNECTION_DBL_TAP);\n      var _connectorHover = function _connectorHover(state, e) {\n        var el = getEventSource(e).parentNode;\n        if (el.jtk && el.jtk.connector) {\n          var connector = el.jtk.connector;\n          var connection = connector.connection;\n          this.setConnectorHover(connector, state);\n          if (state) {\n            this.addClass(connection.source, this.hoverSourceClass);\n            this.addClass(connection.target, this.hoverTargetClass);\n          } else {\n            this.removeClass(connection.source, this.hoverSourceClass);\n            this.removeClass(connection.target, this.hoverTargetClass);\n          }\n          this.fire(state ? EVENT_CONNECTION_MOUSEOVER : EVENT_CONNECTION_MOUSEOUT, el.jtk.connector.connection, e);\n        }\n      };\n      this._connectorMouseover = _connectorHover.bind(this, true);\n      this._connectorMouseout = _connectorHover.bind(this, false);\n      var _connectorMouseupdown = function _connectorMouseupdown(state, e) {\n        var el = getEventSource(e).parentNode;\n        if (el.jtk && el.jtk.connector) {\n          this.fire(state ? EVENT_CONNECTION_MOUSEUP : EVENT_CONNECTION_MOUSEDOWN, el.jtk.connector.connection, e);\n        }\n      };\n      this._connectorMouseup = _connectorMouseupdown.bind(this, true);\n      this._connectorMousedown = _connectorMouseupdown.bind(this, false);\n      this._connectorContextmenu = function (e) {\n        var el = getEventSource(e).parentNode;\n        if (el.jtk && el.jtk.connector) {\n          this.fire(EVENT_CONNECTION_CONTEXTMENU, el.jtk.connector.connection, e);\n        }\n      }.bind(this);\n      var _epClick = function _epClick(event, e, endpointElement) {\n        if (!e.defaultPrevented && e._jsPlumbOverlay == null) {\n          this.fire(event, endpointElement.jtk.endpoint, e);\n        }\n      };\n      this._endpointClick = _epClick.bind(this, EVENT_ENDPOINT_CLICK);\n      this._endpointDblClick = _epClick.bind(this, EVENT_ENDPOINT_DBL_CLICK);\n      var _endpointHover = function _endpointHover(state, e) {\n        var el = getEventSource(e);\n        if (el.jtk && el.jtk.endpoint) {\n          this.setEndpointHover(el.jtk.endpoint, state);\n          this.fire(state ? EVENT_ENDPOINT_MOUSEOVER : EVENT_ENDPOINT_MOUSEOUT, el.jtk.endpoint, e);\n        }\n      };\n      this._endpointMouseover = _endpointHover.bind(this, true);\n      this._endpointMouseout = _endpointHover.bind(this, false);\n      var _endpointMouseupdown = function _endpointMouseupdown(state, e) {\n        var el = getEventSource(e);\n        if (el.jtk && el.jtk.endpoint) {\n          this.fire(state ? EVENT_ENDPOINT_MOUSEUP : EVENT_ENDPOINT_MOUSEDOWN, el.jtk.endpoint, e);\n        }\n      };\n      this._endpointMouseup = _endpointMouseupdown.bind(this, true);\n      this._endpointMousedown = _endpointMouseupdown.bind(this, false);\n      var _oClick = function (method, e) {\n        var overlayElement = findParent(getEventSource(e), SELECTOR_OVERLAY, this.getContainer(), true);\n        var overlay = overlayElement.jtk.overlay;\n        if (overlay) {\n          this.fireOverlayMethod(overlay, method, e);\n        }\n      }.bind(this);\n      this._overlayClick = _oClick.bind(this, EVENT_CLICK);\n      this._overlayDblClick = _oClick.bind(this, EVENT_DBL_CLICK);\n      this._overlayTap = _oClick.bind(this, EVENT_TAP);\n      this._overlayDblTap = _oClick.bind(this, EVENT_DBL_TAP);\n      var _overlayHover = function _overlayHover(state, e) {\n        var overlayElement = findParent(getEventSource(e), SELECTOR_OVERLAY, this.getContainer(), true);\n        var overlay = overlayElement.jtk.overlay;\n        if (overlay) {\n          this.setOverlayHover(overlay, state);\n        }\n      };\n      this._overlayMouseover = _overlayHover.bind(this, true);\n      this._overlayMouseout = _overlayHover.bind(this, false);\n      var _elementClick = function _elementClick(event, e, target) {\n        if (!e.defaultPrevented) {\n          this.fire(e.detail === 1 ? EVENT_ELEMENT_CLICK : EVENT_ELEMENT_DBL_CLICK, target, e);\n        }\n      };\n      this._elementClick = _elementClick.bind(this, EVENT_ELEMENT_CLICK);\n      var _elementTap = function _elementTap(event, e, target) {\n        if (!e.defaultPrevented) {\n          this.fire(EVENT_ELEMENT_TAP, target, e);\n        }\n      };\n      this._elementTap = _elementTap.bind(this, EVENT_ELEMENT_TAP);\n      var _elementDblTap = function _elementDblTap(event, e, target) {\n        if (!e.defaultPrevented) {\n          this.fire(EVENT_ELEMENT_DBL_TAP, target, e);\n        }\n      };\n      this._elementDblTap = _elementDblTap.bind(this, EVENT_ELEMENT_DBL_TAP);\n      var _elementHover = function _elementHover(state, e) {\n        this.fire(state ? EVENT_ELEMENT_MOUSE_OVER : EVENT_ELEMENT_MOUSE_OUT, getEventSource(e), e);\n      };\n      this._elementMouseenter = _elementHover.bind(this, true);\n      this._elementMouseexit = _elementHover.bind(this, false);\n      this._elementMousemove = function (e) {\n        this.fire(EVENT_ELEMENT_MOUSE_MOVE, getEventSource(e), e);\n      }.bind(this);\n      this._elementMouseup = function (e) {\n        this.fire(EVENT_ELEMENT_MOUSE_UP, getEventSource(e), e);\n      }.bind(this);\n      this._elementMousedown = function (e) {\n        this.fire(EVENT_ELEMENT_MOUSE_DOWN, getEventSource(e), e);\n      }.bind(this);\n      this._elementContextmenu = function (e) {\n        this.fire(EVENT_ELEMENT_CONTEXTMENU, getEventSource(e), e);\n      }.bind(this);\n    }\n  }, {\n    key: \"_attachEventDelegates\",\n    value: function _attachEventDelegates() {\n      var currentContainer = this.getContainer();\n      this.eventManager.on(currentContainer, EVENT_CLICK, SELECTOR_OVERLAY, this._overlayClick);\n      this.eventManager.on(currentContainer, EVENT_DBL_CLICK, SELECTOR_OVERLAY, this._overlayDblClick);\n      this.eventManager.on(currentContainer, EVENT_TAP, SELECTOR_OVERLAY, this._overlayTap);\n      this.eventManager.on(currentContainer, EVENT_DBL_TAP, SELECTOR_OVERLAY, this._overlayDblTap);\n      this.eventManager.on(currentContainer, EVENT_CLICK, SELECTOR_CONNECTOR, this._connectorClick);\n      this.eventManager.on(currentContainer, EVENT_DBL_CLICK, SELECTOR_CONNECTOR, this._connectorDblClick);\n      this.eventManager.on(currentContainer, EVENT_TAP, SELECTOR_CONNECTOR, this._connectorTap);\n      this.eventManager.on(currentContainer, EVENT_DBL_TAP, SELECTOR_CONNECTOR, this._connectorDblTap);\n      this.eventManager.on(currentContainer, EVENT_CLICK, SELECTOR_ENDPOINT, this._endpointClick);\n      this.eventManager.on(currentContainer, EVENT_DBL_CLICK, SELECTOR_ENDPOINT, this._endpointDblClick);\n      this.eventManager.on(currentContainer, EVENT_CLICK, this.managedElementsSelector, this._elementClick);\n      this.eventManager.on(currentContainer, EVENT_TAP, this.managedElementsSelector, this._elementTap);\n      this.eventManager.on(currentContainer, EVENT_DBL_TAP, this.managedElementsSelector, this._elementDblTap);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOVER, SELECTOR_CONNECTOR, this._connectorMouseover);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOUT, SELECTOR_CONNECTOR, this._connectorMouseout);\n      this.eventManager.on(currentContainer, EVENT_CONTEXTMENU, SELECTOR_CONNECTOR, this._connectorContextmenu);\n      this.eventManager.on(currentContainer, EVENT_MOUSEUP, SELECTOR_CONNECTOR, this._connectorMouseup);\n      this.eventManager.on(currentContainer, EVENT_MOUSEDOWN, SELECTOR_CONNECTOR, this._connectorMousedown);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOVER, SELECTOR_ENDPOINT, this._endpointMouseover);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOUT, SELECTOR_ENDPOINT, this._endpointMouseout);\n      this.eventManager.on(currentContainer, EVENT_MOUSEUP, SELECTOR_ENDPOINT, this._endpointMouseup);\n      this.eventManager.on(currentContainer, EVENT_MOUSEDOWN, SELECTOR_ENDPOINT, this._endpointMousedown);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOVER, SELECTOR_OVERLAY, this._overlayMouseover);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOUT, SELECTOR_OVERLAY, this._overlayMouseout);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOVER, SELECTOR_MANAGED_ELEMENT, this._elementMouseenter);\n      this.eventManager.on(currentContainer, EVENT_MOUSEOUT, SELECTOR_MANAGED_ELEMENT, this._elementMouseexit);\n      this.eventManager.on(currentContainer, EVENT_MOUSEMOVE, SELECTOR_MANAGED_ELEMENT, this._elementMousemove);\n      this.eventManager.on(currentContainer, EVENT_MOUSEUP, SELECTOR_MANAGED_ELEMENT, this._elementMouseup);\n      this.eventManager.on(currentContainer, EVENT_MOUSEDOWN, SELECTOR_MANAGED_ELEMENT, this._elementMousedown);\n      this.eventManager.on(currentContainer, EVENT_CONTEXTMENU, SELECTOR_MANAGED_ELEMENT, this._elementContextmenu);\n    }\n  }, {\n    key: \"_detachEventDelegates\",\n    value: function _detachEventDelegates() {\n      var currentContainer = this.getContainer();\n      if (currentContainer) {\n        this.eventManager.off(currentContainer, EVENT_CLICK, this._connectorClick);\n        this.eventManager.off(currentContainer, EVENT_DBL_CLICK, this._connectorDblClick);\n        this.eventManager.off(currentContainer, EVENT_TAP, this._connectorTap);\n        this.eventManager.off(currentContainer, EVENT_DBL_TAP, this._connectorDblTap);\n        this.eventManager.off(currentContainer, EVENT_CLICK, this._endpointClick);\n        this.eventManager.off(currentContainer, EVENT_DBL_CLICK, this._endpointDblClick);\n        this.eventManager.off(currentContainer, EVENT_CLICK, this._overlayClick);\n        this.eventManager.off(currentContainer, EVENT_DBL_CLICK, this._overlayDblClick);\n        this.eventManager.off(currentContainer, EVENT_TAP, this._overlayTap);\n        this.eventManager.off(currentContainer, EVENT_DBL_TAP, this._overlayDblTap);\n        this.eventManager.off(currentContainer, EVENT_CLICK, this._elementClick);\n        this.eventManager.off(currentContainer, EVENT_TAP, this._elementTap);\n        this.eventManager.off(currentContainer, EVENT_DBL_TAP, this._elementDblTap);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOVER, this._connectorMouseover);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOUT, this._connectorMouseout);\n        this.eventManager.off(currentContainer, EVENT_CONTEXTMENU, this._connectorContextmenu);\n        this.eventManager.off(currentContainer, EVENT_MOUSEUP, this._connectorMouseup);\n        this.eventManager.off(currentContainer, EVENT_MOUSEDOWN, this._connectorMousedown);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOVER, this._endpointMouseover);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOUT, this._endpointMouseout);\n        this.eventManager.off(currentContainer, EVENT_MOUSEUP, this._endpointMouseup);\n        this.eventManager.off(currentContainer, EVENT_MOUSEDOWN, this._endpointMousedown);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOVER, this._overlayMouseover);\n        this.eventManager.off(currentContainer, EVENT_MOUSEOUT, this._overlayMouseout);\n        this.eventManager.off(currentContainer, EVENT_MOUSEENTER, this._elementMouseenter);\n        this.eventManager.off(currentContainer, EVENT_MOUSEEXIT, this._elementMouseexit);\n        this.eventManager.off(currentContainer, EVENT_MOUSEMOVE, this._elementMousemove);\n        this.eventManager.off(currentContainer, EVENT_MOUSEUP, this._elementMouseup);\n        this.eventManager.off(currentContainer, EVENT_MOUSEDOWN, this._elementMousedown);\n        this.eventManager.off(currentContainer, EVENT_CONTEXTMENU, this._elementContextmenu);\n      }\n    }\n  }, {\n    key: \"setContainer\",\n    value: function setContainer(newContainer) {\n      var _this4 = this;\n      if (newContainer === document || newContainer === document.body) {\n        throw new Error(\"Cannot set document or document.body as container element\");\n      }\n      this._detachEventDelegates();\n      var dragFilters;\n      if (this.dragManager != null) {\n        dragFilters = this.dragManager.reset();\n      }\n      this.setAttribute(newContainer, ATTRIBUTE_CONTAINER, uuid().replace(\"-\", \"\"));\n      var currentContainer = this.getContainer();\n      if (currentContainer != null) {\n        currentContainer.removeAttribute(ATTRIBUTE_CONTAINER);\n        var children = fromArray(currentContainer.childNodes).filter(function (cn) {\n          return cn != null && (_this4.hasClass(cn, CLASS_CONNECTOR) || _this4.hasClass(cn, CLASS_ENDPOINT) || _this4.hasClass(cn, CLASS_OVERLAY) || cn.getAttribute && cn.getAttribute(ATTRIBUTE_MANAGED) != null);\n        });\n        forEach(children, function (el) {\n          newContainer.appendChild(el);\n        });\n      }\n      _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"setContainer\", this).call(this, newContainer);\n      this.containerType = getElementType(newContainer);\n      if (this.eventManager != null) {\n        this._attachEventDelegates();\n      }\n      if (this.dragManager != null) {\n        this.dragManager.addHandler(new EndpointDragHandler(this));\n        this.dragManager.addHandler(new GroupDragHandler(this, this.dragSelection), this.groupDragOptions);\n        this.elementDragHandler = new ElementDragHandler(this, this.dragSelection);\n        this.dragManager.addHandler(this.elementDragHandler, this.elementDragOptions);\n        if (dragFilters != null) {\n          this.dragManager.setFilters(dragFilters);\n        }\n      }\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"reset\", this).call(this);\n      if (this._resizeObserver) {\n        this._resizeObserver.disconnect();\n      }\n      var container = this.getContainer();\n      var els = container.querySelectorAll([SELECTOR_MANAGED_ELEMENT, SELECTOR_ENDPOINT, SELECTOR_CONNECTOR, SELECTOR_OVERLAY].join(\",\"));\n      forEach(els, function (el) {\n        return el.parentNode && el.parentNode.removeChild(el);\n      });\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this._detachEventDelegates();\n      if (this.dragManager != null) {\n        this.dragManager.reset();\n      }\n      this.clearDragSelection();\n      _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"unmanage\",\n    value: function unmanage(el, removeElement) {\n      if (this._resizeObserver != null) {\n        this._resizeObserver.unobserve(el);\n      }\n      this.removeFromDragSelection(el);\n      _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"unmanage\", this).call(this, el, removeElement);\n    }\n  }, {\n    key: \"addToDragSelection\",\n    value: function addToDragSelection() {\n      var _this5 = this;\n      for (var _len = arguments.length, el = new Array(_len), _key = 0; _key < _len; _key++) {\n        el[_key] = arguments[_key];\n      }\n      forEach(el, function (_el) {\n        return _this5.dragSelection.add(_el);\n      });\n    }\n  }, {\n    key: \"clearDragSelection\",\n    value: function clearDragSelection() {\n      this.dragSelection.clear();\n    }\n  }, {\n    key: \"removeFromDragSelection\",\n    value: function removeFromDragSelection() {\n      var _this6 = this;\n      for (var _len2 = arguments.length, el = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        el[_key2] = arguments[_key2];\n      }\n      forEach(el, function (_el) {\n        return _this6.dragSelection.remove(_el);\n      });\n    }\n  }, {\n    key: \"toggleDragSelection\",\n    value: function toggleDragSelection() {\n      var _this7 = this;\n      for (var _len3 = arguments.length, el = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        el[_key3] = arguments[_key3];\n      }\n      forEach(el, function (_el) {\n        return _this7.dragSelection.toggle(_el);\n      });\n    }\n  }, {\n    key: \"addToDragGroup\",\n    value: function addToDragGroup(spec) {\n      var _this$elementDragHand;\n      for (var _len4 = arguments.length, els = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        els[_key4 - 1] = arguments[_key4];\n      }\n      (_this$elementDragHand = this.elementDragHandler).addToDragGroup.apply(_this$elementDragHand, [spec].concat(els));\n    }\n  }, {\n    key: \"removeFromDragGroup\",\n    value: function removeFromDragGroup() {\n      var _this$elementDragHand2;\n      (_this$elementDragHand2 = this.elementDragHandler).removeFromDragGroup.apply(_this$elementDragHand2, arguments);\n    }\n  }, {\n    key: \"setDragGroupState\",\n    value: function setDragGroupState(state) {\n      var _this$elementDragHand3;\n      for (var _len5 = arguments.length, els = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n        els[_key5 - 1] = arguments[_key5];\n      }\n      (_this$elementDragHand3 = this.elementDragHandler).setDragGroupState.apply(_this$elementDragHand3, [state].concat(els));\n    }\n  }, {\n    key: \"clearDragGroup\",\n    value: function clearDragGroup(name) {\n      this.elementDragHandler.clearDragGroup(name);\n    }\n  }, {\n    key: \"consume\",\n    value: function consume$1(e, doNotPreventDefault) {\n      consume(e, doNotPreventDefault);\n    }\n  }, {\n    key: \"rotate\",\n    value: function rotate(element, rotation, doNotRepaint) {\n      var elementId = this.getId(element);\n      if (this._managedElements[elementId]) {\n        this._managedElements[elementId].el.style.transform = \"rotate(\" + rotation + \"deg)\";\n        this._managedElements[elementId].el.style.transformOrigin = \"center center\";\n        return _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"rotate\", this).call(this, element, rotation, doNotRepaint);\n      }\n      return {\n        c: new Set(),\n        e: new Set()\n      };\n    }\n  }, {\n    key: \"addOverlayClass\",\n    value:\n    function addOverlayClass(o, clazz) {\n      if (isLabelOverlay(o)) {\n        o.instance.addClass(getLabelElement(o), clazz);\n      } else if (isSVGElementOverlay(o)) {\n        o.instance.addClass(ensureSVGOverlayPath(o), clazz);\n      } else if (isCustomOverlay(o)) {\n        o.instance.addClass(getCustomElement(o), clazz);\n      } else {\n        throw \"Could not add class to overlay of type [\" + o.type + \"]\";\n      }\n    }\n  }, {\n    key: \"removeOverlayClass\",\n    value: function removeOverlayClass(o, clazz) {\n      if (isLabelOverlay(o)) {\n        o.instance.removeClass(getLabelElement(o), clazz);\n      } else if (isSVGElementOverlay(o)) {\n        o.instance.removeClass(ensureSVGOverlayPath(o), clazz);\n      } else if (isCustomOverlay(o)) {\n        o.instance.removeClass(getCustomElement(o), clazz);\n      } else {\n        throw \"Could not remove class from overlay of type [\" + o.type + \"]\";\n      }\n    }\n  }, {\n    key: \"_paintOverlay\",\n    value: function _paintOverlay(o, params, extents) {\n      if (isLabelOverlay(o)) {\n        getLabelElement(o);\n        var XY = o.component.getXY();\n        o.canvas.style.left = XY.x + params.d.minx + \"px\";\n        o.canvas.style.top = XY.y + params.d.miny + \"px\";\n      } else if (isSVGElementOverlay(o)) {\n        var path = isNaN(params.d.cxy.x) || isNaN(params.d.cxy.y) ? \"M 0 0\" : \"M\" + params.d.hxy.x + \",\" + params.d.hxy.y + \" L\" + params.d.tail[0].x + \",\" + params.d.tail[0].y + \" L\" + params.d.cxy.x + \",\" + params.d.cxy.y + \" L\" + params.d.tail[1].x + \",\" + params.d.tail[1].y + \" Z\";\n        paintSVGOverlay(o, path, params, extents);\n      } else if (isCustomOverlay(o)) {\n        getCustomElement(o);\n        var _XY = o.component.getXY();\n        o.canvas.style.left = _XY.x + params.d.minx + \"px\";\n        o.canvas.style.top = _XY.y + params.d.miny + \"px\";\n      } else {\n        throw \"Could not paint overlay of type [\" + o.type + \"]\";\n      }\n    }\n  }, {\n    key: \"setOverlayVisible\",\n    value: function setOverlayVisible(o, visible) {\n      var d = visible ? \"block\" : \"none\";\n      function s(el) {\n        if (el != null) {\n          el.style.display = d;\n        }\n      }\n      if (isLabelOverlay(o)) {\n        s(getLabelElement(o));\n      } else if (isCustomOverlay(o)) {\n        s(getCustomElement(o));\n      } else if (isSVGElementOverlay(o)) {\n        s(o.path);\n      }\n    }\n  }, {\n    key: \"reattachOverlay\",\n    value: function reattachOverlay(o, c) {\n      if (isLabelOverlay(o)) {\n        o.instance._appendElement(getLabelElement(o), this.getContainer());\n      } else if (isCustomOverlay(o)) {\n        o.instance._appendElement(getCustomElement(o), this.getContainer());\n      } else if (isSVGElementOverlay(o)) {\n        this._appendElement(ensureSVGOverlayPath(o), c.connector.canvas);\n      }\n    }\n  }, {\n    key: \"setOverlayHover\",\n    value: function setOverlayHover(o, hover) {\n      var canvas;\n      if (isLabelOverlay(o)) {\n        canvas = getLabelElement(o);\n      } else if (isCustomOverlay(o)) {\n        canvas = getCustomElement(o);\n      } else if (isSVGElementOverlay(o)) {\n        canvas = ensureSVGOverlayPath(o);\n      }\n      if (canvas != null) {\n        if (this.hoverClass != null) {\n          if (hover) {\n            this.addClass(canvas, this.hoverClass);\n          } else {\n            this.removeClass(canvas, this.hoverClass);\n          }\n        }\n        this.setHover(o.component, hover);\n      }\n    }\n  }, {\n    key: \"destroyOverlay\",\n    value: function destroyOverlay(o) {\n      if (isLabelOverlay(o)) {\n        var _el2 = getLabelElement(o);\n        _el2.parentNode.removeChild(_el2);\n        delete o.canvas;\n        delete o.cachedDimensions;\n      } else if (isArrowOverlay(o) || isDiamondOverlay(o) || isPlainArrowOverlay(o)) {\n        destroySVGOverlay(o);\n      } else if (isCustomOverlay(o)) {\n        var _el3 = getCustomElement(o);\n        _el3.parentNode.removeChild(_el3);\n        delete o.canvas;\n        delete o.cachedDimensions;\n      }\n    }\n  }, {\n    key: \"drawOverlay\",\n    value: function drawOverlay(o, component, paintStyle, absolutePosition) {\n      if (isLabelOverlay(o) || isCustomOverlay(o)) {\n        var td = HTMLElementOverlay._getDimensions(o);\n        if (td != null && td.w != null && td.h != null) {\n          var cxy = {\n            x: 0,\n            y: 0\n          };\n          if (absolutePosition) {\n            cxy = {\n              x: absolutePosition.x,\n              y: absolutePosition.y\n            };\n          } else if (component instanceof EndpointRepresentation) {\n            var locToUse = Array.isArray(o.location) ? o.location : [o.location, o.location];\n            cxy = {\n              x: locToUse[0] * component.w,\n              y: locToUse[1] * component.h\n            };\n          } else {\n            var loc = o.location,\n                absolute = false;\n            if (isString(o.location) || o.location < 0 || o.location > 1) {\n              loc = parseInt(\"\" + o.location, 10);\n              absolute = true;\n            }\n            cxy = component.pointOnPath(loc, absolute);\n          }\n          var minx = cxy.x - td.w / 2,\n              miny = cxy.y - td.h / 2;\n          return {\n            component: o,\n            d: {\n              minx: minx,\n              miny: miny,\n              td: td,\n              cxy: cxy\n            },\n            xmin: minx,\n            xmax: minx + td.w,\n            ymin: miny,\n            ymax: miny + td.h\n          };\n        } else {\n          return {\n            xmin: 0,\n            xmax: 0,\n            ymin: 0,\n            ymax: 0\n          };\n        }\n      } else if (isArrowOverlay(o) || isDiamondOverlay(o) || isPlainArrowOverlay(o)) {\n        return o.draw(component, paintStyle, absolutePosition);\n      } else {\n        throw \"Could not draw overlay of type [\" + o.type + \"]\";\n      }\n    }\n  }, {\n    key: \"updateLabel\",\n    value: function updateLabel(o) {\n      if (isFunction(o.label)) {\n        var lt = o.label(this);\n        if (lt != null) {\n          getLabelElement(o).innerText = lt;\n        } else {\n          getLabelElement(o).innerText = \"\";\n        }\n      } else {\n        if (o.labelText == null) {\n          o.labelText = o.label;\n          if (o.labelText != null) {\n            getLabelElement(o).innerText = o.labelText;\n          } else {\n            getLabelElement(o).innerText = \"\";\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setHover\",\n    value: function setHover(component, hover) {\n      component._hover = hover;\n      if (component instanceof Endpoint && component.endpoint != null) {\n        this.setEndpointHover(component, hover, -1);\n      } else if (component instanceof Connection && component.connector != null) {\n        this.setConnectorHover(component.connector, hover);\n      }\n    }\n  }, {\n    key: \"paintConnector\",\n    value: function paintConnector(connector, paintStyle, extents) {\n      paintSvgConnector(this, connector, paintStyle, extents);\n    }\n  }, {\n    key: \"setConnectorHover\",\n    value: function setConnectorHover(connector, hover, sourceEndpoint) {\n      if (hover === false || !this.currentlyDragging && !this.isHoverSuspended()) {\n        var canvas = connector.canvas;\n        if (canvas != null) {\n          if (connector.hoverClass != null) {\n            if (hover) {\n              this.addClass(canvas, connector.hoverClass);\n            } else {\n              this.removeClass(canvas, connector.hoverClass);\n            }\n          }\n          if (hover) {\n            this.addClass(canvas, this.hoverClass);\n          } else {\n            this.removeClass(canvas, this.hoverClass);\n          }\n        }\n        if (connector.connection.hoverPaintStyle != null) {\n          connector.connection.paintStyleInUse = hover ? connector.connection.hoverPaintStyle : connector.connection.paintStyle;\n          if (!this._suspendDrawing) {\n            this._paintConnection(connector.connection);\n          }\n        }\n        if (connector.connection.endpoints[0] !== sourceEndpoint) {\n          this.setEndpointHover(connector.connection.endpoints[0], hover, 0, true);\n        }\n        if (connector.connection.endpoints[1] !== sourceEndpoint) {\n          this.setEndpointHover(connector.connection.endpoints[1], hover, 1, true);\n        }\n      }\n    }\n  }, {\n    key: \"destroyConnector\",\n    value: function destroyConnector(connection) {\n      if (connection.connector != null) {\n        cleanup(connection.connector);\n      }\n    }\n  }, {\n    key: \"addConnectorClass\",\n    value: function addConnectorClass(connector, clazz) {\n      if (connector.canvas) {\n        this.addClass(connector.canvas, clazz);\n      }\n    }\n  }, {\n    key: \"removeConnectorClass\",\n    value: function removeConnectorClass(connector, clazz) {\n      if (connector.canvas) {\n        this.removeClass(connector.canvas, clazz);\n      }\n    }\n  }, {\n    key: \"getConnectorClass\",\n    value: function getConnectorClass(connector) {\n      if (connector.canvas) {\n        return connector.canvas.className.baseVal;\n      } else {\n        return \"\";\n      }\n    }\n  }, {\n    key: \"setConnectorVisible\",\n    value: function setConnectorVisible(connector, v) {\n      setVisible(connector, v);\n    }\n  }, {\n    key: \"applyConnectorType\",\n    value: function applyConnectorType(connector, t) {\n      if (connector.canvas && t.cssClass) {\n        var classes = Array.isArray(t.cssClass) ? t.cssClass : [t.cssClass];\n        this.addClass(connector.canvas, classes.join(\" \"));\n      }\n    }\n  }, {\n    key: \"addEndpointClass\",\n    value: function addEndpointClass(ep, c) {\n      var canvas = getEndpointCanvas(ep.endpoint);\n      if (canvas != null) {\n        this.addClass(canvas, c);\n      }\n    }\n  }, {\n    key: \"applyEndpointType\",\n    value: function applyEndpointType(ep, t) {\n      if (t.cssClass) {\n        var canvas = getEndpointCanvas(ep.endpoint);\n        if (canvas) {\n          var classes = Array.isArray(t.cssClass) ? t.cssClass : [t.cssClass];\n          this.addClass(canvas, classes.join(\" \"));\n        }\n      }\n    }\n  }, {\n    key: \"destroyEndpoint\",\n    value: function destroyEndpoint(ep) {\n      var anchorClass = this.endpointAnchorClassPrefix + (ep.currentAnchorClass ? \"-\" + ep.currentAnchorClass : \"\");\n      this.removeClass(ep.element, anchorClass);\n      cleanup(ep.endpoint);\n    }\n  }, {\n    key: \"renderEndpoint\",\n    value: function renderEndpoint(ep, paintStyle) {\n      var renderer = endpointMap[ep.endpoint.type];\n      if (renderer != null) {\n        SvgEndpoint.paint(ep.endpoint, renderer, paintStyle);\n      } else {\n        log(\"jsPlumb: no endpoint renderer found for type [\" + ep.endpoint.type + \"]\");\n      }\n    }\n  }, {\n    key: \"removeEndpointClass\",\n    value: function removeEndpointClass(ep, c) {\n      var canvas = getEndpointCanvas(ep.endpoint);\n      if (canvas != null) {\n        this.removeClass(canvas, c);\n      }\n    }\n  }, {\n    key: \"getEndpointClass\",\n    value: function getEndpointClass(ep) {\n      var canvas = getEndpointCanvas(ep.endpoint);\n      if (canvas != null) {\n        return canvas.className;\n      } else {\n        return \"\";\n      }\n    }\n  }, {\n    key: \"setEndpointHover\",\n    value: function setEndpointHover(endpoint, hover, endpointIndex, doNotCascade) {\n      if (endpoint != null && (hover === false || !this.currentlyDragging && !this.isHoverSuspended())) {\n        var canvas = getEndpointCanvas(endpoint.endpoint);\n        if (canvas != null) {\n          if (endpoint.hoverClass != null) {\n            if (hover) {\n              this.addClass(canvas, endpoint.hoverClass);\n            } else {\n              this.removeClass(canvas, endpoint.hoverClass);\n            }\n          }\n          if (endpointIndex === 0 || endpointIndex === 1) {\n            var genericHoverClass = endpointIndex === 0 ? this.hoverSourceClass : this.hoverTargetClass;\n            if (hover) {\n              this.addClass(canvas, genericHoverClass);\n            } else {\n              this.removeClass(canvas, genericHoverClass);\n            }\n          }\n        }\n        if (endpoint.hoverPaintStyle != null) {\n          endpoint.paintStyleInUse = hover ? endpoint.hoverPaintStyle : endpoint.paintStyle;\n          if (!this._suspendDrawing) {\n            this.renderEndpoint(endpoint, endpoint.paintStyleInUse);\n          }\n        }\n        if (!doNotCascade) {\n          for (var i = 0; i < endpoint.connections.length; i++) {\n            this.setConnectorHover(endpoint.connections[i].connector, hover, endpoint);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setEndpointVisible\",\n    value: function setEndpointVisible(ep, v) {\n      setVisible(ep.endpoint, v);\n    }\n  }, {\n    key: \"setGroupVisible\",\n    value: function setGroupVisible(group, state) {\n      var m = group.el.querySelectorAll(SELECTOR_MANAGED_ELEMENT);\n      for (var i = 0; i < m.length; i++) {\n        if (state) {\n          this.show(m[i], true);\n        } else {\n          this.hide(m[i], true);\n        }\n      }\n    }\n  }, {\n    key: \"deleteConnection\",\n    value: function deleteConnection(connection, params) {\n      if (connection != null && connection.deleted !== true) {\n        if (connection.endpoints[0].deleted !== true) {\n          this.setEndpointHover(connection.endpoints[0], false, 0, true);\n        }\n        if (connection.endpoints[1].deleted !== true) {\n          this.setEndpointHover(connection.endpoints[1], false, 1, true);\n        }\n        return _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"deleteConnection\", this).call(this, connection, params);\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"addSourceSelector\",\n    value: function addSourceSelector(selector, params, exclude) {\n      this.addDragFilter(selector);\n      return _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"addSourceSelector\", this).call(this, selector, params, exclude);\n    }\n  }, {\n    key: \"removeSourceSelector\",\n    value: function removeSourceSelector(selector) {\n      this.removeDragFilter(selector.selector);\n      _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"removeSourceSelector\", this).call(this, selector);\n    }\n  }, {\n    key: \"manage\",\n    value: function manage(element, internalId, _recalc) {\n      if (this.containerType === ElementTypes.SVG && !isSVGElement(element)) {\n        throw new Error(\"ERROR: cannot manage non-svg element when container is an SVG element.\");\n      }\n      var managedElement = _get(_getPrototypeOf(BrowserJsPlumbInstance.prototype), \"manage\", this).call(this, element, internalId, _recalc);\n      if (managedElement != null) {\n        if (this._resizeObserver != null) {\n          this._resizeObserver.observe(managedElement.el);\n        }\n      }\n      return managedElement;\n    }\n  }]);\n  return BrowserJsPlumbInstance;\n}(JsPlumbInstance);\n\nvar CIRCLE = \"circle\";\nvar register$2 = function register() {\n  registerEndpointRenderer(DotEndpoint.type, {\n    makeNode: function makeNode(ep, style) {\n      return _node(CIRCLE, {\n        \"cx\": ep.w / 2,\n        \"cy\": ep.h / 2,\n        \"r\": ep.radius\n      });\n    },\n    updateNode: function updateNode(ep, node) {\n      _attr(node, {\n        \"cx\": \"\" + ep.w / 2,\n        \"cy\": \"\" + ep.h / 2,\n        \"r\": \"\" + ep.radius\n      });\n    }\n  });\n};\n\nvar RECT = \"rect\";\nvar register$1 = function register() {\n  registerEndpointRenderer(RectangleEndpoint.type, {\n    makeNode: function makeNode(ep, style) {\n      return _node(RECT, {\n        \"width\": ep.w,\n        \"height\": ep.h\n      });\n    },\n    updateNode: function updateNode(ep, node) {\n      _attr(node, {\n        \"width\": ep.w,\n        \"height\": ep.h\n      });\n    }\n  });\n};\n\nvar BLANK_ATTRIBUTES = {\n  \"width\": 10,\n  \"height\": 0,\n  \"fill\": \"transparent\",\n  \"stroke\": \"transparent\"\n};\nvar register = function register() {\n  registerEndpointRenderer(BlankEndpoint.type, {\n    makeNode: function makeNode(ep, style) {\n      return _node(\"rect\", BLANK_ATTRIBUTES);\n    },\n    updateNode: function updateNode(ep, node) {\n      _attr(node, BLANK_ATTRIBUTES);\n    }\n  });\n};\n\nregister$2();\nregister();\nregister$1();\nvar _jsPlumbInstanceIndex = 0;\nfunction getInstanceIndex() {\n  var i = _jsPlumbInstanceIndex + 1;\n  _jsPlumbInstanceIndex++;\n  return i;\n}\nfunction newInstance(defaults) {\n  return new BrowserJsPlumbInstance(getInstanceIndex(), defaults);\n}\nfunction ready(f) {\n  var _do = function _do() {\n    if (/complete|loaded|interactive/.test(document.readyState) && typeof document.body !== \"undefined\" && document.body != null) {\n      f();\n    } else {\n      setTimeout(_do, 9);\n    }\n  };\n  _do();\n}\n\nexport { ATTRIBUTE_CONTAINER, ATTRIBUTE_GROUP_CONTENT, ATTRIBUTE_JTK_ENABLED, ATTRIBUTE_JTK_SCOPE, BrowserJsPlumbInstance, CLASS_DELEGATED_DRAGGABLE, CLASS_DRAGGABLE, CLASS_DRAGGED, CLASS_DRAG_ACTIVE, CLASS_DRAG_CONTAINER, CLASS_DRAG_HOVER, CLASS_GHOST_PROXY, CONNECTION, Collicat, ContainmentType, Drag, DragManager, ELEMENT, ELEMENT_DIV, ENDPOINT, EVENT_BEFORE_START, EVENT_CLICK, EVENT_CONNECTION_ABORT, EVENT_CONNECTION_CLICK, EVENT_CONNECTION_CONTEXTMENU, EVENT_CONNECTION_DBL_CLICK, EVENT_CONNECTION_DBL_TAP, EVENT_CONNECTION_DRAG, EVENT_CONNECTION_MOUSEDOWN, EVENT_CONNECTION_MOUSEOUT, EVENT_CONNECTION_MOUSEOVER, EVENT_CONNECTION_MOUSEUP, EVENT_CONNECTION_TAP, EVENT_CONTEXTMENU, EVENT_DBL_CLICK, EVENT_DBL_TAP, EVENT_DRAG, EVENT_DRAG_MOVE, EVENT_DRAG_START, EVENT_DRAG_STOP, EVENT_DROP, EVENT_ELEMENT_CLICK, EVENT_ELEMENT_CONTEXTMENU, EVENT_ELEMENT_DBL_CLICK, EVENT_ELEMENT_DBL_TAP, EVENT_ELEMENT_MOUSE_DOWN, EVENT_ELEMENT_MOUSE_MOVE, EVENT_ELEMENT_MOUSE_OUT, EVENT_ELEMENT_MOUSE_OVER, EVENT_ELEMENT_MOUSE_UP, EVENT_ELEMENT_TAP, EVENT_ENDPOINT_CLICK, EVENT_ENDPOINT_DBL_CLICK, EVENT_ENDPOINT_DBL_TAP, EVENT_ENDPOINT_MOUSEDOWN, EVENT_ENDPOINT_MOUSEOUT, EVENT_ENDPOINT_MOUSEOVER, EVENT_ENDPOINT_MOUSEUP, EVENT_ENDPOINT_TAP, EVENT_FOCUS, EVENT_MOUSEDOWN, EVENT_MOUSEENTER, EVENT_MOUSEEXIT, EVENT_MOUSEMOVE, EVENT_MOUSEOUT, EVENT_MOUSEOVER, EVENT_MOUSEUP, EVENT_OUT, EVENT_OVER, EVENT_REVERT, EVENT_START, EVENT_STOP, EVENT_TAP, EVENT_TOUCHEND, EVENT_TOUCHMOVE, EVENT_TOUCHSTART, ElementDragHandler, ElementTypes, EventManager, PROPERTY_POSITION, PositioningStrategies, SELECTOR_CONNECTOR, SELECTOR_ENDPOINT, SELECTOR_GROUP, SELECTOR_GROUP_CONTAINER, SELECTOR_OVERLAY, addClass, compoundEvent, consume, createElement, createElementNS, findParent, getClass, getElementPosition, getElementSize, getElementType, getEventSource, getPageLocation, getPositionOnElement, getTouch, groupDragConstrain, hasClass, isArrayLike, isInsideParent, isMouseDevice, isNodeList, isSVGElement, isTouchDevice, matchesSelector$1 as matchesSelector, newInstance, offsetRelativeToRoot, offsetSize, pageLocation, ready, registerEndpointRenderer, removeClass, setForceMouseEvents, setForceTouchEvents, svg, svgWidthHeightSize, svgXYPosition, toggleClass, touchCount, touches };\n"],"names":["_typeof","obj","_classCallCheck","instance","Constructor","_defineProperties","target","props","i","descriptor","_createClass","protoProps","staticProps","_defineProperty","key","value","_inherits","subClass","superClass","_setPrototypeOf","_getPrototypeOf","o","p","_isNativeReflectConstruct","e","_assertThisInitialized","self","_possibleConstructorReturn","call","_createSuper","Derived","hasNativeReflectConstruct","Super","result","NewTarget","_superPropBase","object","property","_get","receiver","base","desc","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","_arrayLikeToArray","iter","_i","_arr","_n","_d","_s","_e","err","minLen","n","len","arr2","matchesSelector$1","el","selector","ctx","possibles","consume","doNotPreventDefault","findParent","container","matchOnElementAlso","getEventSource","_setClassName","cn","classList","fastTrim","cl","log","_getClassName","_classManip","classesToAdd","classesToRemove","cta","ctr","className","curClasses","_oneSet","add","classes","idx","isNodeList","isString","getClass","addClass","clazz","_one","parts","forEach","part","hasClass","removeClass","toggleClass","_this","createElement","tag","style","atts","createElementNS","ns","offsetRelativeToRoot","box","body","docElem","scrollTop","scrollLeft","clientTop","clientLeft","top","left","offsetSize","svgWidthHeightSize","svgXYPosition","getElementPosition","pc","ec","z","getElementSize","ElementTypes","getElementType","isSVGElement","svgAttributeMap","STROKE_DASHARRAY","DASHSTYLE","FILL","STROKE","STROKE_WIDTH","LINE_WIDTH","ELEMENT_SVG","ELEMENT_PATH","_attr","node","attributes","_node","name","_pos","d","_applyStyles","parent","NONE","sep","styleToUse","_appendAtIndex","svg","path","compoundEvent","stem","event","subevent","a","ATTRIBUTE_CONTAINER","ATTRIBUTE_GROUP_CONTENT","ATTRIBUTE_JTK_ENABLED","ATTRIBUTE_JTK_SCOPE","ENDPOINT","ELEMENT","CONNECTION","ELEMENT_DIV","EVENT_CLICK","EVENT_CONTEXTMENU","EVENT_DBL_CLICK","EVENT_DBL_TAP","EVENT_FOCUS","EVENT_MOUSEDOWN","EVENT_MOUSEENTER","EVENT_MOUSEEXIT","EVENT_MOUSEMOVE","EVENT_MOUSEUP","EVENT_MOUSEOUT","EVENT_MOUSEOVER","EVENT_TAP","EVENT_TOUCHSTART","EVENT_TOUCHEND","EVENT_TOUCHMOVE","EVENT_DRAG_MOVE","EVENT_DRAG_STOP","EVENT_DRAG_START","EVENT_REVERT","EVENT_CONNECTION_ABORT","EVENT_CONNECTION_DRAG","EVENT_ELEMENT_CLICK","EVENT_ELEMENT_DBL_CLICK","EVENT_ELEMENT_DBL_TAP","EVENT_ELEMENT_MOUSE_OUT","EVENT_ELEMENT_MOUSE_OVER","EVENT_ELEMENT_MOUSE_MOVE","EVENT_ELEMENT_MOUSE_UP","EVENT_ELEMENT_MOUSE_DOWN","EVENT_ELEMENT_CONTEXTMENU","EVENT_ELEMENT_TAP","EVENT_ENDPOINT_CLICK","EVENT_ENDPOINT_DBL_CLICK","EVENT_ENDPOINT_MOUSEOUT","EVENT_ENDPOINT_MOUSEOVER","EVENT_ENDPOINT_MOUSEUP","EVENT_ENDPOINT_MOUSEDOWN","EVENT_CONNECTION_CLICK","EVENT_CONNECTION_DBL_CLICK","EVENT_CONNECTION_DBL_TAP","EVENT_CONNECTION_MOUSEOUT","EVENT_CONNECTION_MOUSEOVER","EVENT_CONNECTION_MOUSEUP","EVENT_CONNECTION_MOUSEDOWN","EVENT_CONNECTION_CONTEXTMENU","EVENT_CONNECTION_TAP","PROPERTY_POSITION","SELECTOR_CONNECTOR","cls","CLASS_CONNECTOR","SELECTOR_ENDPOINT","CLASS_ENDPOINT","SELECTOR_GROUP","att","ATTRIBUTE_GROUP","SELECTOR_GROUP_CONTAINER","SELECTOR_OVERLAY","CLASS_OVERLAY","_touchMap","_tapProfiles2","_touch","pageX","pageY","screenX","screenY","clientX","clientY","uuid","_touchList","list","index","_touchAndList","matchesSelector","_t","_pi","doCompute","out","l","fn","j","guid","isTouchDevice","isMouseDevice","touchMap","PAGE","SCREEN","CLIENT","_genLoc","prefix","ts","touches","t","getTouch","pageLocation","screenLocation","clientLocation","touchCount","_bind","type","originalFn","options","_store","_unbind","_each$1","_el","_unstore","entries","g","NOT_SELECTOR_REGEX","_curryChildFilter","children","evt","c","nc","sel","m","WILDCARD","_fn","done","pathInfo","registerExtraFunction","newFn","DefaultHandler","tfn","ATTRIBUTE_TABINDEX","_tapProfiles","meeHelper","TapHandler","clickThreshold","dblClickThreshold","tt","down","finished","clearSingle","clearDouble","up","currentTarget","tc","eventId","pLoop","removeWithFunction","ds","MouseEnterExitHandler","activeElements","over","EventManager","params","jel","_c","_f","originalEvent","payload","detail","originalIsMouse","eventToBind","bindingAMouseEvent","pl","sl","_decorate","_evt","eventGenerators","touchList","init","ite","evtName","findDelegateElement","parentElement","childElement","currentParent","_assignId","isInsideParent","pos","s","ss","leftEdge","rightEdge","topEdge","bottomEdge","findMatchingSelector","availableSelectors","draggableId","matches","exclude","EVENT_START","EVENT_BEFORE_START","EVENT_DRAG","EVENT_DROP","EVENT_OVER","EVENT_OUT","EVENT_STOP","ATTRIBUTE_DRAGGABLE","CLASS_DRAGGABLE$1","DEFAULT_GRID_X","DEFAULT_GRID_Y","TRUE","FALSE","_classes","PositioningStrategies","positionerSetters","positionerGetters","sizeSetters","sizeGetters","_events","_devNull","_each","_inputFilter","collicat","Base","manager","scopes","getConstrainingRectangle","ContainmentType","Drag","_Base","_super","dragEl","currentScrollValues","dsx","dsy","dx","dy","_z","isNotRightClick","eventTarget","match","initial","_p2","b","dispatchResult","_pos2","_z2","desiredLoc","cPos","gp","retrieveOriginalElement","force","positions","dPos","v","_this$resolveGrid","grid","thresholdX","thresholdY","tx","ty","snapToGrid","val","_constrainRect","_size","f","rv","_exclude","_this2","atStart","DEFAULT_INPUTS","DEFAULT_INPUT_FILTER_SELECTOR","Collicat","extend","_p","_p3","CLASS_DRAG_SELECTED","DragSelection","_this3","vp","off","currentPosition","originalPosition","callback","_this4","op","x","y","_b","constrainRect","_this5","orig","id","findWithFunction","_this6","CLASS_DELEGATED_DRAGGABLE","CLASS_DRAGGABLE","CLASS_DRAG_CONTAINER","CLASS_GHOST_PROXY","CLASS_DRAG_ACTIVE","CLASS_DRAGGED","CLASS_DRAG_HOVER","DragManager","dragSelection","EVENT_ZOOM","handler","dragOptions","wrap","handlerBeforeStart","padding","filterToAdd","filter","filters","currentFilters","handlerAndOptions","getWithFunction","decodeDragGroupSpec","spec","isActiveDragGroupMember","dragGroup","details","getFromSetWithFunction","getAncestors","ancestors","ElementDragHandler","_dragSelection","SELECTOR_MANAGED_ELEMENT","dropGroup","targetGroup","intersectingElement","currentGroup","_this$_currentDragGro","elementsToProcess","addElementToProcess","currentPos","offset","pp","wasInGroup","isInOriginalGroup","parentOffset","orphanedPosition","originalElement","o1","o2","groupLoc","drag","finalPos","elSize","ui","bounds","findIntersectingGroups","ancestorsOfIntersectingGroups","intersects","elBounds","k","group","parentGroupOffset","contentArea","caOffset","ancestorOffset","elOffset","cont","nd","ATTRIBUTE_NOT_DRAGGABLE","FALSE$1","descendants","dragGroupMemberSpec","isNotInAGroup","membersAreDroppable","isGhostOrNotConstrained","elementGroup","groupEl","groupElId","boundingRect","groupLocation","elId","dragStartReturn","_len","els","_key","_len2","_key2","member","active","_this7","_len3","_key3","elementIds","_this8","doNotTransferToAncestor","isDefinitelyNotInsideParent","_makeFloatingEndpoint","ep","endpoint","referenceCanvas","sourceElement","sourceElementId","floatingAnchor","createFloatingAnchor","CLASS_ENDPOINT_FLOATING","isAssignableFrom","EndpointRepresentation","actualEndpoint","selectorFilter","_instance","negate","ok","SELECTOR_DRAG_ACTIVE_OR_HOVER","SOURCE_SELECTOR_UNIQUE_ENDPOINT_DATA","EndpointDragHandler","def","child","sourceEl","sourceSelector","elxy","getPositionOnElement","tempEndpointParams","scopeFromElement","extractedParameters","merge","sourceCount","maybeAnchorSpec","_originalAnchor","anchorSpecToUse","elementId","existingUniqueEndpoint","each","ipco","ips","scope","data","anchorIdx","SOURCE","TARGET","_continue","beforeDrag","INTERCEPT_BEFORE_DRAG","INTERCEPT_BEFORE_START_DETACH","canvasElement","endpointToFloat","aae","isSourceDrag","matchingEndpoints","ATTRIBUTE_SCOPE_PREFIX","candidate","sourceDef","sSel","targetZones","targetDefs","getAllWithFunction","tSel","targetDef","maxConnections","dragSelector","targetZonesSelector","REDROP_POLICY_ANY","REDROP_POLICY_STRICT","REDROP_POLICY_ANY_SOURCE","REDROP_POLICY_ANY_TARGET","REDROP_POLICY_ANY_SOURCE_OR_TARGET","_this$_shouldStartDra","_this$_shouldStartDra2","beforeStartParams","floatingElementSize","newDropTarget","_cont","bb","CHECK_DROP_ALLOWED","existingConnection","matchingSelectors","suspendedEndpoint","dropEndpoint","EVENT_MAX_CONNECTIONS","_doContinue","r","jpc","targetDefinition","targetElement","eps","anchorsToUse","anchorFromDef","anchorFromPositionFinder","dropAnchor","tpayload","otherEndpointIdx","otherEndpoint","functionChain","IS_DETACH_ALLOWED","CHECK_CONDITION","INTERCEPT_BEFORE_DETACH","optionalData","suspendedElementId","_toDelete","isObject","info","conn","GroupDragHandler","_ElementDragHandler","newEl","HTMLElementOverlay","overlay","component","elementCreator","ABSOLUTE","forceRefresh","ensureSVGOverlayPath","Connection","connector","Endpoint","paintSVGOverlay","extents","destroySVGOverlay","_o","_Overlay","SVGElementOverlay","args","Overlay","SvgComponent","paintStyle","xy","wh","attrs","paintSvgConnector","getConnectorElement","outlineStyle","outlineWidth","outlineStrokeWidth","cany","SvgEndpoint","canvas","TRUE$1","BLOCK","handlers","endpointMap","registerEndpointRenderer","fns","zoom","UNDEFINED","pst","psl","w","h","isSVGElementOverlay","isArrowOverlay","isDiamondOverlay","isPlainArrowOverlay","setVisible","cleanup","getEndpointCanvas","getLabelElement","getCustomElement","groupDragConstrain","size","BrowserJsPlumbInstance","_JsPlumbInstance","_instanceIndex","defaults","updates","ATTRIBUTE_MANAGED","mappedEvent","constrainFunction","element","_a","attName","callbackOrSelector","_maybeAdjustScroll","offsetParent","STATIC","FIXED","prop","da","nodeList","fromArray","draggable","state","_connClick","connectorElement","_connectorHover","connection","_connectorMouseupdown","_epClick","endpointElement","_endpointHover","_endpointMouseupdown","_oClick","method","overlayElement","_overlayHover","_elementClick","_elementTap","_elementDblTap","_elementHover","currentContainer","newContainer","dragFilters","removeElement","_this$elementDragHand","_len4","_key4","_this$elementDragHand2","_this$elementDragHand3","_len5","_key5","rotation","doNotRepaint","isLabelOverlay","isCustomOverlay","XY","_XY","visible","hover","_el2","_el3","absolutePosition","td","cxy","locToUse","loc","absolute","minx","miny","isFunction","lt","sourceEndpoint","anchorClass","renderer","endpointIndex","doNotCascade","genericHoverClass","internalId","_recalc","managedElement","JsPlumbInstance","CIRCLE","register$2","DotEndpoint","RECT","register$1","RectangleEndpoint","BLANK_ATTRIBUTES","register","BlankEndpoint","_jsPlumbInstanceIndex","getInstanceIndex","newInstance","ready","_do"],"mappings":"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"}