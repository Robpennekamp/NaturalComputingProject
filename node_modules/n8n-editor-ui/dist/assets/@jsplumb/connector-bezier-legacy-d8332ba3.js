System.register(["./util-legacy-b5c07987.js","./core-legacy-3789fada.js","./common-legacy-1cf8cb8a.js"],(function(t,r){"use strict";var n,o,e,i,c,u,a;return{setters:[t=>{n=t.e,o=t.l,e=t.t},t=>{i=t.V,c=t.W,u=t.X},t=>{a=t.A}],execute:function(){function r(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function s(t,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,r,n){return r&&s(t.prototype,r),n&&s(t,n),t}function y(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function h(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&p(t,r)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,r){return p=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},p(t,r)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,r){return!r||"object"!=typeof r&&"function"!=typeof r?x(t):r}function m(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=f(t);if(r){var e=f(this).constructor;n=Reflect.construct(o,arguments,e)}else n=o.apply(this,arguments);return v(this,n)}}var g=function(t){h(i,t);var e=m(i);function i(t,n){var o;return r(this,i),(o=e.call(this,t,n)).connection=t,y(x(o),"showLoopback",void 0),y(x(o),"curviness",void 0),y(x(o),"margin",void 0),y(x(o),"proximityLimit",void 0),y(x(o),"orientation",void 0),y(x(o),"loopbackRadius",void 0),y(x(o),"clockwise",void 0),y(x(o),"isLoopbackCurrently",void 0),y(x(o),"geometry",null),n=n||{},o.showLoopback=!1!==n.showLoopback,o.curviness=n.curviness||10,o.margin=n.margin||5,o.proximityLimit=n.proximityLimit||80,o.clockwise=n.orientation&&"clockwise"===n.orientation,o.loopbackRadius=n.loopbackRadius||25,o.isLoopbackCurrently=!1,o}return l(i,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(t,r){var n=r.sourcePos,o=r.targetPos,e=Math.abs(n.curX-o.curX),i=Math.abs(n.curY-o.curY);if(this.showLoopback&&r.sourceEndpoint.elementId===r.targetEndpoint.elementId){this.isLoopbackCurrently=!0;var u=r.sourcePos.curX,a=r.sourcePos.curY-this.margin,s=u,l=a-this.loopbackRadius,y=s-this.loopbackRadius,h=l-this.loopbackRadius;e=2*this.loopbackRadius,i=2*this.loopbackRadius,t.points[0]=y,t.points[1]=h,t.points[2]=e,t.points[3]=i,this._addSegment(c,{loopback:!0,x1:u-y+4,y1:a-h,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:u-y-4,y2:a-h,cx:s-y,cy:l-h})}else this.isLoopbackCurrently=!1,this._computeBezier(t,r,n,o,e,i)}},{key:"exportGeometry",value:function(){return null==this.geometry?null:{controlPoints:[n({},this.geometry.controlPoints[0]),n({},this.geometry.controlPoints[1])],source:n({},this.geometry.source),target:n({},this.geometry.target)}}},{key:"transformGeometry",value:function(t,r,n){return{controlPoints:[{x:t.controlPoints[0].x+r,y:t.controlPoints[0].y+n},{x:t.controlPoints[1].x+r,y:t.controlPoints[1].y+n}],source:this.transformAnchorPlacement(t.source,r,n),target:this.transformAnchorPlacement(t.target,r,n)}}},{key:"importGeometry",value:function(t){return!(null==t||(null==t.controlPoints||2!=t.controlPoints.length?(o("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),1):null==t.controlPoints[0].x||null==t.controlPoints[0].y||null==t.controlPoints[1].x||null==t.controlPoints[1].y?(o("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),1):null==t.source||null==t.source.curX||null==t.source.curY?(o("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),1):null==t.target||null==t.target.curX||null==t.target.curY?(o("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),1):(this.setGeometry(t,!1),0)))}}]),i}(u),P=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},d=function(t,r){return t.x*r.x+t.y*r.y},M=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},b=function(t,r){return{x:t.x*r,y:t.y*r}},k=Math.pow(2,-65);function w(t,r){for(var n,o=[],e=function(t,r){for(var n=r.length-1,o=2*n-1,e=[],i=[],c=[],u=[],a=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],s=0;s<=n;s++)e[s]=P(r[s],t);for(var l=0;l<=n-1;l++)i[l]=P(r[l+1],r[l]),i[l]=b(i[l],3);for(var y=0;y<=n-1;y++)for(var h=0;h<=n;h++)c[y]||(c[y]=[]),c[y][h]=d(i[y],e[h]);for(var f=0;f<=o;f++)u[f]||(u[f]=[]),u[f].y=0,u[f].x=parseFloat(""+f)/o;for(var p=n,x=n-1,v=0;v<=p+x;v++)for(var m=Math.max(0,v-x),g=Math.min(v,p),M=m;M<=g;M++){var k=v-M;u[M+k].y+=c[k][M]*a[k][M]}return u}(t,r),i=r.length-1,c=_(e,2*i-1,o,0),u=P(t,r[0]),a=M(u),s=0,l=0;l<c;l++)u=P(t,X(r,i,o[l],null,null)),(n=M(u))<a&&(a=n,s=o[l]);return u=P(t,r[i]),(n=M(u))<a&&(a=n,s=1),{location:s,distance:a}}function _(t,r,n,o){var i,c,u=[],a=[],s=[],l=[];switch(function(t,r){var n,o,i=0;n=o=e(t[0].y);for(var c=1;c<=r;c++)(n=e(t[c].y))!=o&&i++,o=n;return i}(t,r)){case 0:return 0;case 1:if(o>=64)return n[0]=(t[0].x+t[r].x)/2,1;if(function(t,r){var n,o,e,i,c,u,a,s,l,y,h,f;i=t[0].y-t[r].y,c=t[r].x-t[0].x,u=t[0].x*t[r].y-t[r].x*t[0].y,h=f=0;for(var p=1;p<r;p++){var x=i*t[p].x+c*t[p].y+u;x>h?h=x:x<f&&(f=x)}return n=((s=1)*(u-h)-(y=c)*(l=0))*(1/((a=0)*y-i*s)),o=(s*(u-f)-(y=c)*l)*(1/(a*y-i*s)),e=Math.min(n,o),Math.max(n,o)-e<k?1:0}(t,r))return n[0]=function(t,r){var n=1,o=0,e=t[r].x-t[0].x,i=t[r].y-t[0].y,c=t[0].x-0,u=t[0].y-0;return 0+n*(1/(e*o-i*n)*(e*u-i*c))}(t,r),1}X(t,r,.5,u,a),i=_(u,r,s,o+1),c=_(a,r,l,o+1);for(var y=0;y<i;y++)n[y]=s[y];for(var h=0;h<c;h++)n[h+i]=l[h];return i+c}function X(t,r,n,o,e){for(var i=[[]],c=0;c<=r;c++)i[0][c]=t[c];for(var u=1;u<=r;u++)for(var a=0;a<=r-u;a++)i[u]||(i[u]=[]),i[u][a]||(i[u][a]={}),i[u][a].x=(1-n)*i[u-1][a].x+n*i[u-1][a+1].x,i[u][a].y=(1-n)*i[u-1][a].y+n*i[u-1][a+1].y;if(null!=o)for(var s=0;s<=r;s++)o[s]=i[s][0];if(null!=e)for(var l=0;l<=r;l++)e[l]=i[r-l][l];return i[r][0]}function Y(t,r){var n={x:0,y:0};if(0===t)return r[0];var o=r.length-1;if(1===t)return r[o];var e=r,i=1-t;if(0===o)return r[0];if(1===o)return{x:i*e[0].x+t*e[1].x,y:i*e[0].y+t*e[1].y};if(4>o){var c,u,a,s=i*i,l=t*t,y=0;return 2===o?(e=[e[0],e[1],e[2],n],c=s,u=i*t*2,a=l):3===o&&(c=s*i,u=s*t*3,a=i*l*3,y=t*l),{x:c*e[0].x+u*e[1].x+a*e[2].x+y*e[3].x,y:c*e[0].y+u*e[1].y+a*e[2].y+y*e[3].y}}return n}function A(t){var r=0;if(!O(t))for(var n=function(t,r){var n=[];t--;for(var o=0;o<=t;o++)n.push(Y(o/t,r));return n}(16,t),o=0;o<15;o++)r+=R(n[o],n[o+1]);return r}var j=new Map;function L(t,r){for(var n=function(t){var r=j.get(t);if(!r){var n=function(t){return function(r){return t}},o=function(t){return function(r){for(var n=1,o=0;o<t.length;o++)n*=t[o](r);return n}};(r=[]).push((function(r){return Math.pow(r,t)}));for(var e=1;e<t;e++){for(var i=[n(t)],c=0;c<t-e;c++)i.push((function(t){return t}));for(var u=0;u<e;u++)i.push((function(t){return 1-t}));r.push(o(i))}r.push((function(r){return Math.pow(1-r,t)})),j.set(t,r)}return r}(t.length-1),o=0,e=0,i=0;i<t.length;i++)o+=t[i].x*n[i](r),e+=t[i].y*n[i](r);return{x:o,y:e}}function R(t,r){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}function O(t){return t[0].x===t[1].x&&t[0].y===t[1].y}function q(t,r,n){if(O(t))return{point:t[0],location:r};for(var o=L(t,r),e=0,i=r,c=n>0?1:-1,u=null;e<Math.abs(n);)e+=R(u=L(t,i+=.005*c),o),o=u;return{point:u,location:i}}function B(t,r,n,o,e){var i=o-r,c=t-n,u=t*(r-o)+r*(n-t),a=function(t){return[C(t,"x"),C(t,"y")]}(e),s=[i*a[0][0]+c*a[1][0],i*a[0][1]+c*a[1][1],i*a[0][2]+c*a[1][2],i*a[0][3]+c*a[1][3]+u],l=z.apply(null,s),y=[];if(null!=l)for(var h=0;h<3;h++){var f=l[h],p=Math.pow(f,2),x=Math.pow(f,3),v={x:a[0][0]*x+a[0][1]*p+a[0][2]*f+a[0][3],y:a[1][0]*x+a[1][1]*p+a[1][2]*f+a[1][3]},m=void 0;m=n-t!=0?(v[0]-t)/(n-t):(v[1]-r)/(o-r),f>=0&&f<=1&&m>=0&&m<=1&&y.push(v)}return y}function C(t,r){return[-t[0][r]+3*t[1][r]+-3*t[2][r]+t[3][r],3*t[0][r]-6*t[1][r]+3*t[2][r],-3*t[0][r]+3*t[1][r],t[0][r]]}function z(t,r,n,o){var i,c,u=r/t,a=n/t,s=o/t,l=(3*a-Math.pow(u,2))/9,y=(9*u*a-27*s-2*Math.pow(u,3))/54,h=Math.pow(l,3)+Math.pow(y,2),f=[0,0,0];if(h>=0)i=e(y+Math.sqrt(h))*Math.pow(Math.abs(y+Math.sqrt(h)),1/3),c=e(y-Math.sqrt(h))*Math.pow(Math.abs(y-Math.sqrt(h)),1/3),f[0]=-u/3+(i+c),f[1]=-u/3-(i+c)/2,f[2]=-u/3-(i+c)/2,0!==Math.abs(Math.sqrt(3)*(i-c)/2)&&(f[1]=-1,f[2]=-1);else{var p=Math.acos(y/Math.sqrt(-Math.pow(l,3)));f[0]=2*Math.sqrt(-l)*Math.cos(p/3)-u/3,f[1]=2*Math.sqrt(-l)*Math.cos((p+2*Math.PI)/3)-u/3,f[2]=2*Math.sqrt(-l)*Math.cos((p+4*Math.PI)/3)-u/3}for(var x=0;x<3;x++)(f[x]<0||f[x]>1)&&(f[x]=-1);return f}var G=t("B",function(t){h(o,t);var n=m(o);function o(t){var e;return r(this,o),y(x(e=n.call(this,t)),"curve",void 0),y(x(e),"cp1x",void 0),y(x(e),"cp1y",void 0),y(x(e),"cp2x",void 0),y(x(e),"cp2y",void 0),y(x(e),"length",0),y(x(e),"type",o.segmentType),e.cp1x=t.cp1x,e.cp1y=t.cp1y,e.cp2x=t.cp2x,e.cp2y=t.cp2y,e.x1=t.x1,e.x2=t.x2,e.y1=t.y1,e.y2=t.y2,e.curve=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],e.extents={xmin:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),ymin:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),xmax:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),ymax:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)},e}return l(o,[{key:"getPath",value:function(t){return(t?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(t,r){return t=o._translateLocation(this.curve,t,r),L(this.curve,t)}},{key:"gradientAtPoint",value:function(t,r){return t=o._translateLocation(this.curve,t,r),function(t,r){var n=L(t,r),o=L(t.slice(0,t.length-1),r),e=o.y-n.y,i=o.x-n.x;return 0===e?1/0:Math.atan(e/i)}(this.curve,t)}},{key:"pointAlongPathFrom",value:function(t,r,n){return t=o._translateLocation(this.curve,t,n),function(t,r,n){return q(t,r,n).point}(this.curve,t,r)}},{key:"getLength",value:function(){return null!=this.length&&0!==this.length||(this.length=A(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(t,r){var n,o,e,i=(n={x:t,y:r},o=this.curve,e=w(n,o),{point:X(o,o.length-1,e.location,null,null),location:e.location});return{d:Math.sqrt(Math.pow(i.point.x-t,2)+Math.pow(i.point.y-r,2)),x:i.point.x,y:i.point.y,l:1-i.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(t,r,n,o){return B(t,r,n,o,this.curve)}}],[{key:"_translateLocation",value:function(t,r,n){return n&&(r=function(t,r,n){return q(t,r,n).location}(t,r>0?0:1,r)),r}}]),o}(a));y(G,"segmentType","Bezier");var S=function(t){h(o,t);var n=m(o);function o(t,e){var i;return r(this,o),(i=n.call(this,t,e)).connection=t,y(x(i),"type",o.type),y(x(i),"majorAnchor",void 0),y(x(i),"minorAnchor",void 0),e=e||{},i.majorAnchor=e.curviness||150,i.minorAnchor=10,i}return l(o,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(t,r,n,o,e){var i={x:0,y:0};return o[0]!==e[0]||o[1]===e[1]?(0===e[0]?i.x=n.curX<r.curX?t.x+this.minorAnchor:t.x-this.minorAnchor:i.x=t.x+this.majorAnchor*e[0],0===e[1]?i.y=n.curY<r.curY?t.y+this.minorAnchor:t.y-this.minorAnchor:i.y=t.y+this.majorAnchor*o[1]):(0===o[0]?i.x=r.curX<n.curX?t.x+this.minorAnchor:t.x-this.minorAnchor:i.x=t.x-this.majorAnchor*o[0],0===o[1]?i.y=r.curY<n.curY?t.y+this.minorAnchor:t.y-this.minorAnchor:i.y=t.y+this.majorAnchor*e[1]),i}},{key:"_computeBezier",value:function(t,r,n,o,e,i){var c,u,a=n.curX<o.curX?e:0,s=n.curY<o.curY?i:0,l=n.curX<o.curX?0:e,y=n.curY<o.curY?0:i;!0!==this.edited?(c=this._findControlPoint({x:a,y:s},n,o,t.so,t.to),u=this._findControlPoint({x:l,y:y},o,n,t.to,t.so)):(c=this.geometry.controlPoints[0],u=this.geometry.controlPoints[1]),this.geometry={controlPoints:[c,u],source:r.sourcePos,target:r.targetPos},this._addSegment(G,{x1:a,y1:s,x2:l,y2:y,cp1x:c.x,cp1y:c.y,cp2x:u.x,cp2y:u.y})}}]),o}(g);y(S,"type","Bezier");var I=function(t){h(o,t);var n=m(o);function o(t,e){var i;return r(this,o),(i=n.call(this,t,e)).connection=t,y(x(i),"type",o.type),y(x(i),"_controlPoint",void 0),i.curviness=e.curviness||10,i.margin=e.margin||5,i.proximityLimit=e.proximityLimit||80,i.clockwise=e.orientation&&"clockwise"===e.orientation,i}return l(o,[{key:"_computeBezier",value:function(t,r,n,o,e,i){var c,u,a,s,l,y,h,f,p=n.curX<o.curX?0:e,x=n.curY<o.curY?0:i,v=n.curX<o.curX?e:0,m=n.curY<o.curY?i:0;if(0===n.x&&(p-=this.margin),1===n.x&&(p+=this.margin),0===n.y&&(x-=this.margin),1===n.y&&(x+=this.margin),0===o.x&&(v-=this.margin),1===o.x&&(v+=this.margin),0===o.y&&(m-=this.margin),1===o.y&&(m+=this.margin),!0!==this.edited){var g=(p+v)/2,P=(x+m)/2,d=(u=x,s=m,(c=p)<=(a=v)&&s<=u?1:c<=a&&u<=s?2:a<=c&&s>=u?3:4),M=Math.sqrt(Math.pow(v-p,2)+Math.pow(m-x,2));this._controlPoint=function(t,r,n,o,e,i,c,u,a){return u<=a?{x:t,y:r}:1===n?o.curY<=0&&e.curY>=1?{x:t+(o.x<.5?-1*i:i),y:r}:o.curX>=1&&e.curX<=0?{x:t,y:r+(o.y<.5?-1*c:c)}:{x:t+-1*i,y:r+-1*c}:2===n?o.curY>=1&&e.curY<=0?{x:t+(o.x<.5?-1*i:i),y:r}:o.curX>=1&&e.curX<=0?{x:t,y:r+(o.y<.5?-1*c:c)}:{x:t+i,y:r+-1*c}:3===n?o.curY>=1&&e.curY<=0?{x:t+(o.x<.5?-1*i:i),y:r}:o.curX<=0&&e.curX>=1?{x:t,y:r+(o.y<.5?-1*c:c)}:{x:t+-1*i,y:r+-1*c}:4===n?o.curY<=0&&e.curY>=1?{x:t+(o.x<.5?-1*i:i),y:r}:o.curX<=0&&e.curX>=1?{x:t,y:r+(o.y<.5?-1*c:c)}:{x:t+i,y:r+-1*c}:void 0}(g,P,d,r.sourcePos,r.targetPos,this.curviness,this.curviness,M,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];l=this._controlPoint.x,y=this._controlPoint.x,h=this._controlPoint.y,f=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:r.sourcePos,target:r.targetPos},this._addSegment(G,{x1:v,y1:m,x2:p,y2:x,cp1x:l,cp1y:h,cp2x:y,cp2y:f})}}]),o}(g);y(I,"type","StateMachine"),i.register(S.type,S),i.register(I.type,I)}}}));
//# sourceMappingURL=connector-bezier-legacy-d8332ba3.js.map
